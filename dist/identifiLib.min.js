!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.identifiLib=e()}(this,function(){"use strict";var t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function e(){throw new Error("Dynamic requires are not currently supported by rollup-plugin-commonjs")}function n(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function r(t,e){return t(e={exports:{}},e.exports),e.exports}var i=r(function(t){var e=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=e)}),s=r(function(t){var e=t.exports={version:"2.5.3"};"number"==typeof __e&&(__e=e)}),o=(s.version,function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}),a=function(t,e,n){if(o(t),void 0===e)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,r){return t.call(e,n,r)};case 3:return function(n,r,i){return t.call(e,n,r,i)}}return function(){return t.apply(e,arguments)}},h=function(t){return"object"==typeof t?null!==t:"function"==typeof t},u=function(t){if(!h(t))throw TypeError(t+" is not an object!");return t},c=function(t){try{return!!t()}catch(t){return!0}},f=!c(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}),l=i.document,d=h(l)&&h(l.createElement),p=function(t){return d?l.createElement(t):{}},g=!f&&!c(function(){return 7!=Object.defineProperty(p("div"),"a",{get:function(){return 7}}).a}),y=function(t,e){if(!h(t))return t;var n,r;if(e&&"function"==typeof(n=t.toString)&&!h(r=n.call(t)))return r;if("function"==typeof(n=t.valueOf)&&!h(r=n.call(t)))return r;if(!e&&"function"==typeof(n=t.toString)&&!h(r=n.call(t)))return r;throw TypeError("Can't convert object to primitive value")},v=Object.defineProperty,m={f:f?Object.defineProperty:function(t,e,n){if(u(t),e=y(e,!0),u(n),g)try{return v(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(t[e]=n.value),t}},w=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}},b=f?function(t,e,n){return m.f(t,e,w(1,n))}:function(t,e,n){return t[e]=n,t},S=function(t,e,n){var r,o,h,u=t&S.F,c=t&S.G,f=t&S.S,l=t&S.P,d=t&S.B,p=t&S.W,g=c?s:s[e]||(s[e]={}),y=g.prototype,v=c?i:f?i[e]:(i[e]||{}).prototype;for(r in c&&(n=e),n)(o=!u&&v&&void 0!==v[r])&&r in g||(h=o?v[r]:n[r],g[r]=c&&"function"!=typeof v[r]?n[r]:d&&o?a(h,i):p&&v[r]==h?function(t){var e=function(e,n,r){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(e);case 2:return new t(e,n)}return new t(e,n,r)}return t.apply(this,arguments)};return e.prototype=t.prototype,e}(h):l&&"function"==typeof h?a(Function.call,h):h,l&&((g.virtual||(g.virtual={}))[r]=h,t&S.R&&y&&!y[r]&&b(y,r,h)))};S.F=1,S.G=2,S.S=4,S.P=8,S.B=16,S.W=32,S.U=64,S.R=128;var x,E=S,F={}.hasOwnProperty,A=function(t,e){return F.call(t,e)},C={}.toString,T=function(t){return C.call(t).slice(8,-1)},P=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==T(t)?t.split(""):Object(t)},D=function(t){if(null==t)throw TypeError("Can't call method on  "+t);return t},I=function(t){return P(D(t))},R=Math.ceil,B=Math.floor,H=function(t){return isNaN(t=+t)?0:(t>0?B:R)(t)},_=Math.min,k=function(t){return t>0?_(H(t),9007199254740991):0},N=Math.max,O=Math.min,j=i["__core-js_shared__"]||(i["__core-js_shared__"]={}),L=function(t){return j[t]||(j[t]={})},M=0,V=Math.random(),K=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++M+V).toString(36))},U=L("keys"),q=function(t){return U[t]||(U[t]=K(t))},z=(x=!1,function(t,e,n){var r,i=I(t),s=k(i.length),o=function(t,e){return(t=H(t))<0?N(t+e,0):O(t,e)}(n,s);if(x&&e!=e){for(;s>o;)if((r=i[o++])!=r)return!0}else for(;s>o;o++)if((x||o in i)&&i[o]===e)return x||o||0;return!x&&-1}),Y=q("IE_PROTO"),W=function(t,e){var n,r=I(t),i=0,s=[];for(n in r)n!=Y&&A(r,n)&&s.push(n);for(;e.length>i;)A(r,n=e[i++])&&(~z(s,n)||s.push(n));return s},G="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(","),J=Object.keys||function(t){return W(t,G)},X={f:Object.getOwnPropertySymbols},$={f:{}.propertyIsEnumerable},Z=function(t){return Object(D(t))},Q=Object.assign,tt=!Q||c(function(){var t={},e={},n=Symbol(),r="abcdefghijklmnopqrst";return t[n]=7,r.split("").forEach(function(t){e[t]=t}),7!=Q({},t)[n]||Object.keys(Q({},e)).join("")!=r})?function(t,e){for(var n=Z(t),r=arguments.length,i=1,s=X.f,o=$.f;r>i;)for(var a,h=P(arguments[i++]),u=s?J(h).concat(s(h)):J(h),c=u.length,f=0;c>f;)o.call(h,a=u[f++])&&(n[a]=h[a]);return n}:Q;E(E.S+E.F,"Object",{assign:tt});var et=s.Object.assign,nt=n(r(function(t){t.exports={default:et,__esModule:!0}})),rt=r(function(t,e){t.exports=e=window.fetch,e.default=window.fetch.bind(window),e.Headers=window.Headers,e.Request=window.Request,e.Response=window.Response}),it=(rt.Headers,rt.Request,rt.Response,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{}),st=[],ot=[],at="undefined"!=typeof Uint8Array?Uint8Array:Array,ht=!1;function ut(){ht=!0;for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",e=0,n=t.length;e<n;++e)st[e]=t[e],ot[t.charCodeAt(e)]=e;ot["-".charCodeAt(0)]=62,ot["_".charCodeAt(0)]=63}function ct(t,e,n){for(var r,i,s=[],o=e;o<n;o+=3)r=(t[o]<<16)+(t[o+1]<<8)+t[o+2],s.push(st[(i=r)>>18&63]+st[i>>12&63]+st[i>>6&63]+st[63&i]);return s.join("")}function ft(t){var e;ht||ut();for(var n=t.length,r=n%3,i="",s=[],o=0,a=n-r;o<a;o+=16383)s.push(ct(t,o,o+16383>a?a:o+16383));return 1===r?(e=t[n-1],i+=st[e>>2],i+=st[e<<4&63],i+="=="):2===r&&(e=(t[n-2]<<8)+t[n-1],i+=st[e>>10],i+=st[e>>4&63],i+=st[e<<2&63],i+="="),s.push(i),s.join("")}function lt(t,e,n,r,i){var s,o,a=8*i-r-1,h=(1<<a)-1,u=h>>1,c=-7,f=n?i-1:0,l=n?-1:1,d=t[e+f];for(f+=l,s=d&(1<<-c)-1,d>>=-c,c+=a;c>0;s=256*s+t[e+f],f+=l,c-=8);for(o=s&(1<<-c)-1,s>>=-c,c+=r;c>0;o=256*o+t[e+f],f+=l,c-=8);if(0===s)s=1-u;else{if(s===h)return o?NaN:1/0*(d?-1:1);o+=Math.pow(2,r),s-=u}return(d?-1:1)*o*Math.pow(2,s-r)}function dt(t,e,n,r,i,s){var o,a,h,u=8*s-i-1,c=(1<<u)-1,f=c>>1,l=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,d=r?0:s-1,p=r?1:-1,g=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,o=c):(o=Math.floor(Math.log(e)/Math.LN2),e*(h=Math.pow(2,-o))<1&&(o--,h*=2),(e+=o+f>=1?l/h:l*Math.pow(2,1-f))*h>=2&&(o++,h/=2),o+f>=c?(a=0,o=c):o+f>=1?(a=(e*h-1)*Math.pow(2,i),o+=f):(a=e*Math.pow(2,f-1)*Math.pow(2,i),o=0));i>=8;t[n+d]=255&a,d+=p,a/=256,i-=8);for(o=o<<i|a,u+=i;u>0;t[n+d]=255&o,d+=p,o/=256,u-=8);t[n+d-p]|=128*g}var pt={}.toString,gt=Array.isArray||function(t){return"[object Array]"==pt.call(t)};function yt(){return mt.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function vt(t,e){if(yt()<e)throw new RangeError("Invalid typed array length");return mt.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=mt.prototype:(null===t&&(t=new mt(e)),t.length=e),t}function mt(t,e,n){if(!(mt.TYPED_ARRAY_SUPPORT||this instanceof mt))return new mt(t,e,n);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return St(this,t)}return wt(this,t,e,n)}function wt(t,e,n,r){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?function(t,e,n,r){if(e.byteLength,n<0||e.byteLength<n)throw new RangeError("'offset' is out of bounds");if(e.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");e=void 0===n&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,n):new Uint8Array(e,n,r);mt.TYPED_ARRAY_SUPPORT?(t=e).__proto__=mt.prototype:t=xt(t,e);return t}(t,e,n,r):"string"==typeof e?function(t,e,n){"string"==typeof n&&""!==n||(n="utf8");if(!mt.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|At(e,n),i=(t=vt(t,r)).write(e,n);i!==r&&(t=t.slice(0,i));return t}(t,e,n):function(t,e){if(Ft(e)){var n=0|Et(e.length);return 0===(t=vt(t,n)).length?t:(e.copy(t,0,0,n),t)}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||(r=e.length)!=r?vt(t,0):xt(t,e);if("Buffer"===e.type&&gt(e.data))return xt(t,e.data)}var r;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e)}function bt(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function St(t,e){if(bt(e),t=vt(t,e<0?0:0|Et(e)),!mt.TYPED_ARRAY_SUPPORT)for(var n=0;n<e;++n)t[n]=0;return t}function xt(t,e){var n=e.length<0?0:0|Et(e.length);t=vt(t,n);for(var r=0;r<n;r+=1)t[r]=255&e[r];return t}function Et(t){if(t>=yt())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+yt().toString(16)+" bytes");return 0|t}function Ft(t){return!(null==t||!t._isBuffer)}function At(t,e){if(Ft(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var n=t.length;if(0===n)return 0;for(var r=!1;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return $t(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return Zt(t).length;default:if(r)return $t(t).length;e=(""+e).toLowerCase(),r=!0}}function Ct(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function Tt(t,e,n,r,i){if(0===t.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=i?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(i)return-1;n=t.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof e&&(e=mt.from(e,r)),Ft(e))return 0===e.length?-1:Pt(t,e,n,r,i);if("number"==typeof e)return e&=255,mt.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):Pt(t,[e],n,r,i);throw new TypeError("val must be string, number or Buffer")}function Pt(t,e,n,r,i){var s,o=1,a=t.length,h=e.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(t.length<2||e.length<2)return-1;o=2,a/=2,h/=2,n/=2}function u(t,e){return 1===o?t[e]:t.readUInt16BE(e*o)}if(i){var c=-1;for(s=n;s<a;s++)if(u(t,s)===u(e,-1===c?0:s-c)){if(-1===c&&(c=s),s-c+1===h)return c*o}else-1!==c&&(s-=s-c),c=-1}else for(n+h>a&&(n=a-h),s=n;s>=0;s--){for(var f=!0,l=0;l<h;l++)if(u(t,s+l)!==u(e,l)){f=!1;break}if(f)return s}return-1}function Dt(t,e,n,r){n=Number(n)||0;var i=t.length-n;r?(r=Number(r))>i&&(r=i):r=i;var s=e.length;if(s%2!=0)throw new TypeError("Invalid hex string");r>s/2&&(r=s/2);for(var o=0;o<r;++o){var a=parseInt(e.substr(2*o,2),16);if(isNaN(a))return o;t[n+o]=a}return o}function It(t,e,n,r){return Qt($t(e,t.length-n),t,n,r)}function Rt(t,e,n,r){return Qt(function(t){for(var e=[],n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}(e),t,n,r)}function Bt(t,e,n,r){return Rt(t,e,n,r)}function Ht(t,e,n,r){return Qt(Zt(e),t,n,r)}function _t(t,e,n,r){return Qt(function(t,e){for(var n,r,i,s=[],o=0;o<t.length&&!((e-=2)<0);++o)n=t.charCodeAt(o),r=n>>8,i=n%256,s.push(i),s.push(r);return s}(e,t.length-n),t,n,r)}function kt(t,e,n){return 0===e&&n===t.length?ft(t):ft(t.slice(e,n))}function Nt(t,e,n){n=Math.min(t.length,n);for(var r=[],i=e;i<n;){var s,o,a,h,u=t[i],c=null,f=u>239?4:u>223?3:u>191?2:1;if(i+f<=n)switch(f){case 1:u<128&&(c=u);break;case 2:128==(192&(s=t[i+1]))&&(h=(31&u)<<6|63&s)>127&&(c=h);break;case 3:s=t[i+1],o=t[i+2],128==(192&s)&&128==(192&o)&&(h=(15&u)<<12|(63&s)<<6|63&o)>2047&&(h<55296||h>57343)&&(c=h);break;case 4:s=t[i+1],o=t[i+2],a=t[i+3],128==(192&s)&&128==(192&o)&&128==(192&a)&&(h=(15&u)<<18|(63&s)<<12|(63&o)<<6|63&a)>65535&&h<1114112&&(c=h)}null===c?(c=65533,f=1):c>65535&&(c-=65536,r.push(c>>>10&1023|55296),c=56320|1023&c),r.push(c),i+=f}return function(t){var e=t.length;if(e<=Ot)return String.fromCharCode.apply(String,t);var n="",r=0;for(;r<e;)n+=String.fromCharCode.apply(String,t.slice(r,r+=Ot));return n}(r)}mt.TYPED_ARRAY_SUPPORT=void 0===it.TYPED_ARRAY_SUPPORT||it.TYPED_ARRAY_SUPPORT,mt.poolSize=8192,mt._augment=function(t){return t.__proto__=mt.prototype,t},mt.from=function(t,e,n){return wt(null,t,e,n)},mt.TYPED_ARRAY_SUPPORT&&(mt.prototype.__proto__=Uint8Array.prototype,mt.__proto__=Uint8Array),mt.alloc=function(t,e,n){return function(t,e,n,r){return bt(e),e<=0?vt(t,e):void 0!==n?"string"==typeof r?vt(t,e).fill(n,r):vt(t,e).fill(n):vt(t,e)}(null,t,e,n)},mt.allocUnsafe=function(t){return St(null,t)},mt.allocUnsafeSlow=function(t){return St(null,t)},mt.isBuffer=te,mt.compare=function(t,e){if(!Ft(t)||!Ft(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var n=t.length,r=e.length,i=0,s=Math.min(n,r);i<s;++i)if(t[i]!==e[i]){n=t[i],r=e[i];break}return n<r?-1:r<n?1:0},mt.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},mt.concat=function(t,e){if(!gt(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return mt.alloc(0);var n;if(void 0===e)for(e=0,n=0;n<t.length;++n)e+=t[n].length;var r=mt.allocUnsafe(e),i=0;for(n=0;n<t.length;++n){var s=t[n];if(!Ft(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(r,i),i+=s.length}return r},mt.byteLength=At,mt.prototype._isBuffer=!0,mt.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)Ct(this,e,e+1);return this},mt.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)Ct(this,e,e+3),Ct(this,e+1,e+2);return this},mt.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)Ct(this,e,e+7),Ct(this,e+1,e+6),Ct(this,e+2,e+5),Ct(this,e+3,e+4);return this},mt.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?Nt(this,0,t):function(t,e,n){var r=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return Mt(this,e,n);case"utf8":case"utf-8":return Nt(this,e,n);case"ascii":return jt(this,e,n);case"latin1":case"binary":return Lt(this,e,n);case"base64":return kt(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Vt(this,e,n);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}}.apply(this,arguments)},mt.prototype.equals=function(t){if(!Ft(t))throw new TypeError("Argument must be a Buffer");return this===t||0===mt.compare(this,t)},mt.prototype.inspect=function(){var t="";return this.length>0&&(t=this.toString("hex",0,50).match(/.{2}/g).join(" "),this.length>50&&(t+=" ... ")),"<Buffer "+t+">"},mt.prototype.compare=function(t,e,n,r,i){if(!Ft(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),e<0||n>t.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&e>=n)return 0;if(r>=i)return-1;if(e>=n)return 1;if(this===t)return 0;for(var s=(i>>>=0)-(r>>>=0),o=(n>>>=0)-(e>>>=0),a=Math.min(s,o),h=this.slice(r,i),u=t.slice(e,n),c=0;c<a;++c)if(h[c]!==u[c]){s=h[c],o=u[c];break}return s<o?-1:o<s?1:0},mt.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},mt.prototype.indexOf=function(t,e,n){return Tt(this,t,e,n,!0)},mt.prototype.lastIndexOf=function(t,e,n){return Tt(this,t,e,n,!1)},mt.prototype.write=function(t,e,n,r){if(void 0===e)r="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)r=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-e;if((void 0===n||n>i)&&(n=i),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var s=!1;;)switch(r){case"hex":return Dt(this,t,e,n);case"utf8":case"utf-8":return It(this,t,e,n);case"ascii":return Rt(this,t,e,n);case"latin1":case"binary":return Bt(this,t,e,n);case"base64":return Ht(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return _t(this,t,e,n);default:if(s)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),s=!0}},mt.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var Ot=4096;function jt(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(127&t[i]);return r}function Lt(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(t[i]);return r}function Mt(t,e,n){var r=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>r)&&(n=r);for(var i="",s=e;s<n;++s)i+=Xt(t[s]);return i}function Vt(t,e,n){for(var r=t.slice(e,n),i="",s=0;s<r.length;s+=2)i+=String.fromCharCode(r[s]+256*r[s+1]);return i}function Kt(t,e,n){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function Ut(t,e,n,r,i,s){if(!Ft(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<s)throw new RangeError('"value" argument is out of bounds');if(n+r>t.length)throw new RangeError("Index out of range")}function qt(t,e,n,r){e<0&&(e=65535+e+1);for(var i=0,s=Math.min(t.length-n,2);i<s;++i)t[n+i]=(e&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function zt(t,e,n,r){e<0&&(e=4294967295+e+1);for(var i=0,s=Math.min(t.length-n,4);i<s;++i)t[n+i]=e>>>8*(r?i:3-i)&255}function Yt(t,e,n,r,i,s){if(n+r>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function Wt(t,e,n,r,i){return i||Yt(t,0,n,4),dt(t,e,n,r,23,4),n+4}function Gt(t,e,n,r,i){return i||Yt(t,0,n,8),dt(t,e,n,r,52,8),n+8}mt.prototype.slice=function(t,e){var n,r=this.length;if((t=~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),(e=void 0===e?r:~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),e<t&&(e=t),mt.TYPED_ARRAY_SUPPORT)(n=this.subarray(t,e)).__proto__=mt.prototype;else{var i=e-t;n=new mt(i,void 0);for(var s=0;s<i;++s)n[s]=this[s+t]}return n},mt.prototype.readUIntLE=function(t,e,n){t|=0,e|=0,n||Kt(t,e,this.length);for(var r=this[t],i=1,s=0;++s<e&&(i*=256);)r+=this[t+s]*i;return r},mt.prototype.readUIntBE=function(t,e,n){t|=0,e|=0,n||Kt(t,e,this.length);for(var r=this[t+--e],i=1;e>0&&(i*=256);)r+=this[t+--e]*i;return r},mt.prototype.readUInt8=function(t,e){return e||Kt(t,1,this.length),this[t]},mt.prototype.readUInt16LE=function(t,e){return e||Kt(t,2,this.length),this[t]|this[t+1]<<8},mt.prototype.readUInt16BE=function(t,e){return e||Kt(t,2,this.length),this[t]<<8|this[t+1]},mt.prototype.readUInt32LE=function(t,e){return e||Kt(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},mt.prototype.readUInt32BE=function(t,e){return e||Kt(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},mt.prototype.readIntLE=function(t,e,n){t|=0,e|=0,n||Kt(t,e,this.length);for(var r=this[t],i=1,s=0;++s<e&&(i*=256);)r+=this[t+s]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*e)),r},mt.prototype.readIntBE=function(t,e,n){t|=0,e|=0,n||Kt(t,e,this.length);for(var r=e,i=1,s=this[t+--r];r>0&&(i*=256);)s+=this[t+--r]*i;return s>=(i*=128)&&(s-=Math.pow(2,8*e)),s},mt.prototype.readInt8=function(t,e){return e||Kt(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},mt.prototype.readInt16LE=function(t,e){e||Kt(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},mt.prototype.readInt16BE=function(t,e){e||Kt(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},mt.prototype.readInt32LE=function(t,e){return e||Kt(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},mt.prototype.readInt32BE=function(t,e){return e||Kt(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},mt.prototype.readFloatLE=function(t,e){return e||Kt(t,4,this.length),lt(this,t,!0,23,4)},mt.prototype.readFloatBE=function(t,e){return e||Kt(t,4,this.length),lt(this,t,!1,23,4)},mt.prototype.readDoubleLE=function(t,e){return e||Kt(t,8,this.length),lt(this,t,!0,52,8)},mt.prototype.readDoubleBE=function(t,e){return e||Kt(t,8,this.length),lt(this,t,!1,52,8)},mt.prototype.writeUIntLE=function(t,e,n,r){(t=+t,e|=0,n|=0,r)||Ut(this,t,e,n,Math.pow(2,8*n)-1,0);var i=1,s=0;for(this[e]=255&t;++s<n&&(i*=256);)this[e+s]=t/i&255;return e+n},mt.prototype.writeUIntBE=function(t,e,n,r){(t=+t,e|=0,n|=0,r)||Ut(this,t,e,n,Math.pow(2,8*n)-1,0);var i=n-1,s=1;for(this[e+i]=255&t;--i>=0&&(s*=256);)this[e+i]=t/s&255;return e+n},mt.prototype.writeUInt8=function(t,e,n){return t=+t,e|=0,n||Ut(this,t,e,1,255,0),mt.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},mt.prototype.writeUInt16LE=function(t,e,n){return t=+t,e|=0,n||Ut(this,t,e,2,65535,0),mt.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):qt(this,t,e,!0),e+2},mt.prototype.writeUInt16BE=function(t,e,n){return t=+t,e|=0,n||Ut(this,t,e,2,65535,0),mt.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):qt(this,t,e,!1),e+2},mt.prototype.writeUInt32LE=function(t,e,n){return t=+t,e|=0,n||Ut(this,t,e,4,4294967295,0),mt.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):zt(this,t,e,!0),e+4},mt.prototype.writeUInt32BE=function(t,e,n){return t=+t,e|=0,n||Ut(this,t,e,4,4294967295,0),mt.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):zt(this,t,e,!1),e+4},mt.prototype.writeIntLE=function(t,e,n,r){if(t=+t,e|=0,!r){var i=Math.pow(2,8*n-1);Ut(this,t,e,n,i-1,-i)}var s=0,o=1,a=0;for(this[e]=255&t;++s<n&&(o*=256);)t<0&&0===a&&0!==this[e+s-1]&&(a=1),this[e+s]=(t/o>>0)-a&255;return e+n},mt.prototype.writeIntBE=function(t,e,n,r){if(t=+t,e|=0,!r){var i=Math.pow(2,8*n-1);Ut(this,t,e,n,i-1,-i)}var s=n-1,o=1,a=0;for(this[e+s]=255&t;--s>=0&&(o*=256);)t<0&&0===a&&0!==this[e+s+1]&&(a=1),this[e+s]=(t/o>>0)-a&255;return e+n},mt.prototype.writeInt8=function(t,e,n){return t=+t,e|=0,n||Ut(this,t,e,1,127,-128),mt.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},mt.prototype.writeInt16LE=function(t,e,n){return t=+t,e|=0,n||Ut(this,t,e,2,32767,-32768),mt.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):qt(this,t,e,!0),e+2},mt.prototype.writeInt16BE=function(t,e,n){return t=+t,e|=0,n||Ut(this,t,e,2,32767,-32768),mt.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):qt(this,t,e,!1),e+2},mt.prototype.writeInt32LE=function(t,e,n){return t=+t,e|=0,n||Ut(this,t,e,4,2147483647,-2147483648),mt.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):zt(this,t,e,!0),e+4},mt.prototype.writeInt32BE=function(t,e,n){return t=+t,e|=0,n||Ut(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),mt.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):zt(this,t,e,!1),e+4},mt.prototype.writeFloatLE=function(t,e,n){return Wt(this,t,e,!0,n)},mt.prototype.writeFloatBE=function(t,e,n){return Wt(this,t,e,!1,n)},mt.prototype.writeDoubleLE=function(t,e,n){return Gt(this,t,e,!0,n)},mt.prototype.writeDoubleBE=function(t,e,n){return Gt(this,t,e,!1,n)},mt.prototype.copy=function(t,e,n,r){if(n||(n=0),r||0===r||(r=this.length),e>=t.length&&(e=t.length),e||(e=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-e<r-n&&(r=t.length-e+n);var i,s=r-n;if(this===t&&n<e&&e<r)for(i=s-1;i>=0;--i)t[i+e]=this[i+n];else if(s<1e3||!mt.TYPED_ARRAY_SUPPORT)for(i=0;i<s;++i)t[i+e]=this[i+n];else Uint8Array.prototype.set.call(t,this.subarray(n,n+s),e);return s},mt.prototype.fill=function(t,e,n,r){if("string"==typeof t){if("string"==typeof e?(r=e,e=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===t.length){var i=t.charCodeAt(0);i<256&&(t=i)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!mt.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;var s;if(e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"==typeof t)for(s=e;s<n;++s)this[s]=t;else{var o=Ft(t)?t:$t(new mt(t,r).toString()),a=o.length;for(s=0;s<n-e;++s)this[s+e]=o[s%a]}return this};var Jt=/[^+\/0-9A-Za-z-_]/g;function Xt(t){return t<16?"0"+t.toString(16):t.toString(16)}function $t(t,e){var n;e=e||1/0;for(var r=t.length,i=null,s=[],o=0;o<r;++o){if((n=t.charCodeAt(o))>55295&&n<57344){if(!i){if(n>56319){(e-=3)>-1&&s.push(239,191,189);continue}if(o+1===r){(e-=3)>-1&&s.push(239,191,189);continue}i=n;continue}if(n<56320){(e-=3)>-1&&s.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(e-=3)>-1&&s.push(239,191,189);if(i=null,n<128){if((e-=1)<0)break;s.push(n)}else if(n<2048){if((e-=2)<0)break;s.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;s.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;s.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return s}function Zt(t){return function(t){var e,n,r,i,s,o;ht||ut();var a=t.length;if(a%4>0)throw new Error("Invalid string. Length must be a multiple of 4");s="="===t[a-2]?2:"="===t[a-1]?1:0,o=new at(3*a/4-s),r=s>0?a-4:a;var h=0;for(e=0,n=0;e<r;e+=4,n+=3)i=ot[t.charCodeAt(e)]<<18|ot[t.charCodeAt(e+1)]<<12|ot[t.charCodeAt(e+2)]<<6|ot[t.charCodeAt(e+3)],o[h++]=i>>16&255,o[h++]=i>>8&255,o[h++]=255&i;return 2===s?(i=ot[t.charCodeAt(e)]<<2|ot[t.charCodeAt(e+1)]>>4,o[h++]=255&i):1===s&&(i=ot[t.charCodeAt(e)]<<10|ot[t.charCodeAt(e+1)]<<4|ot[t.charCodeAt(e+2)]>>2,o[h++]=i>>8&255,o[h++]=255&i),o}(function(t){if((t=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}(t).replace(Jt,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function Qt(t,e,n,r){for(var i=0;i<r&&!(i+n>=e.length||i>=t.length);++i)e[i+n]=t[i];return i}function te(t){return null!=t&&(!!t._isBuffer||ee(t)||function(t){return"function"==typeof t.readFloatLE&&"function"==typeof t.slice&&ee(t.slice(0,0))}(t))}function ee(t){return!!t.constructor&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)}var ne={userAgent:!1},re={};if(void 0===ie)var ie={};ie.lang={extend:function(t,e,n){if(!e||!t)throw new Error("YAHOO.lang.extend failed, please check that all dependencies are included.");var r=function(){};if(r.prototype=e.prototype,t.prototype=new r,t.prototype.constructor=t,t.superclass=e.prototype,e.prototype.constructor==Object.prototype.constructor&&(e.prototype.constructor=e),n){var i;for(i in n)t.prototype[i]=n[i];var s=function(){},o=["toString","valueOf"];try{/MSIE/.test(ne.userAgent)&&(s=function(t,e){for(i=0;i<o.length;i+=1){var n=o[i],r=e[n];"function"==typeof r&&r!=Object.prototype[n]&&(t[n]=r)}})}catch(t){}s(t.prototype,n)}}};var se,oe,ae,he,ue=ue||function(t,e){var n={},r=n.lib={},i=r.Base=function(){function t(){}return{extend:function(e){t.prototype=this;var n=new t;return e&&n.mixIn(e),n.hasOwnProperty("init")||(n.init=function(){n.$super.init.apply(this,arguments)}),n.init.prototype=n,n.$super=this,n},create:function(){var t=this.extend();return t.init.apply(t,arguments),t},init:function(){},mixIn:function(t){for(var e in t)t.hasOwnProperty(e)&&(this[e]=t[e]);t.hasOwnProperty("toString")&&(this.toString=t.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),s=r.WordArray=i.extend({init:function(t,e){t=this.words=t||[],this.sigBytes=null!=e?e:4*t.length},toString:function(t){return(t||a).stringify(this)},concat:function(t){var e=this.words,n=t.words,r=this.sigBytes,i=t.sigBytes;if(this.clamp(),r%4)for(var s=0;s<i;s++){var o=n[s>>>2]>>>24-s%4*8&255;e[r+s>>>2]|=o<<24-(r+s)%4*8}else for(s=0;s<i;s+=4)e[r+s>>>2]=n[s>>>2];return this.sigBytes+=i,this},clamp:function(){var e=this.words,n=this.sigBytes;e[n>>>2]&=4294967295<<32-n%4*8,e.length=t.ceil(n/4)},clone:function(){var t=i.clone.call(this);return t.words=this.words.slice(0),t},random:function(e){for(var n=[],r=0;r<e;r+=4)n.push(4294967296*t.random()|0);return new s.init(n,e)}}),o=n.enc={},a=o.Hex={stringify:function(t){for(var e=t.words,n=t.sigBytes,r=[],i=0;i<n;i++){var s=e[i>>>2]>>>24-i%4*8&255;r.push((s>>>4).toString(16)),r.push((15&s).toString(16))}return r.join("")},parse:function(t){for(var e=t.length,n=[],r=0;r<e;r+=2)n[r>>>3]|=parseInt(t.substr(r,2),16)<<24-r%8*4;return new s.init(n,e/2)}},h=o.Latin1={stringify:function(t){for(var e=t.words,n=t.sigBytes,r=[],i=0;i<n;i++){var s=e[i>>>2]>>>24-i%4*8&255;r.push(String.fromCharCode(s))}return r.join("")},parse:function(t){for(var e=t.length,n=[],r=0;r<e;r++)n[r>>>2]|=(255&t.charCodeAt(r))<<24-r%4*8;return new s.init(n,e)}},u=o.Utf8={stringify:function(t){try{return decodeURIComponent(escape(h.stringify(t)))}catch(t){throw new Error("Malformed UTF-8 data")}},parse:function(t){return h.parse(unescape(encodeURIComponent(t)))}},c=r.BufferedBlockAlgorithm=i.extend({reset:function(){this._data=new s.init,this._nDataBytes=0},_append:function(t){"string"==typeof t&&(t=u.parse(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes},_process:function(e){var n=this._data,r=n.words,i=n.sigBytes,o=this.blockSize,a=i/(4*o),h=(a=e?t.ceil(a):t.max((0|a)-this._minBufferSize,0))*o,u=t.min(4*h,i);if(h){for(var c=0;c<h;c+=o)this._doProcessBlock(r,c);var f=r.splice(0,h);n.sigBytes-=u}return new s.init(f,u)},clone:function(){var t=i.clone.call(this);return t._data=this._data.clone(),t},_minBufferSize:0}),f=(r.Hasher=c.extend({cfg:i.extend(),init:function(t){this.cfg=this.cfg.extend(t),this.reset()},reset:function(){c.reset.call(this),this._doReset()},update:function(t){return this._append(t),this._process(),this},finalize:function(t){return t&&this._append(t),this._doFinalize()},blockSize:16,_createHelper:function(t){return function(e,n){return new t.init(n).finalize(e)}},_createHmacHelper:function(t){return function(e,n){return new f.HMAC.init(t,n).finalize(e)}}}),n.algo={});return n}(Math);!function(t){var e,n=(e=ue).lib,r=n.Base,i=n.WordArray;(e=e.x64={}).Word=r.extend({init:function(t,e){this.high=t,this.low=e}}),e.WordArray=r.extend({init:function(t,e){t=this.words=t||[],this.sigBytes=null!=e?e:8*t.length},toX32:function(){for(var t=this.words,e=t.length,n=[],r=0;r<e;r++){var s=t[r];n.push(s.high),n.push(s.low)}return i.create(n,this.sigBytes)},clone:function(){for(var t=r.clone.call(this),e=t.words=this.words.slice(0),n=e.length,i=0;i<n;i++)e[i]=e[i].clone();return t}})}(),ue.lib.Cipher||function(t){var e=(d=ue).lib,n=e.Base,r=e.WordArray,i=e.BufferedBlockAlgorithm,s=d.enc.Base64,o=d.algo.EvpKDF,a=e.Cipher=i.extend({cfg:n.extend(),createEncryptor:function(t,e){return this.create(this._ENC_XFORM_MODE,t,e)},createDecryptor:function(t,e){return this.create(this._DEC_XFORM_MODE,t,e)},init:function(t,e,n){this.cfg=this.cfg.extend(n),this._xformMode=t,this._key=e,this.reset()},reset:function(){i.reset.call(this),this._doReset()},process:function(t){return this._append(t),this._process()},finalize:function(t){return t&&this._append(t),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(t){return{encrypt:function(e,n,r){return("string"==typeof n?p:l).encrypt(t,e,n,r)},decrypt:function(e,n,r){return("string"==typeof n?p:l).decrypt(t,e,n,r)}}}});e.StreamCipher=a.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var h=d.mode={},u=function(t,e,n){var r=this._iv;r?this._iv=void 0:r=this._prevBlock;for(var i=0;i<n;i++)t[e+i]^=r[i]},c=(e.BlockCipherMode=n.extend({createEncryptor:function(t,e){return this.Encryptor.create(t,e)},createDecryptor:function(t,e){return this.Decryptor.create(t,e)},init:function(t,e){this._cipher=t,this._iv=e}})).extend();c.Encryptor=c.extend({processBlock:function(t,e){var n=this._cipher,r=n.blockSize;u.call(this,t,e,r),n.encryptBlock(t,e),this._prevBlock=t.slice(e,e+r)}}),c.Decryptor=c.extend({processBlock:function(t,e){var n=this._cipher,r=n.blockSize,i=t.slice(e,e+r);n.decryptBlock(t,e),u.call(this,t,e,r),this._prevBlock=i}}),h=h.CBC=c,c=(d.pad={}).Pkcs7={pad:function(t,e){for(var n,i=(n=(n=4*e)-t.sigBytes%n)<<24|n<<16|n<<8|n,s=[],o=0;o<n;o+=4)s.push(i);n=r.create(s,n),t.concat(n)},unpad:function(t){t.sigBytes-=255&t.words[t.sigBytes-1>>>2]}},e.BlockCipher=a.extend({cfg:a.cfg.extend({mode:h,padding:c}),reset:function(){a.reset.call(this);var t=(e=this.cfg).iv,e=e.mode;if(this._xformMode==this._ENC_XFORM_MODE)var n=e.createEncryptor;else n=e.createDecryptor,this._minBufferSize=1;this._mode=n.call(e,this,t&&t.words)},_doProcessBlock:function(t,e){this._mode.processBlock(t,e)},_doFinalize:function(){var t=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){t.pad(this._data,this.blockSize);var e=this._process(!0)}else e=this._process(!0),t.unpad(e);return e},blockSize:4});var f=e.CipherParams=n.extend({init:function(t){this.mixIn(t)},toString:function(t){return(t||this.formatter).stringify(this)}}),l=(h=(d.format={}).OpenSSL={stringify:function(t){var e=t.ciphertext;return((t=t.salt)?r.create([1398893684,1701076831]).concat(t).concat(e):e).toString(s)},parse:function(t){var e=(t=s.parse(t)).words;if(1398893684==e[0]&&1701076831==e[1]){var n=r.create(e.slice(2,4));e.splice(0,4),t.sigBytes-=16}return f.create({ciphertext:t,salt:n})}},e.SerializableCipher=n.extend({cfg:n.extend({format:h}),encrypt:function(t,e,n,r){r=this.cfg.extend(r);var i=t.createEncryptor(n,r);return e=i.finalize(e),i=i.cfg,f.create({ciphertext:e,key:n,iv:i.iv,algorithm:t,mode:i.mode,padding:i.padding,blockSize:t.blockSize,formatter:r.format})},decrypt:function(t,e,n,r){return r=this.cfg.extend(r),e=this._parse(e,r.format),t.createDecryptor(n,r).finalize(e.ciphertext)},_parse:function(t,e){return"string"==typeof t?e.parse(t,this):t}})),d=(d.kdf={}).OpenSSL={execute:function(t,e,n,i){return i||(i=r.random(8)),t=o.create({keySize:e+n}).compute(t,i),n=r.create(t.words.slice(e),4*n),t.sigBytes=4*e,f.create({key:t,iv:n,salt:i})}},p=e.PasswordBasedCipher=l.extend({cfg:l.cfg.extend({kdf:d}),encrypt:function(t,e,n,r){return n=(r=this.cfg.extend(r)).kdf.execute(n,t.keySize,t.ivSize),r.iv=n.iv,(t=l.encrypt.call(this,t,e,n.key,r)).mixIn(n),t},decrypt:function(t,e,n,r){return r=this.cfg.extend(r),e=this._parse(e,r.format),n=r.kdf.execute(n,t.keySize,t.ivSize,e.salt),r.iv=n.iv,l.decrypt.call(this,t,e,n.key,r)}})}(),function(){for(var t=ue,e=t.lib.BlockCipher,n=t.algo,r=[],i=[],s=[],o=[],a=[],h=[],u=[],c=[],f=[],l=[],d=[],p=0;256>p;p++)d[p]=128>p?p<<1:p<<1^283;var g=0,y=0;for(p=0;256>p;p++){var v=(v=y^y<<1^y<<2^y<<3^y<<4)>>>8^255&v^99;r[g]=v,i[v]=g;var m=d[g],w=d[m],b=d[w],S=257*d[v]^16843008*v;s[g]=S<<24|S>>>8,o[g]=S<<16|S>>>16,a[g]=S<<8|S>>>24,h[g]=S,S=16843009*b^65537*w^257*m^16843008*g,u[v]=S<<24|S>>>8,c[v]=S<<16|S>>>16,f[v]=S<<8|S>>>24,l[v]=S,g?(g=m^d[d[d[b^m]]],y^=d[d[y]]):g=y=1}var x=[0,1,2,4,8,16,32,64,128,27,54];n=n.AES=e.extend({_doReset:function(){for(var t=(n=this._key).words,e=n.sigBytes/4,n=4*((this._nRounds=e+6)+1),i=this._keySchedule=[],s=0;s<n;s++)if(s<e)i[s]=t[s];else{var o=i[s-1];s%e?6<e&&4==s%e&&(o=r[o>>>24]<<24|r[o>>>16&255]<<16|r[o>>>8&255]<<8|r[255&o]):(o=r[(o=o<<8|o>>>24)>>>24]<<24|r[o>>>16&255]<<16|r[o>>>8&255]<<8|r[255&o],o^=x[s/e|0]<<24),i[s]=i[s-e]^o}for(t=this._invKeySchedule=[],e=0;e<n;e++)s=n-e,o=e%4?i[s]:i[s-4],t[e]=4>e||4>=s?o:u[r[o>>>24]]^c[r[o>>>16&255]]^f[r[o>>>8&255]]^l[r[255&o]]},encryptBlock:function(t,e){this._doCryptBlock(t,e,this._keySchedule,s,o,a,h,r)},decryptBlock:function(t,e){var n=t[e+1];t[e+1]=t[e+3],t[e+3]=n,this._doCryptBlock(t,e,this._invKeySchedule,u,c,f,l,i),n=t[e+1],t[e+1]=t[e+3],t[e+3]=n},_doCryptBlock:function(t,e,n,r,i,s,o,a){for(var h=this._nRounds,u=t[e]^n[0],c=t[e+1]^n[1],f=t[e+2]^n[2],l=t[e+3]^n[3],d=4,p=1;p<h;p++){var g=r[u>>>24]^i[c>>>16&255]^s[f>>>8&255]^o[255&l]^n[d++],y=r[c>>>24]^i[f>>>16&255]^s[l>>>8&255]^o[255&u]^n[d++],v=r[f>>>24]^i[l>>>16&255]^s[u>>>8&255]^o[255&c]^n[d++];l=r[l>>>24]^i[u>>>16&255]^s[c>>>8&255]^o[255&f]^n[d++],u=g,c=y,f=v}g=(a[u>>>24]<<24|a[c>>>16&255]<<16|a[f>>>8&255]<<8|a[255&l])^n[d++],y=(a[c>>>24]<<24|a[f>>>16&255]<<16|a[l>>>8&255]<<8|a[255&u])^n[d++],v=(a[f>>>24]<<24|a[l>>>16&255]<<16|a[u>>>8&255]<<8|a[255&c])^n[d++],l=(a[l>>>24]<<24|a[u>>>16&255]<<16|a[c>>>8&255]<<8|a[255&f])^n[d++],t[e]=g,t[e+1]=y,t[e+2]=v,t[e+3]=l},keySize:8});t.AES=e._createHelper(n)}(),function(){function t(t,e){var n=(this._lBlock>>>t^this._rBlock)&e;this._rBlock^=n,this._lBlock^=n<<t}function e(t,e){var n=(this._rBlock>>>t^this._lBlock)&e;this._lBlock^=n,this._rBlock^=n<<t}var n=ue,r=(i=n.lib).WordArray,i=i.BlockCipher,s=n.algo,o=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],a=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],h=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],u=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],c=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],f=s.DES=i.extend({_doReset:function(){for(var t=this._key.words,e=[],n=0;56>n;n++){var r=o[n]-1;e[n]=t[r>>>5]>>>31-r%32&1}for(t=this._subKeys=[],r=0;16>r;r++){var i=t[r]=[],s=h[r];for(n=0;24>n;n++)i[n/6|0]|=e[(a[n]-1+s)%28]<<31-n%6,i[4+(n/6|0)]|=e[28+(a[n+24]-1+s)%28]<<31-n%6;for(i[0]=i[0]<<1|i[0]>>>31,n=1;7>n;n++)i[n]>>>=4*(n-1)+3;i[7]=i[7]<<5|i[7]>>>27}for(e=this._invSubKeys=[],n=0;16>n;n++)e[n]=t[15-n]},encryptBlock:function(t,e){this._doCryptBlock(t,e,this._subKeys)},decryptBlock:function(t,e){this._doCryptBlock(t,e,this._invSubKeys)},_doCryptBlock:function(n,r,i){this._lBlock=n[r],this._rBlock=n[r+1],t.call(this,4,252645135),t.call(this,16,65535),e.call(this,2,858993459),e.call(this,8,16711935),t.call(this,1,1431655765);for(var s=0;16>s;s++){for(var o=i[s],a=this._lBlock,h=this._rBlock,f=0,l=0;8>l;l++)f|=u[l][((h^o[l])&c[l])>>>0];this._lBlock=h,this._rBlock=a^f}i=this._lBlock,this._lBlock=this._rBlock,this._rBlock=i,t.call(this,1,1431655765),e.call(this,8,16711935),e.call(this,2,858993459),t.call(this,16,65535),t.call(this,4,252645135),n[r]=this._lBlock,n[r+1]=this._rBlock},keySize:2,ivSize:2,blockSize:2});n.DES=i._createHelper(f),s=s.TripleDES=i.extend({_doReset:function(){var t=this._key.words;this._des1=f.createEncryptor(r.create(t.slice(0,2))),this._des2=f.createEncryptor(r.create(t.slice(2,4))),this._des3=f.createEncryptor(r.create(t.slice(4,6)))},encryptBlock:function(t,e){this._des1.encryptBlock(t,e),this._des2.decryptBlock(t,e),this._des3.encryptBlock(t,e)},decryptBlock:function(t,e){this._des3.decryptBlock(t,e),this._des2.encryptBlock(t,e),this._des1.decryptBlock(t,e)},keySize:6,ivSize:2,blockSize:2}),n.TripleDES=i._createHelper(s)}(),function(){var t=ue,e=t.lib.WordArray;t.enc.Base64={stringify:function(t){var e=t.words,n=t.sigBytes,r=this._map;t.clamp(),t=[];for(var i=0;i<n;i+=3)for(var s=(e[i>>>2]>>>24-i%4*8&255)<<16|(e[i+1>>>2]>>>24-(i+1)%4*8&255)<<8|e[i+2>>>2]>>>24-(i+2)%4*8&255,o=0;4>o&&i+.75*o<n;o++)t.push(r.charAt(s>>>6*(3-o)&63));if(e=r.charAt(64))for(;t.length%4;)t.push(e);return t.join("")},parse:function(t){var n=t.length,r=this._map;(i=r.charAt(64))&&(-1!=(i=t.indexOf(i))&&(n=i));for(var i=[],s=0,o=0;o<n;o++)if(o%4){var a=r.indexOf(t.charAt(o-1))<<o%4*2,h=r.indexOf(t.charAt(o))>>>6-o%4*2;i[s>>>2]|=(a|h)<<24-s%4*8,s++}return e.create(i,s)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),function(t){function e(t,e,n,r,i,s,o){return((t=t+(e&n|~e&r)+i+o)<<s|t>>>32-s)+e}function n(t,e,n,r,i,s,o){return((t=t+(e&r|n&~r)+i+o)<<s|t>>>32-s)+e}function r(t,e,n,r,i,s,o){return((t=t+(e^n^r)+i+o)<<s|t>>>32-s)+e}function i(t,e,n,r,i,s,o){return((t=t+(n^(e|~r))+i+o)<<s|t>>>32-s)+e}for(var s=ue,o=(h=s.lib).WordArray,a=h.Hasher,h=s.algo,u=[],c=0;64>c;c++)u[c]=4294967296*t.abs(t.sin(c+1))|0;h=h.MD5=a.extend({_doReset:function(){this._hash=new o.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(t,s){for(var o=0;16>o;o++){var a=t[h=s+o];t[h]=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8)}o=this._hash.words;var h=t[s+0],c=(a=t[s+1],t[s+2]),f=t[s+3],l=t[s+4],d=t[s+5],p=t[s+6],g=t[s+7],y=t[s+8],v=t[s+9],m=t[s+10],w=t[s+11],b=t[s+12],S=t[s+13],x=t[s+14],E=t[s+15],F=e(F=o[0],T=o[1],C=o[2],A=o[3],h,7,u[0]),A=e(A,F,T,C,a,12,u[1]),C=e(C,A,F,T,c,17,u[2]),T=e(T,C,A,F,f,22,u[3]);F=e(F,T,C,A,l,7,u[4]),A=e(A,F,T,C,d,12,u[5]),C=e(C,A,F,T,p,17,u[6]),T=e(T,C,A,F,g,22,u[7]),F=e(F,T,C,A,y,7,u[8]),A=e(A,F,T,C,v,12,u[9]),C=e(C,A,F,T,m,17,u[10]),T=e(T,C,A,F,w,22,u[11]),F=e(F,T,C,A,b,7,u[12]),A=e(A,F,T,C,S,12,u[13]),C=e(C,A,F,T,x,17,u[14]),F=n(F,T=e(T,C,A,F,E,22,u[15]),C,A,a,5,u[16]),A=n(A,F,T,C,p,9,u[17]),C=n(C,A,F,T,w,14,u[18]),T=n(T,C,A,F,h,20,u[19]),F=n(F,T,C,A,d,5,u[20]),A=n(A,F,T,C,m,9,u[21]),C=n(C,A,F,T,E,14,u[22]),T=n(T,C,A,F,l,20,u[23]),F=n(F,T,C,A,v,5,u[24]),A=n(A,F,T,C,x,9,u[25]),C=n(C,A,F,T,f,14,u[26]),T=n(T,C,A,F,y,20,u[27]),F=n(F,T,C,A,S,5,u[28]),A=n(A,F,T,C,c,9,u[29]),C=n(C,A,F,T,g,14,u[30]),F=r(F,T=n(T,C,A,F,b,20,u[31]),C,A,d,4,u[32]),A=r(A,F,T,C,y,11,u[33]),C=r(C,A,F,T,w,16,u[34]),T=r(T,C,A,F,x,23,u[35]),F=r(F,T,C,A,a,4,u[36]),A=r(A,F,T,C,l,11,u[37]),C=r(C,A,F,T,g,16,u[38]),T=r(T,C,A,F,m,23,u[39]),F=r(F,T,C,A,S,4,u[40]),A=r(A,F,T,C,h,11,u[41]),C=r(C,A,F,T,f,16,u[42]),T=r(T,C,A,F,p,23,u[43]),F=r(F,T,C,A,v,4,u[44]),A=r(A,F,T,C,b,11,u[45]),C=r(C,A,F,T,E,16,u[46]),F=i(F,T=r(T,C,A,F,c,23,u[47]),C,A,h,6,u[48]),A=i(A,F,T,C,g,10,u[49]),C=i(C,A,F,T,x,15,u[50]),T=i(T,C,A,F,d,21,u[51]),F=i(F,T,C,A,b,6,u[52]),A=i(A,F,T,C,f,10,u[53]),C=i(C,A,F,T,m,15,u[54]),T=i(T,C,A,F,a,21,u[55]),F=i(F,T,C,A,y,6,u[56]),A=i(A,F,T,C,E,10,u[57]),C=i(C,A,F,T,p,15,u[58]),T=i(T,C,A,F,S,21,u[59]),F=i(F,T,C,A,l,6,u[60]),A=i(A,F,T,C,w,10,u[61]),C=i(C,A,F,T,c,15,u[62]),T=i(T,C,A,F,v,21,u[63]);o[0]=o[0]+F|0,o[1]=o[1]+T|0,o[2]=o[2]+C|0,o[3]=o[3]+A|0},_doFinalize:function(){var e=this._data,n=e.words,r=8*this._nDataBytes,i=8*e.sigBytes;n[i>>>5]|=128<<24-i%32;var s=t.floor(r/4294967296);for(n[15+(i+64>>>9<<4)]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),n[14+(i+64>>>9<<4)]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8),e.sigBytes=4*(n.length+1),this._process(),n=(e=this._hash).words,r=0;4>r;r++)i=n[r],n[r]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8);return e},clone:function(){var t=a.clone.call(this);return t._hash=this._hash.clone(),t}}),s.MD5=a._createHelper(h),s.HmacMD5=a._createHmacHelper(h)}(Math),function(){var t=ue,e=(i=t.lib).WordArray,n=i.Hasher,r=[],i=t.algo.SHA1=n.extend({_doReset:function(){this._hash=new e.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(t,e){for(var n=this._hash.words,i=n[0],s=n[1],o=n[2],a=n[3],h=n[4],u=0;80>u;u++){if(16>u)r[u]=0|t[e+u];else{var c=r[u-3]^r[u-8]^r[u-14]^r[u-16];r[u]=c<<1|c>>>31}c=(i<<5|i>>>27)+h+r[u],c=20>u?c+(1518500249+(s&o|~s&a)):40>u?c+(1859775393+(s^o^a)):60>u?c+((s&o|s&a|o&a)-1894007588):c+((s^o^a)-899497514),h=a,a=o,o=s<<30|s>>>2,s=i,i=c}n[0]=n[0]+i|0,n[1]=n[1]+s|0,n[2]=n[2]+o|0,n[3]=n[3]+a|0,n[4]=n[4]+h|0},_doFinalize:function(){var t=this._data,e=t.words,n=8*this._nDataBytes,r=8*t.sigBytes;return e[r>>>5]|=128<<24-r%32,e[14+(r+64>>>9<<4)]=Math.floor(n/4294967296),e[15+(r+64>>>9<<4)]=n,t.sigBytes=4*e.length,this._process(),this._hash},clone:function(){var t=n.clone.call(this);return t._hash=this._hash.clone(),t}});t.SHA1=n._createHelper(i),t.HmacSHA1=n._createHmacHelper(i)}(),function(t){for(var e=ue,n=(i=e.lib).WordArray,r=i.Hasher,i=e.algo,s=[],o=[],a=function(t){return 4294967296*(t-(0|t))|0},h=2,u=0;64>u;){var c;t:{c=h;for(var f=t.sqrt(c),l=2;l<=f;l++)if(!(c%l)){c=!1;break t}c=!0}c&&(8>u&&(s[u]=a(t.pow(h,.5))),o[u]=a(t.pow(h,1/3)),u++),h++}var d=[];i=i.SHA256=r.extend({_doReset:function(){this._hash=new n.init(s.slice(0))},_doProcessBlock:function(t,e){for(var n=this._hash.words,r=n[0],i=n[1],s=n[2],a=n[3],h=n[4],u=n[5],c=n[6],f=n[7],l=0;64>l;l++){if(16>l)d[l]=0|t[e+l];else{var p=d[l-15],g=d[l-2];d[l]=((p<<25|p>>>7)^(p<<14|p>>>18)^p>>>3)+d[l-7]+((g<<15|g>>>17)^(g<<13|g>>>19)^g>>>10)+d[l-16]}p=f+((h<<26|h>>>6)^(h<<21|h>>>11)^(h<<7|h>>>25))+(h&u^~h&c)+o[l]+d[l],g=((r<<30|r>>>2)^(r<<19|r>>>13)^(r<<10|r>>>22))+(r&i^r&s^i&s),f=c,c=u,u=h,h=a+p|0,a=s,s=i,i=r,r=p+g|0}n[0]=n[0]+r|0,n[1]=n[1]+i|0,n[2]=n[2]+s|0,n[3]=n[3]+a|0,n[4]=n[4]+h|0,n[5]=n[5]+u|0,n[6]=n[6]+c|0,n[7]=n[7]+f|0},_doFinalize:function(){var e=this._data,n=e.words,r=8*this._nDataBytes,i=8*e.sigBytes;return n[i>>>5]|=128<<24-i%32,n[14+(i+64>>>9<<4)]=t.floor(r/4294967296),n[15+(i+64>>>9<<4)]=r,e.sigBytes=4*n.length,this._process(),this._hash},clone:function(){var t=r.clone.call(this);return t._hash=this._hash.clone(),t}});e.SHA256=r._createHelper(i),e.HmacSHA256=r._createHmacHelper(i)}(Math),oe=(se=ue).lib.WordArray,ae=(he=se.algo).SHA256,he=he.SHA224=ae.extend({_doReset:function(){this._hash=new oe.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var t=ae._doFinalize.call(this);return t.sigBytes-=4,t}}),se.SHA224=ae._createHelper(he),se.HmacSHA224=ae._createHmacHelper(he),function(){function t(){return r.create.apply(r,arguments)}for(var e=ue,n=e.lib.Hasher,r=(s=e.x64).Word,i=s.WordArray,s=e.algo,o=[t(1116352408,3609767458),t(1899447441,602891725),t(3049323471,3964484399),t(3921009573,2173295548),t(961987163,4081628472),t(1508970993,3053834265),t(2453635748,2937671579),t(2870763221,3664609560),t(3624381080,2734883394),t(310598401,1164996542),t(607225278,1323610764),t(1426881987,3590304994),t(1925078388,4068182383),t(2162078206,991336113),t(2614888103,633803317),t(3248222580,3479774868),t(3835390401,2666613458),t(4022224774,944711139),t(264347078,2341262773),t(604807628,2007800933),t(770255983,1495990901),t(1249150122,1856431235),t(1555081692,3175218132),t(1996064986,2198950837),t(2554220882,3999719339),t(2821834349,766784016),t(2952996808,2566594879),t(3210313671,3203337956),t(3336571891,1034457026),t(3584528711,2466948901),t(113926993,3758326383),t(338241895,168717936),t(666307205,1188179964),t(773529912,1546045734),t(1294757372,1522805485),t(1396182291,2643833823),t(1695183700,2343527390),t(1986661051,1014477480),t(2177026350,1206759142),t(2456956037,344077627),t(2730485921,1290863460),t(2820302411,3158454273),t(3259730800,3505952657),t(3345764771,106217008),t(3516065817,3606008344),t(3600352804,1432725776),t(4094571909,1467031594),t(275423344,851169720),t(430227734,3100823752),t(506948616,1363258195),t(659060556,3750685593),t(883997877,3785050280),t(958139571,3318307427),t(1322822218,3812723403),t(1537002063,2003034995),t(1747873779,3602036899),t(1955562222,1575990012),t(2024104815,1125592928),t(2227730452,2716904306),t(2361852424,442776044),t(2428436474,593698344),t(2756734187,3733110249),t(3204031479,2999351573),t(3329325298,3815920427),t(3391569614,3928383900),t(3515267271,566280711),t(3940187606,3454069534),t(4118630271,4000239992),t(116418474,1914138554),t(174292421,2731055270),t(289380356,3203993006),t(460393269,320620315),t(685471733,587496836),t(852142971,1086792851),t(1017036298,365543100),t(1126000580,2618297676),t(1288033470,3409855158),t(1501505948,4234509866),t(1607167915,987167468),t(1816402316,1246189591)],a=[],h=0;80>h;h++)a[h]=t();s=s.SHA512=n.extend({_doReset:function(){this._hash=new i.init([new r.init(1779033703,4089235720),new r.init(3144134277,2227873595),new r.init(1013904242,4271175723),new r.init(2773480762,1595750129),new r.init(1359893119,2917565137),new r.init(2600822924,725511199),new r.init(528734635,4215389547),new r.init(1541459225,327033209)])},_doProcessBlock:function(t,e){for(var n=(f=this._hash.words)[0],r=f[1],i=f[2],s=f[3],h=f[4],u=f[5],c=f[6],f=f[7],l=n.high,d=n.low,p=r.high,g=r.low,y=i.high,v=i.low,m=s.high,w=s.low,b=h.high,S=h.low,x=u.high,E=u.low,F=c.high,A=c.low,C=f.high,T=f.low,P=l,D=d,I=p,R=g,B=y,H=v,_=m,k=w,N=b,O=S,j=x,L=E,M=F,V=A,K=C,U=T,q=0;80>q;q++){var z=a[q];if(16>q)var Y=z.high=0|t[e+2*q],W=z.low=0|t[e+2*q+1];else{Y=((W=(Y=a[q-15]).high)>>>1|(G=Y.low)<<31)^(W>>>8|G<<24)^W>>>7;var G=(G>>>1|W<<31)^(G>>>8|W<<24)^(G>>>7|W<<25),J=((W=(J=a[q-2]).high)>>>19|(X=J.low)<<13)^(W<<3|X>>>29)^W>>>6,X=(X>>>19|W<<13)^(X<<3|W>>>29)^(X>>>6|W<<26),$=(W=a[q-7]).high,Z=(Q=a[q-16]).high,Q=Q.low;Y=(Y=(Y=Y+$+((W=G+W.low)>>>0<G>>>0?1:0))+J+((W=W+X)>>>0<X>>>0?1:0))+Z+((W=W+Q)>>>0<Q>>>0?1:0);z.high=Y,z.low=W}$=N&j^~N&M,Q=O&L^~O&V,z=P&I^P&B^I&B;var tt=D&R^D&H^R&H,et=(G=(P>>>28|D<<4)^(P<<30|D>>>2)^(P<<25|D>>>7),J=(D>>>28|P<<4)^(D<<30|P>>>2)^(D<<25|P>>>7),(X=o[q]).high),nt=X.low;Z=K+((N>>>14|O<<18)^(N>>>18|O<<14)^(N<<23|O>>>9))+((X=U+((O>>>14|N<<18)^(O>>>18|N<<14)^(O<<23|N>>>9)))>>>0<U>>>0?1:0),K=M,U=V,M=j,V=L,j=N,L=O,N=_+(Z=(Z=(Z=Z+$+((X=X+Q)>>>0<Q>>>0?1:0))+et+((X=X+nt)>>>0<nt>>>0?1:0))+Y+((X=X+W)>>>0<W>>>0?1:0))+((O=k+X|0)>>>0<k>>>0?1:0)|0,_=B,k=H,B=I,H=R,I=P,R=D,P=Z+(z=G+z+((W=J+tt)>>>0<J>>>0?1:0))+((D=X+W|0)>>>0<X>>>0?1:0)|0}d=n.low=d+D,n.high=l+P+(d>>>0<D>>>0?1:0),g=r.low=g+R,r.high=p+I+(g>>>0<R>>>0?1:0),v=i.low=v+H,i.high=y+B+(v>>>0<H>>>0?1:0),w=s.low=w+k,s.high=m+_+(w>>>0<k>>>0?1:0),S=h.low=S+O,h.high=b+N+(S>>>0<O>>>0?1:0),E=u.low=E+L,u.high=x+j+(E>>>0<L>>>0?1:0),A=c.low=A+V,c.high=F+M+(A>>>0<V>>>0?1:0),T=f.low=T+U,f.high=C+K+(T>>>0<U>>>0?1:0)},_doFinalize:function(){var t=this._data,e=t.words,n=8*this._nDataBytes,r=8*t.sigBytes;return e[r>>>5]|=128<<24-r%32,e[30+(r+128>>>10<<5)]=Math.floor(n/4294967296),e[31+(r+128>>>10<<5)]=n,t.sigBytes=4*e.length,this._process(),this._hash.toX32()},clone:function(){var t=n.clone.call(this);return t._hash=this._hash.clone(),t},blockSize:32}),e.SHA512=n._createHelper(s),e.HmacSHA512=n._createHmacHelper(s)}(),function(){var t=ue,e=(i=t.x64).Word,n=i.WordArray,r=(i=t.algo).SHA512,i=i.SHA384=r.extend({_doReset:function(){this._hash=new n.init([new e.init(3418070365,3238371032),new e.init(1654270250,914150663),new e.init(2438529370,812702999),new e.init(355462360,4144912697),new e.init(1731405415,4290775857),new e.init(2394180231,1750603025),new e.init(3675008525,1694076839),new e.init(1203062813,3204075428)])},_doFinalize:function(){var t=r._doFinalize.call(this);return t.sigBytes-=16,t}});t.SHA384=r._createHelper(i),t.HmacSHA384=r._createHmacHelper(i)}(),function(){var t=ue,e=(r=t.lib).WordArray,n=r.Hasher,r=t.algo,i=e.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),s=e.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),o=e.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),a=e.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),h=e.create([0,1518500249,1859775393,2400959708,2840853838]),u=e.create([1352829926,1548603684,1836072691,2053994217,0]);r=r.RIPEMD160=n.extend({_doReset:function(){this._hash=e.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(t,e){for(var n=0;16>n;n++){var r=t[b=e+n];t[b]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8)}var c,f,l,d,p,g,y,v,m,w,b=this._hash.words,S=(r=h.words,u.words),x=i.words,E=s.words,F=o.words,A=a.words;g=c=b[0],y=f=b[1],v=l=b[2],m=d=b[3],w=p=b[4];var C;for(n=0;80>n;n+=1)C=c+t[e+x[n]]|0,C=16>n?C+((f^l^d)+r[0]):32>n?C+((f&l|~f&d)+r[1]):48>n?C+(((f|~l)^d)+r[2]):64>n?C+((f&d|l&~d)+r[3]):C+((f^(l|~d))+r[4]),C=(C=(C|=0)<<F[n]|C>>>32-F[n])+p|0,c=p,p=d,d=l<<10|l>>>22,l=f,f=C,C=g+t[e+E[n]]|0,C=16>n?C+((y^(v|~m))+S[0]):32>n?C+((y&m|v&~m)+S[1]):48>n?C+(((y|~v)^m)+S[2]):64>n?C+((y&v|~y&m)+S[3]):C+((y^v^m)+S[4]),C=(C=(C|=0)<<A[n]|C>>>32-A[n])+w|0,g=w,w=m,m=v<<10|v>>>22,v=y,y=C;C=b[1]+l+m|0,b[1]=b[2]+d+w|0,b[2]=b[3]+p+g|0,b[3]=b[4]+c+y|0,b[4]=b[0]+f+v|0,b[0]=C},_doFinalize:function(){var t=this._data,e=t.words,n=8*this._nDataBytes,r=8*t.sigBytes;for(e[r>>>5]|=128<<24-r%32,e[14+(r+64>>>9<<4)]=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8),t.sigBytes=4*(e.length+1),this._process(),e=(t=this._hash).words,n=0;5>n;n++)r=e[n],e[n]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8);return t},clone:function(){var t=n.clone.call(this);return t._hash=this._hash.clone(),t}});t.RIPEMD160=n._createHelper(r),t.HmacRIPEMD160=n._createHmacHelper(r)}(Math),function(){var t=ue,e=t.enc.Utf8;t.algo.HMAC=t.lib.Base.extend({init:function(t,n){t=this._hasher=new t.init,"string"==typeof n&&(n=e.parse(n));var r=t.blockSize,i=4*r;n.sigBytes>i&&(n=t.finalize(n)),n.clamp();for(var s=this._oKey=n.clone(),o=this._iKey=n.clone(),a=s.words,h=o.words,u=0;u<r;u++)a[u]^=1549556828,h[u]^=909522486;s.sigBytes=o.sigBytes=i,this.reset()},reset:function(){var t=this._hasher;t.reset(),t.update(this._iKey)},update:function(t){return this._hasher.update(t),this},finalize:function(t){var e=this._hasher;return t=e.finalize(t),e.reset(),e.finalize(this._oKey.clone().concat(t))}})}(),function(){var t,e=ue,n=(t=e.lib).Base,r=t.WordArray,i=(t=e.algo).HMAC,s=t.PBKDF2=n.extend({cfg:n.extend({keySize:4,hasher:t.SHA1,iterations:1}),init:function(t){this.cfg=this.cfg.extend(t)},compute:function(t,e){var n=this.cfg,s=i.create(n.hasher,t),o=r.create(),a=r.create([1]),h=o.words,u=a.words,c=n.keySize;for(n=n.iterations;h.length<c;){var f=s.update(e).finalize(a);s.reset();for(var l=f.words,d=l.length,p=f,g=1;g<n;g++){p=s.finalize(p),s.reset();for(var y=p.words,v=0;v<d;v++)l[v]^=y[v]}o.concat(f),u[0]++}return o.sigBytes=4*c,o}});e.PBKDF2=function(t,e,n){return s.create(n).compute(t,e)}}();var ce="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",fe="=";function le(t){var e,n,r="";for(e=0;e+3<=t.length;e+=3)n=parseInt(t.substring(e,e+3),16),r+=ce.charAt(n>>6)+ce.charAt(63&n);for(e+1==t.length?(n=parseInt(t.substring(e,e+1),16),r+=ce.charAt(n<<2)):e+2==t.length&&(n=parseInt(t.substring(e,e+2),16),r+=ce.charAt(n>>2)+ce.charAt((3&n)<<4));(3&r.length)>0;)r+=fe;return r}function de(t){var e,n,r,i="",s=0;for(e=0;e<t.length&&t.charAt(e)!=fe;++e)(r=ce.indexOf(t.charAt(e)))<0||(0==s?(i+=be(r>>2),n=3&r,s=1):1==s?(i+=be(n<<2|r>>4),n=15&r,s=2):2==s?(i+=be(n),i+=be(r>>2),n=3&r,s=3):(i+=be(n<<2|r>>4),i+=be(15&r),s=0));return 1==s&&(i+=be(n<<2)),i}function pe(t,e,n){null!=t&&("number"==typeof t?this.fromNumber(t,e,n):null==e&&"string"!=typeof t?this.fromString(t,256):this.fromString(t,e))}function ge(){return new pe(null)}pe.prototype.am=function(t,e,n,r,i,s){for(;--s>=0;){var o=e*this[t++]+n[r]+i;i=Math.floor(o/67108864),n[r++]=67108863&o}return i},pe.prototype.DB=26,pe.prototype.DM=67108863,pe.prototype.DV=1<<26;pe.prototype.FV=Math.pow(2,52),pe.prototype.F1=26,pe.prototype.F2=0;var ye,ve,me="0123456789abcdefghijklmnopqrstuvwxyz",we=new Array;for(ye="0".charCodeAt(0),ve=0;ve<=9;++ve)we[ye++]=ve;for(ye="a".charCodeAt(0),ve=10;ve<36;++ve)we[ye++]=ve;for(ye="A".charCodeAt(0),ve=10;ve<36;++ve)we[ye++]=ve;function be(t){return me.charAt(t)}function Se(t,e){var n=we[t.charCodeAt(e)];return null==n?-1:n}function xe(t){var e=ge();return e.fromInt(t),e}function Ee(t){var e,n=1;return 0!=(e=t>>>16)&&(t=e,n+=16),0!=(e=t>>8)&&(t=e,n+=8),0!=(e=t>>4)&&(t=e,n+=4),0!=(e=t>>2)&&(t=e,n+=2),0!=(e=t>>1)&&(t=e,n+=1),n}function Fe(t){this.m=t}function Ae(t){this.m=t,this.mp=t.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}function Ce(t,e){return t&e}function Te(t,e){return t|e}function Pe(t,e){return t^e}function De(t,e){return t&~e}function Ie(t){if(0==t)return-1;var e=0;return 0==(65535&t)&&(t>>=16,e+=16),0==(255&t)&&(t>>=8,e+=8),0==(15&t)&&(t>>=4,e+=4),0==(3&t)&&(t>>=2,e+=2),0==(1&t)&&++e,e}function Re(t){for(var e=0;0!=t;)t&=t-1,++e;return e}function Be(){}function He(t){return t}function _e(t){this.r2=ge(),this.q3=ge(),pe.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t),this.m=t}Fe.prototype.convert=function(t){return t.s<0||t.compareTo(this.m)>=0?t.mod(this.m):t},Fe.prototype.revert=function(t){return t},Fe.prototype.reduce=function(t){t.divRemTo(this.m,null,t)},Fe.prototype.mulTo=function(t,e,n){t.multiplyTo(e,n),this.reduce(n)},Fe.prototype.sqrTo=function(t,e){t.squareTo(e),this.reduce(e)},Ae.prototype.convert=function(t){var e=ge();return t.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),t.s<0&&e.compareTo(pe.ZERO)>0&&this.m.subTo(e,e),e},Ae.prototype.revert=function(t){var e=ge();return t.copyTo(e),this.reduce(e),e},Ae.prototype.reduce=function(t){for(;t.t<=this.mt2;)t[t.t++]=0;for(var e=0;e<this.m.t;++e){var n=32767&t[e],r=n*this.mpl+((n*this.mph+(t[e]>>15)*this.mpl&this.um)<<15)&t.DM;for(t[n=e+this.m.t]+=this.m.am(0,r,t,e,0,this.m.t);t[n]>=t.DV;)t[n]-=t.DV,t[++n]++}t.clamp(),t.drShiftTo(this.m.t,t),t.compareTo(this.m)>=0&&t.subTo(this.m,t)},Ae.prototype.mulTo=function(t,e,n){t.multiplyTo(e,n),this.reduce(n)},Ae.prototype.sqrTo=function(t,e){t.squareTo(e),this.reduce(e)},pe.prototype.copyTo=function(t){for(var e=this.t-1;e>=0;--e)t[e]=this[e];t.t=this.t,t.s=this.s},pe.prototype.fromInt=function(t){this.t=1,this.s=t<0?-1:0,t>0?this[0]=t:t<-1?this[0]=t+this.DV:this.t=0},pe.prototype.fromString=function(t,e){var n;if(16==e)n=4;else if(8==e)n=3;else if(256==e)n=8;else if(2==e)n=1;else if(32==e)n=5;else{if(4!=e)return void this.fromRadix(t,e);n=2}this.t=0,this.s=0;for(var r=t.length,i=!1,s=0;--r>=0;){var o=8==n?255&t[r]:Se(t,r);o<0?"-"==t.charAt(r)&&(i=!0):(i=!1,0==s?this[this.t++]=o:s+n>this.DB?(this[this.t-1]|=(o&(1<<this.DB-s)-1)<<s,this[this.t++]=o>>this.DB-s):this[this.t-1]|=o<<s,(s+=n)>=this.DB&&(s-=this.DB))}8==n&&0!=(128&t[0])&&(this.s=-1,s>0&&(this[this.t-1]|=(1<<this.DB-s)-1<<s)),this.clamp(),i&&pe.ZERO.subTo(this,this)},pe.prototype.clamp=function(){for(var t=this.s&this.DM;this.t>0&&this[this.t-1]==t;)--this.t},pe.prototype.dlShiftTo=function(t,e){var n;for(n=this.t-1;n>=0;--n)e[n+t]=this[n];for(n=t-1;n>=0;--n)e[n]=0;e.t=this.t+t,e.s=this.s},pe.prototype.drShiftTo=function(t,e){for(var n=t;n<this.t;++n)e[n-t]=this[n];e.t=Math.max(this.t-t,0),e.s=this.s},pe.prototype.lShiftTo=function(t,e){var n,r=t%this.DB,i=this.DB-r,s=(1<<i)-1,o=Math.floor(t/this.DB),a=this.s<<r&this.DM;for(n=this.t-1;n>=0;--n)e[n+o+1]=this[n]>>i|a,a=(this[n]&s)<<r;for(n=o-1;n>=0;--n)e[n]=0;e[o]=a,e.t=this.t+o+1,e.s=this.s,e.clamp()},pe.prototype.rShiftTo=function(t,e){e.s=this.s;var n=Math.floor(t/this.DB);if(n>=this.t)e.t=0;else{var r=t%this.DB,i=this.DB-r,s=(1<<r)-1;e[0]=this[n]>>r;for(var o=n+1;o<this.t;++o)e[o-n-1]|=(this[o]&s)<<i,e[o-n]=this[o]>>r;r>0&&(e[this.t-n-1]|=(this.s&s)<<i),e.t=this.t-n,e.clamp()}},pe.prototype.subTo=function(t,e){for(var n=0,r=0,i=Math.min(t.t,this.t);n<i;)r+=this[n]-t[n],e[n++]=r&this.DM,r>>=this.DB;if(t.t<this.t){for(r-=t.s;n<this.t;)r+=this[n],e[n++]=r&this.DM,r>>=this.DB;r+=this.s}else{for(r+=this.s;n<t.t;)r-=t[n],e[n++]=r&this.DM,r>>=this.DB;r-=t.s}e.s=r<0?-1:0,r<-1?e[n++]=this.DV+r:r>0&&(e[n++]=r),e.t=n,e.clamp()},pe.prototype.multiplyTo=function(t,e){var n=this.abs(),r=t.abs(),i=n.t;for(e.t=i+r.t;--i>=0;)e[i]=0;for(i=0;i<r.t;++i)e[i+n.t]=n.am(0,r[i],e,i,0,n.t);e.s=0,e.clamp(),this.s!=t.s&&pe.ZERO.subTo(e,e)},pe.prototype.squareTo=function(t){for(var e=this.abs(),n=t.t=2*e.t;--n>=0;)t[n]=0;for(n=0;n<e.t-1;++n){var r=e.am(n,e[n],t,2*n,0,1);(t[n+e.t]+=e.am(n+1,2*e[n],t,2*n+1,r,e.t-n-1))>=e.DV&&(t[n+e.t]-=e.DV,t[n+e.t+1]=1)}t.t>0&&(t[t.t-1]+=e.am(n,e[n],t,2*n,0,1)),t.s=0,t.clamp()},pe.prototype.divRemTo=function(t,e,n){var r=t.abs();if(!(r.t<=0)){var i=this.abs();if(i.t<r.t)return null!=e&&e.fromInt(0),void(null!=n&&this.copyTo(n));null==n&&(n=ge());var s=ge(),o=this.s,a=t.s,h=this.DB-Ee(r[r.t-1]);h>0?(r.lShiftTo(h,s),i.lShiftTo(h,n)):(r.copyTo(s),i.copyTo(n));var u=s.t,c=s[u-1];if(0!=c){var f=c*(1<<this.F1)+(u>1?s[u-2]>>this.F2:0),l=this.FV/f,d=(1<<this.F1)/f,p=1<<this.F2,g=n.t,y=g-u,v=null==e?ge():e;for(s.dlShiftTo(y,v),n.compareTo(v)>=0&&(n[n.t++]=1,n.subTo(v,n)),pe.ONE.dlShiftTo(u,v),v.subTo(s,s);s.t<u;)s[s.t++]=0;for(;--y>=0;){var m=n[--g]==c?this.DM:Math.floor(n[g]*l+(n[g-1]+p)*d);if((n[g]+=s.am(0,m,n,y,0,u))<m)for(s.dlShiftTo(y,v),n.subTo(v,n);n[g]<--m;)n.subTo(v,n)}null!=e&&(n.drShiftTo(u,e),o!=a&&pe.ZERO.subTo(e,e)),n.t=u,n.clamp(),h>0&&n.rShiftTo(h,n),o<0&&pe.ZERO.subTo(n,n)}}},pe.prototype.invDigit=function(){if(this.t<1)return 0;var t=this[0];if(0==(1&t))return 0;var e=3&t;return(e=(e=(e=(e=e*(2-(15&t)*e)&15)*(2-(255&t)*e)&255)*(2-((65535&t)*e&65535))&65535)*(2-t*e%this.DV)%this.DV)>0?this.DV-e:-e},pe.prototype.isEven=function(){return 0==(this.t>0?1&this[0]:this.s)},pe.prototype.exp=function(t,e){if(t>4294967295||t<1)return pe.ONE;var n=ge(),r=ge(),i=e.convert(this),s=Ee(t)-1;for(i.copyTo(n);--s>=0;)if(e.sqrTo(n,r),(t&1<<s)>0)e.mulTo(r,i,n);else{var o=n;n=r,r=o}return e.revert(n)},pe.prototype.toString=function(t){if(this.s<0)return"-"+this.negate().toString(t);var e;if(16==t)e=4;else if(8==t)e=3;else if(2==t)e=1;else if(32==t)e=5;else{if(4!=t)return this.toRadix(t);e=2}var n,r=(1<<e)-1,i=!1,s="",o=this.t,a=this.DB-o*this.DB%e;if(o-- >0)for(a<this.DB&&(n=this[o]>>a)>0&&(i=!0,s=be(n));o>=0;)a<e?(n=(this[o]&(1<<a)-1)<<e-a,n|=this[--o]>>(a+=this.DB-e)):(n=this[o]>>(a-=e)&r,a<=0&&(a+=this.DB,--o)),n>0&&(i=!0),i&&(s+=be(n));return i?s:"0"},pe.prototype.negate=function(){var t=ge();return pe.ZERO.subTo(this,t),t},pe.prototype.abs=function(){return this.s<0?this.negate():this},pe.prototype.compareTo=function(t){var e=this.s-t.s;if(0!=e)return e;var n=this.t;if(0!=(e=n-t.t))return this.s<0?-e:e;for(;--n>=0;)if(0!=(e=this[n]-t[n]))return e;return 0},pe.prototype.bitLength=function(){return this.t<=0?0:this.DB*(this.t-1)+Ee(this[this.t-1]^this.s&this.DM)},pe.prototype.mod=function(t){var e=ge();return this.abs().divRemTo(t,null,e),this.s<0&&e.compareTo(pe.ZERO)>0&&t.subTo(e,e),e},pe.prototype.modPowInt=function(t,e){var n;return n=t<256||e.isEven()?new Fe(e):new Ae(e),this.exp(t,n)},pe.ZERO=xe(0),pe.ONE=xe(1),Be.prototype.convert=He,Be.prototype.revert=He,Be.prototype.mulTo=function(t,e,n){t.multiplyTo(e,n)},Be.prototype.sqrTo=function(t,e){t.squareTo(e)},_e.prototype.convert=function(t){if(t.s<0||t.t>2*this.m.t)return t.mod(this.m);if(t.compareTo(this.m)<0)return t;var e=ge();return t.copyTo(e),this.reduce(e),e},_e.prototype.revert=function(t){return t},_e.prototype.reduce=function(t){for(t.drShiftTo(this.m.t-1,this.r2),t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);t.compareTo(this.r2)<0;)t.dAddOffset(1,this.m.t+1);for(t.subTo(this.r2,t);t.compareTo(this.m)>=0;)t.subTo(this.m,t)},_e.prototype.mulTo=function(t,e,n){t.multiplyTo(e,n),this.reduce(n)},_e.prototype.sqrTo=function(t,e){t.squareTo(e),this.reduce(e)};var ke=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],Ne=(1<<26)/ke[ke.length-1];function Oe(){this.i=0,this.j=0,this.S=new Array}pe.prototype.chunkSize=function(t){return Math.floor(Math.LN2*this.DB/Math.log(t))},pe.prototype.toRadix=function(t){if(null==t&&(t=10),0==this.signum()||t<2||t>36)return"0";var e=this.chunkSize(t),n=Math.pow(t,e),r=xe(n),i=ge(),s=ge(),o="";for(this.divRemTo(r,i,s);i.signum()>0;)o=(n+s.intValue()).toString(t).substr(1)+o,i.divRemTo(r,i,s);return s.intValue().toString(t)+o},pe.prototype.fromRadix=function(t,e){this.fromInt(0),null==e&&(e=10);for(var n=this.chunkSize(e),r=Math.pow(e,n),i=!1,s=0,o=0,a=0;a<t.length;++a){var h=Se(t,a);h<0?"-"==t.charAt(a)&&0==this.signum()&&(i=!0):(o=e*o+h,++s>=n&&(this.dMultiply(r),this.dAddOffset(o,0),s=0,o=0))}s>0&&(this.dMultiply(Math.pow(e,s)),this.dAddOffset(o,0)),i&&pe.ZERO.subTo(this,this)},pe.prototype.fromNumber=function(t,e,n){if("number"==typeof e)if(t<2)this.fromInt(1);else for(this.fromNumber(t,n),this.testBit(t-1)||this.bitwiseTo(pe.ONE.shiftLeft(t-1),Te,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(e);)this.dAddOffset(2,0),this.bitLength()>t&&this.subTo(pe.ONE.shiftLeft(t-1),this);else{var r=new Array,i=7&t;r.length=1+(t>>3),e.nextBytes(r),i>0?r[0]&=(1<<i)-1:r[0]=0,this.fromString(r,256)}},pe.prototype.bitwiseTo=function(t,e,n){var r,i,s=Math.min(t.t,this.t);for(r=0;r<s;++r)n[r]=e(this[r],t[r]);if(t.t<this.t){for(i=t.s&this.DM,r=s;r<this.t;++r)n[r]=e(this[r],i);n.t=this.t}else{for(i=this.s&this.DM,r=s;r<t.t;++r)n[r]=e(i,t[r]);n.t=t.t}n.s=e(this.s,t.s),n.clamp()},pe.prototype.changeBit=function(t,e){var n=pe.ONE.shiftLeft(t);return this.bitwiseTo(n,e,n),n},pe.prototype.addTo=function(t,e){for(var n=0,r=0,i=Math.min(t.t,this.t);n<i;)r+=this[n]+t[n],e[n++]=r&this.DM,r>>=this.DB;if(t.t<this.t){for(r+=t.s;n<this.t;)r+=this[n],e[n++]=r&this.DM,r>>=this.DB;r+=this.s}else{for(r+=this.s;n<t.t;)r+=t[n],e[n++]=r&this.DM,r>>=this.DB;r+=t.s}e.s=r<0?-1:0,r>0?e[n++]=r:r<-1&&(e[n++]=this.DV+r),e.t=n,e.clamp()},pe.prototype.dMultiply=function(t){this[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()},pe.prototype.dAddOffset=function(t,e){if(0!=t){for(;this.t<=e;)this[this.t++]=0;for(this[e]+=t;this[e]>=this.DV;)this[e]-=this.DV,++e>=this.t&&(this[this.t++]=0),++this[e]}},pe.prototype.multiplyLowerTo=function(t,e,n){var r,i=Math.min(this.t+t.t,e);for(n.s=0,n.t=i;i>0;)n[--i]=0;for(r=n.t-this.t;i<r;++i)n[i+this.t]=this.am(0,t[i],n,i,0,this.t);for(r=Math.min(t.t,e);i<r;++i)this.am(0,t[i],n,i,0,e-i);n.clamp()},pe.prototype.multiplyUpperTo=function(t,e,n){--e;var r=n.t=this.t+t.t-e;for(n.s=0;--r>=0;)n[r]=0;for(r=Math.max(e-this.t,0);r<t.t;++r)n[this.t+r-e]=this.am(e-r,t[r],n,0,0,this.t+r-e);n.clamp(),n.drShiftTo(1,n)},pe.prototype.modInt=function(t){if(t<=0)return 0;var e=this.DV%t,n=this.s<0?t-1:0;if(this.t>0)if(0==e)n=this[0]%t;else for(var r=this.t-1;r>=0;--r)n=(e*n+this[r])%t;return n},pe.prototype.millerRabin=function(t){var e=this.subtract(pe.ONE),n=e.getLowestSetBit();if(n<=0)return!1;var r=e.shiftRight(n);(t=t+1>>1)>ke.length&&(t=ke.length);for(var i=ge(),s=0;s<t;++s){i.fromInt(ke[Math.floor(Math.random()*ke.length)]);var o=i.modPow(r,this);if(0!=o.compareTo(pe.ONE)&&0!=o.compareTo(e)){for(var a=1;a++<n&&0!=o.compareTo(e);)if(0==(o=o.modPowInt(2,this)).compareTo(pe.ONE))return!1;if(0!=o.compareTo(e))return!1}}return!0},pe.prototype.clone=function(){var t=ge();return this.copyTo(t),t},pe.prototype.intValue=function(){if(this.s<0){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]},pe.prototype.byteValue=function(){return 0==this.t?this.s:this[0]<<24>>24},pe.prototype.shortValue=function(){return 0==this.t?this.s:this[0]<<16>>16},pe.prototype.signum=function(){return this.s<0?-1:this.t<=0||1==this.t&&this[0]<=0?0:1},pe.prototype.toByteArray=function(){var t=this.t,e=new Array;e[0]=this.s;var n,r=this.DB-t*this.DB%8,i=0;if(t-- >0)for(r<this.DB&&(n=this[t]>>r)!=(this.s&this.DM)>>r&&(e[i++]=n|this.s<<this.DB-r);t>=0;)r<8?(n=(this[t]&(1<<r)-1)<<8-r,n|=this[--t]>>(r+=this.DB-8)):(n=this[t]>>(r-=8)&255,r<=0&&(r+=this.DB,--t)),0!=(128&n)&&(n|=-256),0==i&&(128&this.s)!=(128&n)&&++i,(i>0||n!=this.s)&&(e[i++]=n);return e},pe.prototype.equals=function(t){return 0==this.compareTo(t)},pe.prototype.min=function(t){return this.compareTo(t)<0?this:t},pe.prototype.max=function(t){return this.compareTo(t)>0?this:t},pe.prototype.and=function(t){var e=ge();return this.bitwiseTo(t,Ce,e),e},pe.prototype.or=function(t){var e=ge();return this.bitwiseTo(t,Te,e),e},pe.prototype.xor=function(t){var e=ge();return this.bitwiseTo(t,Pe,e),e},pe.prototype.andNot=function(t){var e=ge();return this.bitwiseTo(t,De,e),e},pe.prototype.not=function(){for(var t=ge(),e=0;e<this.t;++e)t[e]=this.DM&~this[e];return t.t=this.t,t.s=~this.s,t},pe.prototype.shiftLeft=function(t){var e=ge();return t<0?this.rShiftTo(-t,e):this.lShiftTo(t,e),e},pe.prototype.shiftRight=function(t){var e=ge();return t<0?this.lShiftTo(-t,e):this.rShiftTo(t,e),e},pe.prototype.getLowestSetBit=function(){for(var t=0;t<this.t;++t)if(0!=this[t])return t*this.DB+Ie(this[t]);return this.s<0?this.t*this.DB:-1},pe.prototype.bitCount=function(){for(var t=0,e=this.s&this.DM,n=0;n<this.t;++n)t+=Re(this[n]^e);return t},pe.prototype.testBit=function(t){var e=Math.floor(t/this.DB);return e>=this.t?0!=this.s:0!=(this[e]&1<<t%this.DB)},pe.prototype.setBit=function(t){return this.changeBit(t,Te)},pe.prototype.clearBit=function(t){return this.changeBit(t,De)},pe.prototype.flipBit=function(t){return this.changeBit(t,Pe)},pe.prototype.add=function(t){var e=ge();return this.addTo(t,e),e},pe.prototype.subtract=function(t){var e=ge();return this.subTo(t,e),e},pe.prototype.multiply=function(t){var e=ge();return this.multiplyTo(t,e),e},pe.prototype.divide=function(t){var e=ge();return this.divRemTo(t,e,null),e},pe.prototype.remainder=function(t){var e=ge();return this.divRemTo(t,null,e),e},pe.prototype.divideAndRemainder=function(t){var e=ge(),n=ge();return this.divRemTo(t,e,n),new Array(e,n)},pe.prototype.modPow=function(t,e){var n,r,i=t.bitLength(),s=xe(1);if(i<=0)return s;n=i<18?1:i<48?3:i<144?4:i<768?5:6,r=i<8?new Fe(e):e.isEven()?new _e(e):new Ae(e);var o=new Array,a=3,h=n-1,u=(1<<n)-1;if(o[1]=r.convert(this),n>1){var c=ge();for(r.sqrTo(o[1],c);a<=u;)o[a]=ge(),r.mulTo(c,o[a-2],o[a]),a+=2}var f,l,d=t.t-1,p=!0,g=ge();for(i=Ee(t[d])-1;d>=0;){for(i>=h?f=t[d]>>i-h&u:(f=(t[d]&(1<<i+1)-1)<<h-i,d>0&&(f|=t[d-1]>>this.DB+i-h)),a=n;0==(1&f);)f>>=1,--a;if((i-=a)<0&&(i+=this.DB,--d),p)o[f].copyTo(s),p=!1;else{for(;a>1;)r.sqrTo(s,g),r.sqrTo(g,s),a-=2;a>0?r.sqrTo(s,g):(l=s,s=g,g=l),r.mulTo(g,o[f],s)}for(;d>=0&&0==(t[d]&1<<i);)r.sqrTo(s,g),l=s,s=g,g=l,--i<0&&(i=this.DB-1,--d)}return r.revert(s)},pe.prototype.modInverse=function(t){var e=t.isEven();if(this.isEven()&&e||0==t.signum())return pe.ZERO;for(var n=t.clone(),r=this.clone(),i=xe(1),s=xe(0),o=xe(0),a=xe(1);0!=n.signum();){for(;n.isEven();)n.rShiftTo(1,n),e?(i.isEven()&&s.isEven()||(i.addTo(this,i),s.subTo(t,s)),i.rShiftTo(1,i)):s.isEven()||s.subTo(t,s),s.rShiftTo(1,s);for(;r.isEven();)r.rShiftTo(1,r),e?(o.isEven()&&a.isEven()||(o.addTo(this,o),a.subTo(t,a)),o.rShiftTo(1,o)):a.isEven()||a.subTo(t,a),a.rShiftTo(1,a);n.compareTo(r)>=0?(n.subTo(r,n),e&&i.subTo(o,i),s.subTo(a,s)):(r.subTo(n,r),e&&o.subTo(i,o),a.subTo(s,a))}return 0!=r.compareTo(pe.ONE)?pe.ZERO:a.compareTo(t)>=0?a.subtract(t):a.signum()<0?(a.addTo(t,a),a.signum()<0?a.add(t):a):a},pe.prototype.pow=function(t){return this.exp(t,new Be)},pe.prototype.gcd=function(t){var e=this.s<0?this.negate():this.clone(),n=t.s<0?t.negate():t.clone();if(e.compareTo(n)<0){var r=e;e=n,n=r}var i=e.getLowestSetBit(),s=n.getLowestSetBit();if(s<0)return e;for(i<s&&(s=i),s>0&&(e.rShiftTo(s,e),n.rShiftTo(s,n));e.signum()>0;)(i=e.getLowestSetBit())>0&&e.rShiftTo(i,e),(i=n.getLowestSetBit())>0&&n.rShiftTo(i,n),e.compareTo(n)>=0?(e.subTo(n,e),e.rShiftTo(1,e)):(n.subTo(e,n),n.rShiftTo(1,n));return s>0&&n.lShiftTo(s,n),n},pe.prototype.isProbablePrime=function(t){var e,n=this.abs();if(1==n.t&&n[0]<=ke[ke.length-1]){for(e=0;e<ke.length;++e)if(n[0]==ke[e])return!0;return!1}if(n.isEven())return!1;for(e=1;e<ke.length;){for(var r=ke[e],i=e+1;i<ke.length&&r<Ne;)r*=ke[i++];for(r=n.modInt(r);e<i;)if(r%ke[e++]==0)return!1}return n.millerRabin(t)},pe.prototype.square=function(){var t=ge();return this.squareTo(t),t},Oe.prototype.init=function(t){var e,n,r;for(e=0;e<256;++e)this.S[e]=e;for(n=0,e=0;e<256;++e)n=n+this.S[e]+t[e%t.length]&255,r=this.S[e],this.S[e]=this.S[n],this.S[n]=r;this.i=0,this.j=0},Oe.prototype.next=function(){var t;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,t=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=t,this.S[t+this.S[this.i]&255]};var je,Le,Me,Ve=256;function Ke(){var t;t=(new Date).getTime(),Le[Me++]^=255&t,Le[Me++]^=t>>8&255,Le[Me++]^=t>>16&255,Le[Me++]^=t>>24&255,Me>=Ve&&(Me-=Ve)}if(null==Le){var Ue;if(Le=new Array,Me=0,void 0!==re&&void 0!==re.msCrypto)re.msCrypto.getRandomValues;for(;Me<Ve;)Ue=Math.floor(65536*Math.random()),Le[Me++]=Ue>>>8,Le[Me++]=255&Ue;Me=0,Ke()}function qe(){if(null==je){for(Ke(),(je=new Oe).init(Le),Me=0;Me<Le.length;++Me)Le[Me]=0;Me=0}return je.next()}function ze(){}function Ye(t,e){return new pe(t,e)}function We(t,e,n){for(var r="",i=0;r.length<e;)r+=n(String.fromCharCode.apply(String,t.concat([(4278190080&i)>>24,(16711680&i)>>16,(65280&i)>>8,255&i]))),i+=1;return r}function Ge(){this.n=null,this.e=0,this.d=null,this.p=null,this.q=null,this.dmp1=null,this.dmq1=null,this.coeff=null}function Je(t,e,n){for(var r="",i=0;r.length<e;)r+=n(t+String.fromCharCode.apply(String,[(4278190080&i)>>24,(16711680&i)>>16,(65280&i)>>8,255&i])),i+=1;return r}function Xe(t,e){this.x=e,this.q=t}function $e(t,e,n,r){this.curve=t,this.x=e,this.y=n,this.z=null==r?pe.ONE:r,this.zinv=null}function Ze(t,e,n){this.q=t,this.a=this.fromBigInteger(e),this.b=this.fromBigInteger(n),this.infinity=new $e(this,null,null)}ze.prototype.nextBytes=function(t){var e;for(e=0;e<t.length;++e)t[e]=qe()},Ge.prototype.doPublic=function(t){return t.modPowInt(this.e,this.n)},Ge.prototype.setPublic=function(t,e){if(this.isPublic=!0,this.isPrivate=!1,"string"!=typeof t)this.n=t,this.e=e;else{if(!(null!=t&&null!=e&&t.length>0&&e.length>0))throw"Invalid RSA public key";this.n=Ye(t,16),this.e=parseInt(e,16)}},Ge.prototype.encrypt=function(t){var e=function(t,e){if(e<t.length+11)throw"Message too long for RSA";for(var n=new Array,r=t.length-1;r>=0&&e>0;){var i=t.charCodeAt(r--);i<128?n[--e]=i:i>127&&i<2048?(n[--e]=63&i|128,n[--e]=i>>6|192):(n[--e]=63&i|128,n[--e]=i>>6&63|128,n[--e]=i>>12|224)}n[--e]=0;for(var s=new ze,o=new Array;e>2;){for(o[0]=0;0==o[0];)s.nextBytes(o);n[--e]=o[0]}return n[--e]=2,n[--e]=0,new pe(n)}(t,this.n.bitLength()+7>>3);if(null==e)return null;var n=this.doPublic(e);if(null==n)return null;var r=n.toString(16);return 0==(1&r.length)?r:"0"+r},Ge.prototype.encryptOAEP=function(t,e,n){var r=function(t,e,n,r){var i=tn.crypto.MessageDigest,s=tn.crypto.Util,o=null;if(n||(n="sha1"),"string"==typeof n&&(o=i.getCanonicalAlgName(n),r=i.getHashLength(o),n=function(t){return dn(s.hashHex(pn(t),o))}),t.length+2*r+2>e)throw"Message too long for RSA";var a,h="";for(a=0;a<e-t.length-2*r-2;a+=1)h+="\0";var u=n("")+h+""+t,c=new Array(r);(new ze).nextBytes(c);var f=We(c,u.length,n),l=[];for(a=0;a<u.length;a+=1)l[a]=u.charCodeAt(a)^f.charCodeAt(a);var d=We(l,c.length,n),p=[0];for(a=0;a<c.length;a+=1)p[a+1]=c[a]^d.charCodeAt(a);return new pe(p.concat(l))}(t,this.n.bitLength()+7>>3,e,n);if(null==r)return null;var i=this.doPublic(r);if(null==i)return null;var s=i.toString(16);return 0==(1&s.length)?s:"0"+s},Ge.prototype.type="RSA",Ge.prototype.doPrivate=function(t){if(null==this.p||null==this.q)return t.modPow(this.d,this.n);for(var e=t.mod(this.p).modPow(this.dmp1,this.p),n=t.mod(this.q).modPow(this.dmq1,this.q);e.compareTo(n)<0;)e=e.add(this.p);return e.subtract(n).multiply(this.coeff).mod(this.p).multiply(this.q).add(n)},Ge.prototype.setPrivate=function(t,e,n){if(this.isPrivate=!0,"string"!=typeof t)this.n=t,this.e=e,this.d=n;else{if(!(null!=t&&null!=e&&t.length>0&&e.length>0))throw"Invalid RSA private key";this.n=Ye(t,16),this.e=parseInt(e,16),this.d=Ye(n,16)}},Ge.prototype.setPrivateEx=function(t,e,n,r,i,s,o,a){if(this.isPrivate=!0,this.isPublic=!1,null==t)throw"RSASetPrivateEx N == null";if(null==e)throw"RSASetPrivateEx E == null";if(0==t.length)throw"RSASetPrivateEx N.length == 0";if(0==e.length)throw"RSASetPrivateEx E.length == 0";if(!(null!=t&&null!=e&&t.length>0&&e.length>0))throw"Invalid RSA private key in RSASetPrivateEx";this.n=Ye(t,16),this.e=parseInt(e,16),this.d=Ye(n,16),this.p=Ye(r,16),this.q=Ye(i,16),this.dmp1=Ye(s,16),this.dmq1=Ye(o,16),this.coeff=Ye(a,16)},Ge.prototype.generate=function(t,e){var n=new ze,r=t>>1;this.e=parseInt(e,16);for(var i=new pe(e,16);;){for(;this.p=new pe(t-r,1,n),0!=this.p.subtract(pe.ONE).gcd(i).compareTo(pe.ONE)||!this.p.isProbablePrime(10););for(;this.q=new pe(r,1,n),0!=this.q.subtract(pe.ONE).gcd(i).compareTo(pe.ONE)||!this.q.isProbablePrime(10););if(this.p.compareTo(this.q)<=0){var s=this.p;this.p=this.q,this.q=s}var o=this.p.subtract(pe.ONE),a=this.q.subtract(pe.ONE),h=o.multiply(a);if(0==h.gcd(i).compareTo(pe.ONE)){this.n=this.p.multiply(this.q),this.d=i.modInverse(h),this.dmp1=this.d.mod(o),this.dmq1=this.d.mod(a),this.coeff=this.q.modInverse(this.p);break}}this.isPrivate=!0},Ge.prototype.decrypt=function(t){var e=Ye(t,16),n=this.doPrivate(e);return null==n?null:function(t,e){for(var n=t.toByteArray(),r=0;r<n.length&&0==n[r];)++r;if(n.length-r!=e-1||2!=n[r])return null;for(++r;0!=n[r];)if(++r>=n.length)return null;for(var i="";++r<n.length;){var s=255&n[r];s<128?i+=String.fromCharCode(s):s>191&&s<224?(i+=String.fromCharCode((31&s)<<6|63&n[r+1]),++r):(i+=String.fromCharCode((15&s)<<12|(63&n[r+1])<<6|63&n[r+2]),r+=2)}return i}(n,this.n.bitLength()+7>>3)},Ge.prototype.decryptOAEP=function(t,e,n){var r=Ye(t,16),i=this.doPrivate(r);return null==i?null:function(t,e,n,r){var i=tn.crypto.MessageDigest,s=tn.crypto.Util,o=null;for(n||(n="sha1"),"string"==typeof n&&(o=i.getCanonicalAlgName(n),r=i.getHashLength(o),n=function(t){return dn(s.hashHex(pn(t),o))}),t=t.toByteArray(),a=0;a<t.length;a+=1)t[a]&=255;for(;t.length<e;)t.unshift(0);if((t=String.fromCharCode.apply(String,t)).length<2*r+2)throw"Cipher too short";var a,h=t.substr(1,r),u=t.substr(r+1),c=Je(u,r,n),f=[];for(a=0;a<h.length;a+=1)f[a]=h.charCodeAt(a)^c.charCodeAt(a);var l=Je(String.fromCharCode.apply(String,f),t.length-r,n),d=[];for(a=0;a<u.length;a+=1)d[a]=u.charCodeAt(a)^l.charCodeAt(a);if((d=String.fromCharCode.apply(String,d)).substr(0,r)!==n(""))throw"Hash mismatch";var p=(d=d.substr(r)).indexOf("");if((-1!=p?d.substr(0,p).lastIndexOf("\0"):-1)+1!=p)throw"Malformed data";return d.substr(p+1)}(i,this.n.bitLength()+7>>3,e,n)},Xe.prototype.equals=function(t){return t==this||this.q.equals(t.q)&&this.x.equals(t.x)},Xe.prototype.toBigInteger=function(){return this.x},Xe.prototype.negate=function(){return new Xe(this.q,this.x.negate().mod(this.q))},Xe.prototype.add=function(t){return new Xe(this.q,this.x.add(t.toBigInteger()).mod(this.q))},Xe.prototype.subtract=function(t){return new Xe(this.q,this.x.subtract(t.toBigInteger()).mod(this.q))},Xe.prototype.multiply=function(t){return new Xe(this.q,this.x.multiply(t.toBigInteger()).mod(this.q))},Xe.prototype.square=function(){return new Xe(this.q,this.x.square().mod(this.q))},Xe.prototype.divide=function(t){return new Xe(this.q,this.x.multiply(t.toBigInteger().modInverse(this.q)).mod(this.q))},$e.prototype.getX=function(){return null==this.zinv&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.x.toBigInteger().multiply(this.zinv).mod(this.curve.q))},$e.prototype.getY=function(){return null==this.zinv&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.y.toBigInteger().multiply(this.zinv).mod(this.curve.q))},$e.prototype.equals=function(t){return t==this||(this.isInfinity()?t.isInfinity():t.isInfinity()?this.isInfinity():!!t.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(t.z)).mod(this.curve.q).equals(pe.ZERO)&&t.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(t.z)).mod(this.curve.q).equals(pe.ZERO))},$e.prototype.isInfinity=function(){return null==this.x&&null==this.y||this.z.equals(pe.ZERO)&&!this.y.toBigInteger().equals(pe.ZERO)},$e.prototype.negate=function(){return new $e(this.curve,this.x,this.y.negate(),this.z)},$e.prototype.add=function(t){if(this.isInfinity())return t;if(t.isInfinity())return this;var e=t.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(t.z)).mod(this.curve.q),n=t.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(t.z)).mod(this.curve.q);if(pe.ZERO.equals(n))return pe.ZERO.equals(e)?this.twice():this.curve.getInfinity();var r=new pe("3"),i=this.x.toBigInteger(),s=this.y.toBigInteger(),o=(t.x.toBigInteger(),t.y.toBigInteger(),n.square()),a=o.multiply(n),h=i.multiply(o),u=e.square().multiply(this.z),c=u.subtract(h.shiftLeft(1)).multiply(t.z).subtract(a).multiply(n).mod(this.curve.q),f=h.multiply(r).multiply(e).subtract(s.multiply(a)).subtract(u.multiply(e)).multiply(t.z).add(e.multiply(a)).mod(this.curve.q),l=a.multiply(this.z).multiply(t.z).mod(this.curve.q);return new $e(this.curve,this.curve.fromBigInteger(c),this.curve.fromBigInteger(f),l)},$e.prototype.twice=function(){if(this.isInfinity())return this;if(0==this.y.toBigInteger().signum())return this.curve.getInfinity();var t=new pe("3"),e=this.x.toBigInteger(),n=this.y.toBigInteger(),r=n.multiply(this.z),i=r.multiply(n).mod(this.curve.q),s=this.curve.a.toBigInteger(),o=e.square().multiply(t);pe.ZERO.equals(s)||(o=o.add(this.z.square().multiply(s)));var a=(o=o.mod(this.curve.q)).square().subtract(e.shiftLeft(3).multiply(i)).shiftLeft(1).multiply(r).mod(this.curve.q),h=o.multiply(t).multiply(e).subtract(i.shiftLeft(1)).shiftLeft(2).multiply(i).subtract(o.square().multiply(o)).mod(this.curve.q),u=r.square().multiply(r).shiftLeft(3).mod(this.curve.q);return new $e(this.curve,this.curve.fromBigInteger(a),this.curve.fromBigInteger(h),u)},$e.prototype.multiply=function(t){if(this.isInfinity())return this;if(0==t.signum())return this.curve.getInfinity();var e,n=t,r=n.multiply(new pe("3")),i=this.negate(),s=this;for(e=r.bitLength()-2;e>0;--e){s=s.twice();var o=r.testBit(e);o!=n.testBit(e)&&(s=s.add(o?this:i))}return s},$e.prototype.multiplyTwo=function(t,e,n){var r;r=t.bitLength()>n.bitLength()?t.bitLength()-1:n.bitLength()-1;for(var i=this.curve.getInfinity(),s=this.add(e);r>=0;)i=i.twice(),t.testBit(r)?i=n.testBit(r)?i.add(s):i.add(this):n.testBit(r)&&(i=i.add(e)),--r;return i},Ze.prototype.getQ=function(){return this.q},Ze.prototype.getA=function(){return this.a},Ze.prototype.getB=function(){return this.b},Ze.prototype.equals=function(t){return t==this||this.q.equals(t.q)&&this.a.equals(t.a)&&this.b.equals(t.b)},Ze.prototype.getInfinity=function(){return this.infinity},Ze.prototype.fromBigInteger=function(t){return new Xe(this.q,t)},Ze.prototype.decodePointHex=function(t){switch(parseInt(t.substr(0,2),16)){case 0:return this.infinity;case 2:case 3:return null;case 4:case 6:case 7:var e=(t.length-2)/2,n=t.substr(2,e),r=t.substr(e+2,e);return new $e(this,this.fromBigInteger(new pe(n,16)),this.fromBigInteger(new pe(r,16)));default:return null}},Xe.prototype.getByteLength=function(){return Math.floor((this.toBigInteger().bitLength()+7)/8)},$e.prototype.getEncoded=function(t){var e=function(t,e){var n=t.toByteArrayUnsigned();if(e<n.length)n=n.slice(n.length-e);else for(;e>n.length;)n.unshift(0);return n},n=this.getX().toBigInteger(),r=this.getY().toBigInteger(),i=e(n,32);return t?r.isEven()?i.unshift(2):i.unshift(3):(i.unshift(4),i=i.concat(e(r,32))),i},$e.decodeFrom=function(t,e){e[0];var n=e.length-1,r=e.slice(1,1+n/2),i=e.slice(1+n/2,1+n);r.unshift(0),i.unshift(0);var s=new pe(r),o=new pe(i);return new $e(t,t.fromBigInteger(s),t.fromBigInteger(o))},$e.decodeFromHex=function(t,e){e.substr(0,2);var n=e.length-2,r=e.substr(2,n/2),i=e.substr(2+n/2,n/2),s=new pe(r,16),o=new pe(i,16);return new $e(t,t.fromBigInteger(s),t.fromBigInteger(o))},$e.prototype.add2D=function(t){if(this.isInfinity())return t;if(t.isInfinity())return this;if(this.x.equals(t.x))return this.y.equals(t.y)?this.twice():this.curve.getInfinity();var e=t.x.subtract(this.x),n=t.y.subtract(this.y).divide(e),r=n.square().subtract(this.x).subtract(t.x),i=n.multiply(this.x.subtract(r)).subtract(this.y);return new $e(this.curve,r,i)},$e.prototype.twice2D=function(){if(this.isInfinity())return this;if(0==this.y.toBigInteger().signum())return this.curve.getInfinity();var t=this.curve.fromBigInteger(pe.valueOf(2)),e=this.curve.fromBigInteger(pe.valueOf(3)),n=this.x.square().multiply(e).add(this.curve.a).divide(this.y.multiply(t)),r=n.square().subtract(this.x.multiply(t)),i=n.multiply(this.x.subtract(r)).subtract(this.y);return new $e(this.curve,r,i)},$e.prototype.multiply2D=function(t){if(this.isInfinity())return this;if(0==t.signum())return this.curve.getInfinity();var e,n=t,r=n.multiply(new pe("3")),i=this.negate(),s=this;for(e=r.bitLength()-2;e>0;--e){s=s.twice();var o=r.testBit(e);o!=n.testBit(e)&&(s=s.add2D(o?this:i))}return s},$e.prototype.isOnCurve=function(){var t=this.getX().toBigInteger(),e=this.getY().toBigInteger(),n=this.curve.getA().toBigInteger(),r=this.curve.getB().toBigInteger(),i=this.curve.getQ(),s=e.multiply(e).mod(i),o=t.multiply(t).multiply(t).add(n.multiply(t)).add(r).mod(i);return s.equals(o)},$e.prototype.toString=function(){return"("+this.getX().toBigInteger().toString()+","+this.getY().toBigInteger().toString()+")"},$e.prototype.validate=function(){var t=this.curve.getQ();if(this.isInfinity())throw new Error("Point is at infinity.");var e=this.getX().toBigInteger(),n=this.getY().toBigInteger();if(e.compareTo(pe.ONE)<0||e.compareTo(t.subtract(pe.ONE))>0)throw new Error("x coordinate out of bounds");if(n.compareTo(pe.ONE)<0||n.compareTo(t.subtract(pe.ONE))>0)throw new Error("y coordinate out of bounds");if(!this.isOnCurve())throw new Error("Point is not on the curve.");if(this.multiply(t).isInfinity())throw new Error("Point is not a scalar multiple of G.");return!0};var Qe=function(){var t=new RegExp('(?:false|true|null|[\\{\\}\\[\\]]|(?:-?\\b(?:0|[1-9][0-9]*)(?:\\.[0-9]+)?(?:[eE][+-]?[0-9]+)?\\b)|(?:"(?:[^\\0-\\x08\\x0a-\\x1f"\\\\]|\\\\(?:["/\\\\bfnrt]|u[0-9A-Fa-f]{4}))*"))',"g"),e=new RegExp("\\\\(?:([^u])|u(.{4}))","g"),n={'"':'"',"/":"/","\\":"\\",b:"\b",f:"\f",n:"\n",r:"\r",t:"\t"};function r(t,e,r){return e?n[e]:String.fromCharCode(parseInt(r,16))}var i=new String(""),s=Object.hasOwnProperty;return function(n,o){var a,h,u=n.match(t),c=u[0],f=!1;"{"===c?a={}:"["===c?a=[]:(a=[],f=!0);for(var l=[a],d=1-f,p=u.length;d<p;++d){var g;switch((c=u[d]).charCodeAt(0)){default:(g=l[0])[h||g.length]=+c,h=void 0;break;case 34:if(-1!==(c=c.substring(1,c.length-1)).indexOf("\\")&&(c=c.replace(e,r)),g=l[0],!h){if(!(g instanceof Array)){h=c||i;break}h=g.length}g[h]=c,h=void 0;break;case 91:g=l[0],l.unshift(g[h||g.length]=[]),h=void 0;break;case 93:l.shift();break;case 102:(g=l[0])[h||g.length]=!1,h=void 0;break;case 110:(g=l[0])[h||g.length]=null,h=void 0;break;case 116:(g=l[0])[h||g.length]=!0,h=void 0;break;case 123:g=l[0],l.unshift(g[h||g.length]={}),h=void 0;break;case 125:l.shift()}}if(f){if(1!==l.length)throw new Error;a=a[0]}else if(l.length)throw new Error;if(o){var y=function(t,e){var n=t[e];if(n&&"object"==typeof n){var r=null;for(var i in n)if(s.call(n,i)&&n!==t){var a=y(n,i);void 0!==a?n[i]=a:(r||(r=[]),r.push(i))}if(r)for(var h=r.length;--h>=0;)delete n[r[h]]}return o.call(t,e,n)};a=y({"":a},"")}return a}}();void 0!==tn&&tn||(tn={}),void 0!==tn.asn1&&tn.asn1||(tn.asn1={}),tn.asn1.ASN1Util=new function(){this.integerToByteHex=function(t){var e=t.toString(16);return e.length%2==1&&(e="0"+e),e},this.bigIntToMinTwosComplementsHex=function(t){var e=t.toString(16);if("-"!=e.substr(0,1))e.length%2==1?e="0"+e:e.match(/^[0-7]/)||(e="00"+e);else{var n=e.substr(1).length;n%2==1?n+=1:e.match(/^[0-7]/)||(n+=2);for(var r="",i=0;i<n;i++)r+="f";e=new pe(r,16).xor(t).add(pe.ONE).toString(16).replace(/^-/,"")}return e},this.getPEMStringFromHex=function(t,e){return yn(t,e)},this.newObject=function(t){var e=tn.asn1,n=e.DERBoolean,r=e.DERInteger,i=e.DERBitString,s=e.DEROctetString,o=e.DERNull,a=e.DERObjectIdentifier,h=e.DEREnumerated,u=e.DERUTF8String,c=e.DERNumericString,f=e.DERPrintableString,l=e.DERTeletexString,d=e.DERIA5String,p=e.DERUTCTime,g=e.DERGeneralizedTime,y=e.DERSequence,v=e.DERSet,m=e.DERTaggedObject,w=e.ASN1Util.newObject,b=Object.keys(t);if(1!=b.length)throw"key of param shall be only one.";var S=b[0];if(-1==":bool:int:bitstr:octstr:null:oid:enum:utf8str:numstr:prnstr:telstr:ia5str:utctime:gentime:seq:set:tag:".indexOf(":"+S+":"))throw"undefined key: "+S;if("bool"==S)return new n(t[S]);if("int"==S)return new r(t[S]);if("bitstr"==S)return new i(t[S]);if("octstr"==S)return new s(t[S]);if("null"==S)return new o(t[S]);if("oid"==S)return new a(t[S]);if("enum"==S)return new h(t[S]);if("utf8str"==S)return new u(t[S]);if("numstr"==S)return new c(t[S]);if("prnstr"==S)return new f(t[S]);if("telstr"==S)return new l(t[S]);if("ia5str"==S)return new d(t[S]);if("utctime"==S)return new p(t[S]);if("gentime"==S)return new g(t[S]);if("seq"==S){for(var x=t[S],E=[],F=0;F<x.length;F++){var A=w(x[F]);E.push(A)}return new y({array:E})}if("set"==S){for(x=t[S],E=[],F=0;F<x.length;F++){A=w(x[F]);E.push(A)}return new v({array:E})}if("tag"==S){var C=t[S];if("[object Array]"===Object.prototype.toString.call(C)&&3==C.length){var T=w(C[2]);return new m({tag:C[0],explicit:C[1],obj:T})}var P={};if(void 0!==C.explicit&&(P.explicit=C.explicit),void 0!==C.tag&&(P.tag=C.tag),void 0===C.obj)throw"obj shall be specified for 'tag'.";return P.obj=w(C.obj),new m(P)}},this.jsonToASN1HEX=function(t){return this.newObject(t).getEncodedHex()}},tn.asn1.ASN1Util.oidHexToInt=function(t){for(var e="",n=parseInt(t.substr(0,2),16),r=(e=Math.floor(n/40)+"."+n%40,""),i=2;i<t.length;i+=2){var s=("00000000"+parseInt(t.substr(i,2),16).toString(2)).slice(-8);if(r+=s.substr(1,7),"0"==s.substr(0,1))e=e+"."+new pe(r,2).toString(10),r=""}return e},tn.asn1.ASN1Util.oidIntToHex=function(t){var e=function(t){var e=t.toString(16);return 1==e.length&&(e="0"+e),e},n=function(t){var n="",r=new pe(t,10).toString(2),i=7-r.length%7;7==i&&(i=0);for(var s="",o=0;o<i;o++)s+="0";r=s+r;for(o=0;o<r.length-1;o+=7){var a=r.substr(o,7);o!=r.length-7&&(a="1"+a),n+=e(parseInt(a,2))}return n};if(!t.match(/^[0-9.]+$/))throw"malformed oid string: "+t;var r="",i=t.split("."),s=40*parseInt(i[0])+parseInt(i[1]);r+=e(s),i.splice(0,2);for(var o=0;o<i.length;o++)r+=n(i[o]);return r},tn.asn1.ASN1Object=function(){this.getLengthHexFromValue=function(){if(void 0===this.hV||null==this.hV)throw"this.hV is null or undefined.";if(this.hV.length%2==1)throw"value hex must be even length: n="+"".length+",v="+this.hV;var t=this.hV.length/2,e=t.toString(16);if(e.length%2==1&&(e="0"+e),t<128)return e;var n=e.length/2;if(n>15)throw"ASN.1 length too long to represent by 8x: n = "+t.toString(16);return(128+n).toString(16)+e},this.getEncodedHex=function(){return(null==this.hTLV||this.isModified)&&(this.hV=this.getFreshValueHex(),this.hL=this.getLengthHexFromValue(),this.hTLV=this.hT+this.hL+this.hV,this.isModified=!1),this.hTLV},this.getValueHex=function(){return this.getEncodedHex(),this.hV},this.getFreshValueHex=function(){return""}},tn.asn1.DERAbstractString=function(t){tn.asn1.DERAbstractString.superclass.constructor.call(this),this.getString=function(){return this.s},this.setString=function(t){this.hTLV=null,this.isModified=!0,this.s=t,this.hV=fn(this.s).toLowerCase()},this.setStringHex=function(t){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=t},this.getFreshValueHex=function(){return this.hV},void 0!==t&&("string"==typeof t?this.setString(t):void 0!==t.str?this.setString(t.str):void 0!==t.hex&&this.setStringHex(t.hex))},ie.lang.extend(tn.asn1.DERAbstractString,tn.asn1.ASN1Object),tn.asn1.DERAbstractTime=function(t){tn.asn1.DERAbstractTime.superclass.constructor.call(this),this.localDateToUTC=function(t){return utc=t.getTime()+6e4*t.getTimezoneOffset(),new Date(utc)},this.formatDate=function(t,e,n){var r=this.zeroPadding,i=this.localDateToUTC(t),s=String(i.getFullYear());"utc"==e&&(s=s.substr(2,2));var o=s+r(String(i.getMonth()+1),2)+r(String(i.getDate()),2)+r(String(i.getHours()),2)+r(String(i.getMinutes()),2)+r(String(i.getSeconds()),2);if(!0===n){var a=i.getMilliseconds();if(0!=a){var h=r(String(a),3);o=o+"."+(h=h.replace(/[0]+$/,""))}}return o+"Z"},this.zeroPadding=function(t,e){return t.length>=e?t:new Array(e-t.length+1).join("0")+t},this.getString=function(){return this.s},this.setString=function(t){this.hTLV=null,this.isModified=!0,this.s=t,this.hV=on(t)},this.setByDateValue=function(t,e,n,r,i,s){var o=new Date(Date.UTC(t,e-1,n,r,i,s,0));this.setByDate(o)},this.getFreshValueHex=function(){return this.hV}},ie.lang.extend(tn.asn1.DERAbstractTime,tn.asn1.ASN1Object),tn.asn1.DERAbstractStructured=function(t){tn.asn1.DERAbstractString.superclass.constructor.call(this),this.setByASN1ObjectArray=function(t){this.hTLV=null,this.isModified=!0,this.asn1Array=t},this.appendASN1Object=function(t){this.hTLV=null,this.isModified=!0,this.asn1Array.push(t)},this.asn1Array=new Array,void 0!==t&&void 0!==t.array&&(this.asn1Array=t.array)},ie.lang.extend(tn.asn1.DERAbstractStructured,tn.asn1.ASN1Object),tn.asn1.DERBoolean=function(){tn.asn1.DERBoolean.superclass.constructor.call(this),this.hT="01",this.hTLV="0101ff"},ie.lang.extend(tn.asn1.DERBoolean,tn.asn1.ASN1Object),tn.asn1.DERInteger=function(t){tn.asn1.DERInteger.superclass.constructor.call(this),this.hT="02",this.setByBigInteger=function(t){this.hTLV=null,this.isModified=!0,this.hV=tn.asn1.ASN1Util.bigIntToMinTwosComplementsHex(t)},this.setByInteger=function(t){var e=new pe(String(t),10);this.setByBigInteger(e)},this.setValueHex=function(t){this.hV=t},this.getFreshValueHex=function(){return this.hV},void 0!==t&&(void 0!==t.bigint?this.setByBigInteger(t.bigint):void 0!==t.int?this.setByInteger(t.int):"number"==typeof t?this.setByInteger(t):void 0!==t.hex&&this.setValueHex(t.hex))},ie.lang.extend(tn.asn1.DERInteger,tn.asn1.ASN1Object),tn.asn1.DERBitString=function(t){if(void 0!==t&&void 0!==t.obj){var e=tn.asn1.ASN1Util.newObject(t.obj);t.hex="00"+e.getEncodedHex()}tn.asn1.DERBitString.superclass.constructor.call(this),this.hT="03",this.setHexValueIncludingUnusedBits=function(t){this.hTLV=null,this.isModified=!0,this.hV=t},this.setUnusedBitsAndHexValue=function(t,e){if(t<0||7<t)throw"unused bits shall be from 0 to 7: u = "+t;var n="0"+t;this.hTLV=null,this.isModified=!0,this.hV=n+e},this.setByBinaryString=function(t){var e=8-(t=t.replace(/0+$/,"")).length%8;8==e&&(e=0);for(var n=0;n<=e;n++)t+="0";var r="";for(n=0;n<t.length-1;n+=8){var i=t.substr(n,8),s=parseInt(i,2).toString(16);1==s.length&&(s="0"+s),r+=s}this.hTLV=null,this.isModified=!0,this.hV="0"+e+r},this.setByBooleanArray=function(t){for(var e="",n=0;n<t.length;n++)1==t[n]?e+="1":e+="0";this.setByBinaryString(e)},this.newFalseArray=function(t){for(var e=new Array(t),n=0;n<t;n++)e[n]=!1;return e},this.getFreshValueHex=function(){return this.hV},void 0!==t&&("string"==typeof t&&t.toLowerCase().match(/^[0-9a-f]+$/)?this.setHexValueIncludingUnusedBits(t):void 0!==t.hex?this.setHexValueIncludingUnusedBits(t.hex):void 0!==t.bin?this.setByBinaryString(t.bin):void 0!==t.array&&this.setByBooleanArray(t.array))},ie.lang.extend(tn.asn1.DERBitString,tn.asn1.ASN1Object),tn.asn1.DEROctetString=function(t){if(void 0!==t&&void 0!==t.obj){var e=tn.asn1.ASN1Util.newObject(t.obj);t.hex=e.getEncodedHex()}tn.asn1.DEROctetString.superclass.constructor.call(this,t),this.hT="04"},ie.lang.extend(tn.asn1.DEROctetString,tn.asn1.DERAbstractString),tn.asn1.DERNull=function(){tn.asn1.DERNull.superclass.constructor.call(this),this.hT="05",this.hTLV="0500"},ie.lang.extend(tn.asn1.DERNull,tn.asn1.ASN1Object),tn.asn1.DERObjectIdentifier=function(t){var e=function(t){var e=t.toString(16);return 1==e.length&&(e="0"+e),e},n=function(t){var n="",r=new pe(t,10).toString(2),i=7-r.length%7;7==i&&(i=0);for(var s="",o=0;o<i;o++)s+="0";r=s+r;for(o=0;o<r.length-1;o+=7){var a=r.substr(o,7);o!=r.length-7&&(a="1"+a),n+=e(parseInt(a,2))}return n};tn.asn1.DERObjectIdentifier.superclass.constructor.call(this),this.hT="06",this.setValueHex=function(t){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=t},this.setValueOidString=function(t){if(!t.match(/^[0-9.]+$/))throw"malformed oid string: "+t;var r="",i=t.split("."),s=40*parseInt(i[0])+parseInt(i[1]);r+=e(s),i.splice(0,2);for(var o=0;o<i.length;o++)r+=n(i[o]);this.hTLV=null,this.isModified=!0,this.s=null,this.hV=r},this.setValueName=function(t){var e=tn.asn1.x509.OID.name2oid(t);if(""===e)throw"DERObjectIdentifier oidName undefined: "+t;this.setValueOidString(e)},this.getFreshValueHex=function(){return this.hV},void 0!==t&&("string"==typeof t?t.match(/^[0-2].[0-9.]+$/)?this.setValueOidString(t):this.setValueName(t):void 0!==t.oid?this.setValueOidString(t.oid):void 0!==t.hex?this.setValueHex(t.hex):void 0!==t.name&&this.setValueName(t.name))},ie.lang.extend(tn.asn1.DERObjectIdentifier,tn.asn1.ASN1Object),tn.asn1.DEREnumerated=function(t){tn.asn1.DEREnumerated.superclass.constructor.call(this),this.hT="0a",this.setByBigInteger=function(t){this.hTLV=null,this.isModified=!0,this.hV=tn.asn1.ASN1Util.bigIntToMinTwosComplementsHex(t)},this.setByInteger=function(t){var e=new pe(String(t),10);this.setByBigInteger(e)},this.setValueHex=function(t){this.hV=t},this.getFreshValueHex=function(){return this.hV},void 0!==t&&(void 0!==t.int?this.setByInteger(t.int):"number"==typeof t?this.setByInteger(t):void 0!==t.hex&&this.setValueHex(t.hex))},ie.lang.extend(tn.asn1.DEREnumerated,tn.asn1.ASN1Object),tn.asn1.DERUTF8String=function(t){tn.asn1.DERUTF8String.superclass.constructor.call(this,t),this.hT="0c"},ie.lang.extend(tn.asn1.DERUTF8String,tn.asn1.DERAbstractString),tn.asn1.DERNumericString=function(t){tn.asn1.DERNumericString.superclass.constructor.call(this,t),this.hT="12"},ie.lang.extend(tn.asn1.DERNumericString,tn.asn1.DERAbstractString),tn.asn1.DERPrintableString=function(t){tn.asn1.DERPrintableString.superclass.constructor.call(this,t),this.hT="13"},ie.lang.extend(tn.asn1.DERPrintableString,tn.asn1.DERAbstractString),tn.asn1.DERTeletexString=function(t){tn.asn1.DERTeletexString.superclass.constructor.call(this,t),this.hT="14"},ie.lang.extend(tn.asn1.DERTeletexString,tn.asn1.DERAbstractString),tn.asn1.DERIA5String=function(t){tn.asn1.DERIA5String.superclass.constructor.call(this,t),this.hT="16"},ie.lang.extend(tn.asn1.DERIA5String,tn.asn1.DERAbstractString),tn.asn1.DERUTCTime=function(t){tn.asn1.DERUTCTime.superclass.constructor.call(this,t),this.hT="17",this.setByDate=function(t){this.hTLV=null,this.isModified=!0,this.date=t,this.s=this.formatDate(this.date,"utc"),this.hV=on(this.s)},this.getFreshValueHex=function(){return void 0===this.date&&void 0===this.s&&(this.date=new Date,this.s=this.formatDate(this.date,"utc"),this.hV=on(this.s)),this.hV},void 0!==t&&(void 0!==t.str?this.setString(t.str):"string"==typeof t&&t.match(/^[0-9]{12}Z$/)?this.setString(t):void 0!==t.hex?this.setStringHex(t.hex):void 0!==t.date&&this.setByDate(t.date))},ie.lang.extend(tn.asn1.DERUTCTime,tn.asn1.DERAbstractTime),tn.asn1.DERGeneralizedTime=function(t){tn.asn1.DERGeneralizedTime.superclass.constructor.call(this,t),this.hT="18",this.withMillis=!1,this.setByDate=function(t){this.hTLV=null,this.isModified=!0,this.date=t,this.s=this.formatDate(this.date,"gen",this.withMillis),this.hV=on(this.s)},this.getFreshValueHex=function(){return void 0===this.date&&void 0===this.s&&(this.date=new Date,this.s=this.formatDate(this.date,"gen",this.withMillis),this.hV=on(this.s)),this.hV},void 0!==t&&(void 0!==t.str?this.setString(t.str):"string"==typeof t&&t.match(/^[0-9]{14}Z$/)?this.setString(t):void 0!==t.hex?this.setStringHex(t.hex):void 0!==t.date&&this.setByDate(t.date),!0===t.millis&&(this.withMillis=!0))},ie.lang.extend(tn.asn1.DERGeneralizedTime,tn.asn1.DERAbstractTime),tn.asn1.DERSequence=function(t){tn.asn1.DERSequence.superclass.constructor.call(this,t),this.hT="30",this.getFreshValueHex=function(){for(var t="",e=0;e<this.asn1Array.length;e++){t+=this.asn1Array[e].getEncodedHex()}return this.hV=t,this.hV}},ie.lang.extend(tn.asn1.DERSequence,tn.asn1.DERAbstractStructured),tn.asn1.DERSet=function(t){tn.asn1.DERSet.superclass.constructor.call(this,t),this.hT="31",this.sortFlag=!0,this.getFreshValueHex=function(){for(var t=new Array,e=0;e<this.asn1Array.length;e++){var n=this.asn1Array[e];t.push(n.getEncodedHex())}return 1==this.sortFlag&&t.sort(),this.hV=t.join(""),this.hV},void 0!==t&&void 0!==t.sortflag&&0==t.sortflag&&(this.sortFlag=!1)},ie.lang.extend(tn.asn1.DERSet,tn.asn1.DERAbstractStructured),tn.asn1.DERTaggedObject=function(t){tn.asn1.DERTaggedObject.superclass.constructor.call(this),this.hT="a0",this.hV="",this.isExplicit=!0,this.asn1Object=null,this.setASN1Object=function(t,e,n){this.hT=e,this.isExplicit=t,this.asn1Object=n,this.isExplicit?(this.hV=this.asn1Object.getEncodedHex(),this.hTLV=null,this.isModified=!0):(this.hV=null,this.hTLV=n.getEncodedHex(),this.hTLV=this.hTLV.replace(/^../,e),this.isModified=!1)},this.getFreshValueHex=function(){return this.hV},void 0!==t&&(void 0!==t.tag&&(this.hT=t.tag),void 0!==t.explicit&&(this.isExplicit=t.explicit),void 0!==t.obj&&(this.asn1Object=t.obj,this.setASN1Object(this.isExplicit,this.hT,this.asn1Object)))},ie.lang.extend(tn.asn1.DERTaggedObject,tn.asn1.ASN1Object);var tn,en,nn,rn=new function(){};function sn(t){for(var e="",n=0;n<t.length;n++){var r=t[n].toString(16);1==r.length&&(r="0"+r),e+=r}return e}function on(t){return sn(function(t){for(var e=new Array,n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(t))}function an(t){return t=(t=(t=t.replace(/\=/g,"")).replace(/\+/g,"-")).replace(/\//g,"_")}function hn(t){return t.length%4==2?t+="==":t.length%4==3&&(t+="="),t=(t=t.replace(/-/g,"+")).replace(/_/g,"/")}function un(t){return t.length%2==1&&(t="0"+t),an(le(t))}function cn(t){return de(hn(t))}function fn(t){return wn(xn(t))}function ln(t){return decodeURIComponent(bn(t))}function dn(t){for(var e="",n=0;n<t.length-1;n+=2)e+=String.fromCharCode(parseInt(t.substr(n,2),16));return e}function pn(t){for(var e="",n=0;n<t.length;n++)e+=("0"+t.charCodeAt(n).toString(16)).slice(-2);return e}function gn(t){var e=function(t){return le(t)}(t).replace(/(.{64})/g,"$1\r\n");return e=e.replace(/\r\n$/,"")}function yn(t,e){return"-----BEGIN "+e+"-----\r\n"+gn(t)+"\r\n-----END "+e+"-----\r\n"}function vn(t,e){if(-1==t.indexOf("-----BEGIN "))throw"can't find PEM header: "+e;return function(t){return de(t.replace(/[^0-9A-Za-z\/+=]*/g,""))}(t=void 0!==e?(t=t.replace("-----BEGIN "+e+"-----","")).replace("-----END "+e+"-----",""):(t=t.replace(/-----BEGIN [^-]+-----/,"")).replace(/-----END [^-]+-----/,""))}function mn(t){return~~(function(t){var e,n,r,i,s,o,a,h,u,c,f;if(f=t.match(/^(\d{2}|\d{4})(\d\d)(\d\d)(\d\d)(\d\d)(\d\d)(|\.\d+)Z$/))return h=f[1],e=parseInt(h),2===h.length&&(50<=e&&e<100?e=1900+e:0<=e&&e<50&&(e=2e3+e)),n=parseInt(f[2])-1,r=parseInt(f[3]),i=parseInt(f[4]),s=parseInt(f[5]),o=parseInt(f[6]),a=0,""!==(u=f[7])&&(c=(u.substr(1)+"00").substr(0,3),a=parseInt(c)),Date.UTC(e,n,r,i,s,o,a);throw"unsupported zulu format: "+t}(t)/1e3)}function wn(t){return t.replace(/%/g,"")}function bn(t){return t.replace(/(..)/g,"%$1")}function Sn(t){var e="malformed hex value";if(!t.match(/^([0-9A-Fa-f][0-9A-Fa-f]){1,}$/))throw e;if(8!=t.length)return 32==t.length?function(t){if(!t.match(/^[0-9A-Fa-f]{32}$/))throw"malformed IPv6 address octet";for(var e=(t=t.toLowerCase()).match(/.{1,4}/g),n=0;n<8;n++)e[n]=e[n].replace(/^0+/,""),""==e[n]&&(e[n]="0");var r=(t=":"+e.join(":")+":").match(/:(0:){2,}/g);if(null===r)return t.slice(1,-1);var i="";for(n=0;n<r.length;n++)r[n].length>i.length&&(i=r[n]);return(t=t.replace(i,"::")).slice(1,-1)}(t):t;try{return parseInt(t.substr(0,2),16)+"."+parseInt(t.substr(2,2),16)+"."+parseInt(t.substr(4,2),16)+"."+parseInt(t.substr(6,2),16)}catch(t){throw e}}function xn(t){for(var e=encodeURIComponent(t),n="",r=0;r<e.length;r++)"%"==e[r]?(n+=e.substr(r,3),r+=2):n=n+"%"+on(e[r]);return n}function En(t){return t.length%2==1?"0"+t:t.substr(0,1)>"7"?"00"+t:t}rn.getLblen=function(t,e){if("8"!=t.substr(e+2,1))return 1;var n=parseInt(t.substr(e+3,1));return 0==n?-1:0<n&&n<10?n+1:-2},rn.getL=function(t,e){var n=rn.getLblen(t,e);return n<1?"":t.substr(e+2,2*n)},rn.getVblen=function(t,e){var n;return""==(n=rn.getL(t,e))?-1:("8"===n.substr(0,1)?new pe(n.substr(2),16):new pe(n,16)).intValue()},rn.getVidx=function(t,e){var n=rn.getLblen(t,e);return n<0?n:e+2*(n+1)},rn.getV=function(t,e){var n=rn.getVidx(t,e),r=rn.getVblen(t,e);return t.substr(n,2*r)},rn.getTLV=function(t,e){return t.substr(e,2)+rn.getL(t,e)+rn.getV(t,e)},rn.getNextSiblingIdx=function(t,e){return rn.getVidx(t,e)+2*rn.getVblen(t,e)},rn.getChildIdx=function(t,e){var n=rn,r=new Array,i=n.getVidx(t,e);"03"==t.substr(e,2)?r.push(i+2):r.push(i);for(var s=n.getVblen(t,e),o=i,a=0;;){var h=n.getNextSiblingIdx(t,o);if(null==h||h-i>=2*s)break;if(a>=200)break;r.push(h),o=h,a++}return r},rn.getNthChildIdx=function(t,e,n){return rn.getChildIdx(t,e)[n]},rn.getIdxbyList=function(t,e,n,r){var i,s,o=rn;if(0==n.length){if(void 0!==r&&t.substr(e,2)!==r)throw"checking tag doesn't match: "+t.substr(e,2)+"!="+r;return e}return i=n.shift(),s=o.getChildIdx(t,e),o.getIdxbyList(t,s[i],n,r)},rn.getTLVbyList=function(t,e,n,r){var i=rn,s=i.getIdxbyList(t,e,n);if(void 0===s)throw"can't find nthList object";if(void 0!==r&&t.substr(s,2)!=r)throw"checking tag doesn't match: "+t.substr(s,2)+"!="+r;return i.getTLV(t,s)},rn.getVbyList=function(t,e,n,r,i){var s,o,a=rn;if(void 0===(s=a.getIdxbyList(t,e,n,r)))throw"can't find nthList object";return o=a.getV(t,s),!0===i&&(o=o.substr(2)),o},rn.hextooidstr=function(t){var e=function(t,e){return t.length>=e?t:new Array(e-t.length+1).join("0")+t},n=[],r=t.substr(0,2),i=parseInt(r,16);n[0]=new String(Math.floor(i/40)),n[1]=new String(i%40);for(var s=t.substr(2),o=[],a=0;a<s.length/2;a++)o.push(parseInt(s.substr(2*a,2),16));var h=[],u="";for(a=0;a<o.length;a++)128&o[a]?u+=e((127&o[a]).toString(2),7):(u+=e((127&o[a]).toString(2),7),h.push(new String(parseInt(u,2))),u="");var c=n.join(".");return h.length>0&&(c=c+"."+h.join(".")),c},rn.dump=function(t,e,n,r){var i=rn,s=i.getV,o=i.dump,a=i.getChildIdx,h=t;t instanceof tn.asn1.ASN1Object&&(h=t.getEncodedHex());var u=function(t,e){return t.length<=2*e?t:t.substr(0,e)+"..(total "+t.length/2+"bytes).."+t.substr(t.length-e,e)};void 0===e&&(e={ommit_long_octet:32}),void 0===n&&(n=0),void 0===r&&(r="");var c=e.ommit_long_octet;if("01"==h.substr(n,2))return"00"==(f=s(h,n))?r+"BOOLEAN FALSE\n":r+"BOOLEAN TRUE\n";if("02"==h.substr(n,2))return r+"INTEGER "+u(f=s(h,n),c)+"\n";if("03"==h.substr(n,2))return r+"BITSTRING "+u(f=s(h,n),c)+"\n";if("04"==h.substr(n,2)){var f=s(h,n);if(i.isASN1HEX(f)){var l=r+"OCTETSTRING, encapsulates\n";return l+=o(f,e,0,r+"  ")}return r+"OCTETSTRING "+u(f,c)+"\n"}if("05"==h.substr(n,2))return r+"NULL\n";if("06"==h.substr(n,2)){var d=s(h,n),p=tn.asn1.ASN1Util.oidHexToInt(d),g=tn.asn1.x509.OID.oid2name(p),y=p.replace(/\./g," ");return""!=g?r+"ObjectIdentifier "+g+" ("+y+")\n":r+"ObjectIdentifier ("+y+")\n"}if("0c"==h.substr(n,2))return r+"UTF8String '"+ln(s(h,n))+"'\n";if("13"==h.substr(n,2))return r+"PrintableString '"+ln(s(h,n))+"'\n";if("14"==h.substr(n,2))return r+"TeletexString '"+ln(s(h,n))+"'\n";if("16"==h.substr(n,2))return r+"IA5String '"+ln(s(h,n))+"'\n";if("17"==h.substr(n,2))return r+"UTCTime "+ln(s(h,n))+"\n";if("18"==h.substr(n,2))return r+"GeneralizedTime "+ln(s(h,n))+"\n";if("30"==h.substr(n,2)){if("3000"==h.substr(n,4))return r+"SEQUENCE {}\n";l=r+"SEQUENCE\n";var v=e;if((2==(b=a(h,n)).length||3==b.length)&&"06"==h.substr(b[0],2)&&"04"==h.substr(b[b.length-1],2)){g=i.oidname(s(h,b[0]));var m=JSON.parse(JSON.stringify(e));m.x509ExtName=g,v=m}for(var w=0;w<b.length;w++)l+=o(h,v,b[w],r+"  ");return l}if("31"==h.substr(n,2)){l=r+"SET\n";var b=a(h,n);for(w=0;w<b.length;w++)l+=o(h,e,b[w],r+"  ");return l}var S=parseInt(h.substr(n,2),16);if(0!=(128&S)){var x=31&S;if(0!=(32&S)){var l=r+"["+x+"]\n";for(b=a(h,n),w=0;w<b.length;w++)l+=o(h,e,b[w],r+"  ");return l}return"68747470"==(f=s(h,n)).substr(0,8)&&(f=ln(f)),"subjectAltName"===e.x509ExtName&&2==x&&(f=ln(f)),l=r+"["+x+"] "+f+"\n"}return r+"UNKNOWN("+h.substr(n,2)+") "+s(h,n)+"\n"},rn.isASN1HEX=function(t){var e=rn;if(t.length%2==1)return!1;var n=e.getVblen(t,0),r=t.substr(0,2),i=e.getL(t,0);return t.length-r.length-i.length==2*n},rn.oidname=function(t){var e=tn.asn1;tn.lang.String.isHex(t)&&(t=e.ASN1Util.oidHexToInt(t));var n=e.x509.OID.oid2name(t);return""===n&&(n=t),n},void 0!==tn&&tn||(tn={}),void 0!==tn.asn1&&tn.asn1||(tn.asn1={}),void 0!==tn.asn1.x509&&tn.asn1.x509||(tn.asn1.x509={}),tn.asn1.x509.Certificate=function(t){tn.asn1.x509.Certificate.superclass.constructor.call(this);var e=tn,n=(e.crypto,e.asn1),r=n.DERSequence,i=n.DERBitString;this.sign=function(){this.asn1SignatureAlg=this.asn1TBSCert.asn1SignatureAlg;var t=new tn.crypto.Signature({alg:this.asn1SignatureAlg.nameAlg});t.init(this.prvKey),t.updateHex(this.asn1TBSCert.getEncodedHex()),this.hexSig=t.sign(),this.asn1Sig=new i({hex:"00"+this.hexSig});var e=new r({array:[this.asn1TBSCert,this.asn1SignatureAlg,this.asn1Sig]});this.hTLV=e.getEncodedHex(),this.isModified=!1},this.setSignatureHex=function(t){this.asn1SignatureAlg=this.asn1TBSCert.asn1SignatureAlg,this.hexSig=t,this.asn1Sig=new i({hex:"00"+this.hexSig});var e=new r({array:[this.asn1TBSCert,this.asn1SignatureAlg,this.asn1Sig]});this.hTLV=e.getEncodedHex(),this.isModified=!1},this.getEncodedHex=function(){if(0==this.isModified&&null!=this.hTLV)return this.hTLV;throw"not signed yet"},this.getPEMString=function(){return"-----BEGIN CERTIFICATE-----\r\n"+gn(this.getEncodedHex())+"\r\n-----END CERTIFICATE-----\r\n"},void 0!==t&&(void 0!==t.tbscertobj&&(this.asn1TBSCert=t.tbscertobj),void 0!==t.prvkeyobj&&(this.prvKey=t.prvkeyobj))},ie.lang.extend(tn.asn1.x509.Certificate,tn.asn1.ASN1Object),tn.asn1.x509.TBSCertificate=function(t){tn.asn1.x509.TBSCertificate.superclass.constructor.call(this);var e=tn.asn1,n=e.DERSequence,r=e.DERInteger,i=e.DERTaggedObject,s=e.x509,o=s.Time,a=s.X500Name,h=s.SubjectPublicKeyInfo;this._initialize=function(){this.asn1Array=new Array,this.asn1Version=new i({obj:new r({int:2})}),this.asn1SerialNumber=null,this.asn1SignatureAlg=null,this.asn1Issuer=null,this.asn1NotBefore=null,this.asn1NotAfter=null,this.asn1Subject=null,this.asn1SubjPKey=null,this.extensionsArray=new Array},this.setSerialNumberByParam=function(t){this.asn1SerialNumber=new r(t)},this.setSignatureAlgByParam=function(t){this.asn1SignatureAlg=new s.AlgorithmIdentifier(t)},this.setIssuerByParam=function(t){this.asn1Issuer=new a(t)},this.setNotBeforeByParam=function(t){this.asn1NotBefore=new o(t)},this.setNotAfterByParam=function(t){this.asn1NotAfter=new o(t)},this.setSubjectByParam=function(t){this.asn1Subject=new a(t)},this.setSubjectPublicKey=function(t){this.asn1SubjPKey=new h(t)},this.setSubjectPublicKeyByGetKey=function(t){var e=Fn.getKey(t);this.asn1SubjPKey=new h(e)},this.appendExtension=function(t){this.extensionsArray.push(t)},this.appendExtensionByName=function(t,e){tn.asn1.x509.Extension.appendByNameToArray(t,e,this.extensionsArray)},this.getEncodedHex=function(){if(null==this.asn1NotBefore||null==this.asn1NotAfter)throw"notBefore and/or notAfter not set";var t=new n({array:[this.asn1NotBefore,this.asn1NotAfter]});if(this.asn1Array=new Array,this.asn1Array.push(this.asn1Version),this.asn1Array.push(this.asn1SerialNumber),this.asn1Array.push(this.asn1SignatureAlg),this.asn1Array.push(this.asn1Issuer),this.asn1Array.push(t),this.asn1Array.push(this.asn1Subject),this.asn1Array.push(this.asn1SubjPKey),this.extensionsArray.length>0){var e=new n({array:this.extensionsArray}),r=new i({explicit:!0,tag:"a3",obj:e});this.asn1Array.push(r)}var s=new n({array:this.asn1Array});return this.hTLV=s.getEncodedHex(),this.isModified=!1,this.hTLV},this._initialize()},ie.lang.extend(tn.asn1.x509.TBSCertificate,tn.asn1.ASN1Object),tn.asn1.x509.Extension=function(t){tn.asn1.x509.Extension.superclass.constructor.call(this);var e=tn.asn1,n=e.DERObjectIdentifier,r=e.DEROctetString,i=(e.DERBitString,e.DERBoolean),s=e.DERSequence;this.getEncodedHex=function(){var t=new n({oid:this.oid}),e=new r({hex:this.getExtnValueHex()}),o=new Array;return o.push(t),this.critical&&o.push(new i),o.push(e),new s({array:o}).getEncodedHex()},this.critical=!1,void 0!==t&&void 0!==t.critical&&(this.critical=t.critical)},ie.lang.extend(tn.asn1.x509.Extension,tn.asn1.ASN1Object),tn.asn1.x509.Extension.appendByNameToArray=function(t,e,n){var r=t.toLowerCase(),i=tn.asn1.x509;if("basicconstraints"==r){var s=new i.BasicConstraints(e);n.push(s)}else if("keyusage"==r){s=new i.KeyUsage(e);n.push(s)}else if("crldistributionpoints"==r){s=new i.CRLDistributionPoints(e);n.push(s)}else if("extkeyusage"==r){s=new i.ExtKeyUsage(e);n.push(s)}else if("authoritykeyidentifier"==r){s=new i.AuthorityKeyIdentifier(e);n.push(s)}else if("authorityinfoaccess"==r){s=new i.AuthorityInfoAccess(e);n.push(s)}else if("subjectaltname"==r){s=new i.SubjectAltName(e);n.push(s)}else{if("issueraltname"!=r)throw"unsupported extension name: "+t;s=new i.IssuerAltName(e);n.push(s)}},tn.asn1.x509.KeyUsage=function(t){tn.asn1.x509.KeyUsage.superclass.constructor.call(this,t);var e=Dn.KEYUSAGE_NAME;if(this.getExtnValueHex=function(){return this.asn1ExtnValue.getEncodedHex()},this.oid="2.5.29.15",void 0!==t&&(void 0!==t.bin&&(this.asn1ExtnValue=new tn.asn1.DERBitString(t)),void 0!==t.names&&void 0!==t.names.length)){for(var n=t.names,r="000000000",i=0;i<n.length;i++)for(var s=0;s<e.length;s++)n[i]===e[s]&&(r=r.substring(0,s)+"1"+r.substring(s+1,r.length));this.asn1ExtnValue=new tn.asn1.DERBitString({bin:r})}},ie.lang.extend(tn.asn1.x509.KeyUsage,tn.asn1.x509.Extension),tn.asn1.x509.BasicConstraints=function(t){tn.asn1.x509.BasicConstraints.superclass.constructor.call(this,t),this.getExtnValueHex=function(){var t=new Array;this.cA&&t.push(new tn.asn1.DERBoolean),this.pathLen>-1&&t.push(new tn.asn1.DERInteger({int:this.pathLen}));var e=new tn.asn1.DERSequence({array:t});return this.asn1ExtnValue=e,this.asn1ExtnValue.getEncodedHex()},this.oid="2.5.29.19",this.cA=!1,this.pathLen=-1,void 0!==t&&(void 0!==t.cA&&(this.cA=t.cA),void 0!==t.pathLen&&(this.pathLen=t.pathLen))},ie.lang.extend(tn.asn1.x509.BasicConstraints,tn.asn1.x509.Extension),tn.asn1.x509.CRLDistributionPoints=function(t){tn.asn1.x509.CRLDistributionPoints.superclass.constructor.call(this,t);var e=tn.asn1,n=e.x509;this.getExtnValueHex=function(){return this.asn1ExtnValue.getEncodedHex()},this.setByDPArray=function(t){this.asn1ExtnValue=new e.DERSequence({array:t})},this.setByOneURI=function(t){var e=new n.GeneralNames([{uri:t}]),r=new n.DistributionPointName(e),i=new n.DistributionPoint({dpobj:r});this.setByDPArray([i])},this.oid="2.5.29.31",void 0!==t&&(void 0!==t.array?this.setByDPArray(t.array):void 0!==t.uri&&this.setByOneURI(t.uri))},ie.lang.extend(tn.asn1.x509.CRLDistributionPoints,tn.asn1.x509.Extension),tn.asn1.x509.ExtKeyUsage=function(t){tn.asn1.x509.ExtKeyUsage.superclass.constructor.call(this,t);var e=tn.asn1;this.setPurposeArray=function(t){this.asn1ExtnValue=new e.DERSequence;for(var n=0;n<t.length;n++){var r=new e.DERObjectIdentifier(t[n]);this.asn1ExtnValue.appendASN1Object(r)}},this.getExtnValueHex=function(){return this.asn1ExtnValue.getEncodedHex()},this.oid="2.5.29.37",void 0!==t&&void 0!==t.array&&this.setPurposeArray(t.array)},ie.lang.extend(tn.asn1.x509.ExtKeyUsage,tn.asn1.x509.Extension),tn.asn1.x509.AuthorityKeyIdentifier=function(t){tn.asn1.x509.AuthorityKeyIdentifier.superclass.constructor.call(this,t);var e=tn.asn1,n=e.DERTaggedObject;this.asn1KID=null,this.asn1CertIssuer=null,this.asn1CertSN=null,this.getExtnValueHex=function(){var t=new Array;this.asn1KID&&t.push(new n({explicit:!1,tag:"80",obj:this.asn1KID})),this.asn1CertIssuer&&t.push(new n({explicit:!1,tag:"a1",obj:this.asn1CertIssuer})),this.asn1CertSN&&t.push(new n({explicit:!1,tag:"82",obj:this.asn1CertSN}));var r=new e.DERSequence({array:t});return this.asn1ExtnValue=r,this.asn1ExtnValue.getEncodedHex()},this.setKIDByParam=function(t){this.asn1KID=new tn.asn1.DEROctetString(t)},this.setCertIssuerByParam=function(t){this.asn1CertIssuer=new tn.asn1.x509.X500Name(t)},this.setCertSNByParam=function(t){this.asn1CertSN=new tn.asn1.DERInteger(t)},this.oid="2.5.29.35",void 0!==t&&(void 0!==t.kid&&this.setKIDByParam(t.kid),void 0!==t.issuer&&this.setCertIssuerByParam(t.issuer),void 0!==t.sn&&this.setCertSNByParam(t.sn))},ie.lang.extend(tn.asn1.x509.AuthorityKeyIdentifier,tn.asn1.x509.Extension),tn.asn1.x509.AuthorityInfoAccess=function(t){tn.asn1.x509.AuthorityInfoAccess.superclass.constructor.call(this,t),this.setAccessDescriptionArray=function(t){for(var e=new Array,n=tn.asn1,r=n.DERSequence,i=0;i<t.length;i++){var s=new r({array:[new n.DERObjectIdentifier(t[i].accessMethod),new n.x509.GeneralName(t[i].accessLocation)]});e.push(s)}this.asn1ExtnValue=new r({array:e})},this.getExtnValueHex=function(){return this.asn1ExtnValue.getEncodedHex()},this.oid="1.3.6.1.5.5.7.1.1",void 0!==t&&void 0!==t.array&&this.setAccessDescriptionArray(t.array)},ie.lang.extend(tn.asn1.x509.AuthorityInfoAccess,tn.asn1.x509.Extension),tn.asn1.x509.SubjectAltName=function(t){tn.asn1.x509.SubjectAltName.superclass.constructor.call(this,t),this.setNameArray=function(t){this.asn1ExtnValue=new tn.asn1.x509.GeneralNames(t)},this.getExtnValueHex=function(){return this.asn1ExtnValue.getEncodedHex()},this.oid="2.5.29.17",void 0!==t&&void 0!==t.array&&this.setNameArray(t.array)},ie.lang.extend(tn.asn1.x509.SubjectAltName,tn.asn1.x509.Extension),tn.asn1.x509.IssuerAltName=function(t){tn.asn1.x509.IssuerAltName.superclass.constructor.call(this,t),this.setNameArray=function(t){this.asn1ExtnValue=new tn.asn1.x509.GeneralNames(t)},this.getExtnValueHex=function(){return this.asn1ExtnValue.getEncodedHex()},this.oid="2.5.29.18",void 0!==t&&void 0!==t.array&&this.setNameArray(t.array)},ie.lang.extend(tn.asn1.x509.IssuerAltName,tn.asn1.x509.Extension),tn.asn1.x509.CRL=function(t){tn.asn1.x509.CRL.superclass.constructor.call(this),this.sign=function(){this.asn1SignatureAlg=this.asn1TBSCertList.asn1SignatureAlg,sig=new tn.crypto.Signature({alg:"SHA1withRSA",prov:"cryptojs/jsrsa"}),sig.init(this.prvKey),sig.updateHex(this.asn1TBSCertList.getEncodedHex()),this.hexSig=sig.sign(),this.asn1Sig=new tn.asn1.DERBitString({hex:"00"+this.hexSig});var t=new tn.asn1.DERSequence({array:[this.asn1TBSCertList,this.asn1SignatureAlg,this.asn1Sig]});this.hTLV=t.getEncodedHex(),this.isModified=!1},this.getEncodedHex=function(){if(0==this.isModified&&null!=this.hTLV)return this.hTLV;throw"not signed yet"},this.getPEMString=function(){return"-----BEGIN X509 CRL-----\r\n"+gn(this.getEncodedHex())+"\r\n-----END X509 CRL-----\r\n"},void 0!==t&&(void 0!==t.tbsobj&&(this.asn1TBSCertList=t.tbsobj),void 0!==t.prvkeyobj&&(this.prvKey=t.prvkeyobj))},ie.lang.extend(tn.asn1.x509.CRL,tn.asn1.ASN1Object),tn.asn1.x509.TBSCertList=function(t){tn.asn1.x509.TBSCertList.superclass.constructor.call(this);var e=tn.asn1,n=e.DERSequence,r=e.x509,i=r.Time;this.setSignatureAlgByParam=function(t){this.asn1SignatureAlg=new r.AlgorithmIdentifier(t)},this.setIssuerByParam=function(t){this.asn1Issuer=new r.X500Name(t)},this.setThisUpdateByParam=function(t){this.asn1ThisUpdate=new i(t)},this.setNextUpdateByParam=function(t){this.asn1NextUpdate=new i(t)},this.addRevokedCert=function(t,e){var n={};null!=t&&null!=t&&(n.sn=t),null!=e&&null!=e&&(n.time=e);var i=new r.CRLEntry(n);this.aRevokedCert.push(i)},this.getEncodedHex=function(){if(this.asn1Array=new Array,null!=this.asn1Version&&this.asn1Array.push(this.asn1Version),this.asn1Array.push(this.asn1SignatureAlg),this.asn1Array.push(this.asn1Issuer),this.asn1Array.push(this.asn1ThisUpdate),null!=this.asn1NextUpdate&&this.asn1Array.push(this.asn1NextUpdate),this.aRevokedCert.length>0){var t=new n({array:this.aRevokedCert});this.asn1Array.push(t)}var e=new n({array:this.asn1Array});return this.hTLV=e.getEncodedHex(),this.isModified=!1,this.hTLV},this._initialize=function(){this.asn1Version=null,this.asn1SignatureAlg=null,this.asn1Issuer=null,this.asn1ThisUpdate=null,this.asn1NextUpdate=null,this.aRevokedCert=new Array},this._initialize()},ie.lang.extend(tn.asn1.x509.TBSCertList,tn.asn1.ASN1Object),tn.asn1.x509.CRLEntry=function(t){tn.asn1.x509.CRLEntry.superclass.constructor.call(this);var e=tn.asn1;this.setCertSerial=function(t){this.sn=new e.DERInteger(t)},this.setRevocationDate=function(t){this.time=new e.x509.Time(t)},this.getEncodedHex=function(){var t=new e.DERSequence({array:[this.sn,this.time]});return this.TLV=t.getEncodedHex(),this.TLV},void 0!==t&&(void 0!==t.time&&this.setRevocationDate(t.time),void 0!==t.sn&&this.setCertSerial(t.sn))},ie.lang.extend(tn.asn1.x509.CRLEntry,tn.asn1.ASN1Object),tn.asn1.x509.X500Name=function(t){tn.asn1.x509.X500Name.superclass.constructor.call(this),this.asn1Array=new Array;var e=tn.asn1,n=e.x509,r=vn;if(this.setByString=function(t){var e=t.split("/");e.shift();for(var r=[],i=0;i<e.length;i++)if(e[i].match(/^[^=]+=.+$/))r.push(e[i]);else{var s=r.length-1;r[s]=r[s]+"/"+e[i]}for(i=0;i<r.length;i++)this.asn1Array.push(new n.RDN({str:r[i]}))},this.setByLdapString=function(t){var e=n.X500Name.ldapToOneline(t);this.setByString(e)},this.setByObject=function(t){for(var e in t)if(t.hasOwnProperty(e)){var n=new tn.asn1.x509.RDN({str:e+"="+t[e]});this.asn1Array?this.asn1Array.push(n):this.asn1Array=[n]}},this.getEncodedHex=function(){if("string"==typeof this.hTLV)return this.hTLV;var t=new e.DERSequence({array:this.asn1Array});return this.hTLV=t.getEncodedHex(),this.hTLV},void 0!==t){var i;if(void 0!==t.str?this.setByString(t.str):void 0!==t.ldapstr?this.setByLdapString(t.ldapstr):"object"==typeof t&&this.setByObject(t),void 0!==t.certissuer)(i=new Dn).hex=r(t.certissuer),this.hTLV=i.getIssuerHex();if(void 0!==t.certsubject)(i=new Dn).hex=r(t.certsubject),this.hTLV=i.getSubjectHex()}},ie.lang.extend(tn.asn1.x509.X500Name,tn.asn1.ASN1Object),tn.asn1.x509.X500Name.onelineToLDAP=function(t){if("/"!==t.substr(0,1))throw"malformed input";var e=(t=t.substr(1)).split("/");return e.reverse(),(e=e.map(function(t){return t.replace(/,/,"\\,")})).join(",")},tn.asn1.x509.X500Name.ldapToOneline=function(t){for(var e=t.split(","),n=!1,r=[],i=0;e.length>0;i++){var s=e.shift();if(!0===n){var o=(r.pop()+","+s).replace(/\\,/g,",");r.push(o),n=!1}else r.push(s);"\\"===s.substr(-1,1)&&(n=!0)}return(r=r.map(function(t){return t.replace("/","\\/")})).reverse(),"/"+r.join("/")},tn.asn1.x509.RDN=function(t){tn.asn1.x509.RDN.superclass.constructor.call(this),this.asn1Array=new Array,this.addByString=function(t){this.asn1Array.push(new tn.asn1.x509.AttributeTypeAndValue({str:t}))},this.addByMultiValuedString=function(t){for(var e=tn.asn1.x509.RDN.parseString(t),n=0;n<e.length;n++)this.addByString(e[n])},this.getEncodedHex=function(){var t=new tn.asn1.DERSet({array:this.asn1Array});return this.TLV=t.getEncodedHex(),this.TLV},void 0!==t&&void 0!==t.str&&this.addByMultiValuedString(t.str)},ie.lang.extend(tn.asn1.x509.RDN,tn.asn1.ASN1Object),tn.asn1.x509.RDN.parseString=function(t){for(var e=t.split(/\+/),n=!1,r=[],i=0;e.length>0;i++){var s=e.shift();if(!0===n){var o=(r.pop()+"+"+s).replace(/\\\+/g,"+");r.push(o),n=!1}else r.push(s);"\\"===s.substr(-1,1)&&(n=!0)}var a=!1,h=[];for(i=0;r.length>0;i++){s=r.shift();if(!0===a){var u=h.pop();if(s.match(/"$/)){o=(u+"+"+s).replace(/^([^=]+)="(.*)"$/,"$1=$2");h.push(o),a=!1}else h.push(u+"+"+s)}else h.push(s);s.match(/^[^=]+="/)&&(a=!0)}return h},tn.asn1.x509.AttributeTypeAndValue=function(t){tn.asn1.x509.AttributeTypeAndValue.superclass.constructor.call(this);var e=tn.asn1;this.setByString=function(t){var e=t.match(/^([^=]+)=(.+)$/);if(!e)throw"malformed attrTypeAndValueStr: "+t;this.setByAttrTypeAndValueStr(e[1],e[2])},this.setByAttrTypeAndValueStr=function(t,e){this.typeObj=tn.asn1.x509.OID.atype2obj(t);var n="utf8";"C"==t&&(n="prn"),this.valueObj=this.getValueObj(n,e)},this.getValueObj=function(t,n){if("utf8"==t)return new e.DERUTF8String({str:n});if("prn"==t)return new e.DERPrintableString({str:n});if("tel"==t)return new e.DERTeletexString({str:n});if("ia5"==t)return new e.DERIA5String({str:n});throw"unsupported directory string type: type="+t+" value="+n},this.getEncodedHex=function(){var t=new e.DERSequence({array:[this.typeObj,this.valueObj]});return this.TLV=t.getEncodedHex(),this.TLV},void 0!==t&&void 0!==t.str&&this.setByString(t.str)},ie.lang.extend(tn.asn1.x509.AttributeTypeAndValue,tn.asn1.ASN1Object),tn.asn1.x509.SubjectPublicKeyInfo=function(t){tn.asn1.x509.SubjectPublicKeyInfo.superclass.constructor.call(this);var e=tn,n=e.asn1,r=n.DERInteger,i=n.DERBitString,s=n.DERObjectIdentifier,o=n.DERSequence,a=n.ASN1Util.newObject,h=n.x509.AlgorithmIdentifier,u=e.crypto;u.ECDSA,u.DSA;this.getASN1Object=function(){if(null==this.asn1AlgId||null==this.asn1SubjPKey)throw"algId and/or subjPubKey not set";return new o({array:[this.asn1AlgId,this.asn1SubjPKey]})},this.getEncodedHex=function(){var t=this.getASN1Object();return this.hTLV=t.getEncodedHex(),this.hTLV},this.setPubKey=function(t){try{if(t instanceof Ge){var e=a({seq:[{int:{bigint:t.n}},{int:{int:t.e}}]}).getEncodedHex();this.asn1AlgId=new h({name:"rsaEncryption"}),this.asn1SubjPKey=new i({hex:"00"+e})}}catch(t){}try{if(t instanceof tn.crypto.ECDSA){var n=new s({name:t.curveName});this.asn1AlgId=new h({name:"ecPublicKey",asn1params:n}),this.asn1SubjPKey=new i({hex:"00"+t.pubKeyHex})}}catch(t){}try{if(t instanceof tn.crypto.DSA){n=new a({seq:[{int:{bigint:t.p}},{int:{bigint:t.q}},{int:{bigint:t.g}}]});this.asn1AlgId=new h({name:"dsa",asn1params:n});var o=new r({bigint:t.y});this.asn1SubjPKey=new i({hex:"00"+o.getEncodedHex()})}}catch(t){}},void 0!==t&&this.setPubKey(t)},ie.lang.extend(tn.asn1.x509.SubjectPublicKeyInfo,tn.asn1.ASN1Object),tn.asn1.x509.Time=function(t){tn.asn1.x509.Time.superclass.constructor.call(this);var e=tn.asn1,n=e.DERUTCTime,r=e.DERGeneralizedTime;this.setTimeParams=function(t){this.timeParams=t},this.getEncodedHex=function(){var t=null;return t=null!=this.timeParams?"utc"==this.type?new n(this.timeParams):new r(this.timeParams):"utc"==this.type?new n:new r,this.TLV=t.getEncodedHex(),this.TLV},this.type="utc",void 0!==t&&(void 0!==t.type?this.type=t.type:void 0!==t.str&&(t.str.match(/^[0-9]{12}Z$/)&&(this.type="utc"),t.str.match(/^[0-9]{14}Z$/)&&(this.type="gen")),this.timeParams=t)},ie.lang.extend(tn.asn1.x509.Time,tn.asn1.ASN1Object),tn.asn1.x509.AlgorithmIdentifier=function(t){tn.asn1.x509.AlgorithmIdentifier.superclass.constructor.call(this),this.nameAlg=null,this.asn1Alg=null,this.asn1Params=null,this.paramEmpty=!1;var e=tn.asn1;if(this.getEncodedHex=function(){if(null===this.nameAlg&&null===this.asn1Alg)throw"algorithm not specified";null!==this.nameAlg&&null===this.asn1Alg&&(this.asn1Alg=e.x509.OID.name2obj(this.nameAlg));var t=[this.asn1Alg];null!==this.asn1Params&&t.push(this.asn1Params);var n=new e.DERSequence({array:t});return this.hTLV=n.getEncodedHex(),this.hTLV},void 0!==t&&(void 0!==t.name&&(this.nameAlg=t.name),void 0!==t.asn1params&&(this.asn1Params=t.asn1params),void 0!==t.paramempty&&(this.paramEmpty=t.paramempty)),null===this.asn1Params&&!1===this.paramEmpty&&null!==this.nameAlg){var n=this.nameAlg.toLowerCase();"withdsa"!==n.substr(-7,7)&&"withecdsa"!==n.substr(-9,9)&&(this.asn1Params=new e.DERNull)}},ie.lang.extend(tn.asn1.x509.AlgorithmIdentifier,tn.asn1.ASN1Object),tn.asn1.x509.GeneralName=function(t){tn.asn1.x509.GeneralName.superclass.constructor.call(this);var e={rfc822:"81",dns:"82",dn:"a4",uri:"86",ip:"87"},n=tn.asn1,r=(n.DERSequence,n.DEROctetString),i=n.DERIA5String,s=n.DERTaggedObject,o=n.ASN1Object,a=n.x509.X500Name,h=vn;this.explicit=!1,this.setByParam=function(t){var n=null;if(void 0!==t){if(void 0!==t.rfc822&&(this.type="rfc822",n=new i({str:t[this.type]})),void 0!==t.dns&&(this.type="dns",n=new i({str:t[this.type]})),void 0!==t.uri&&(this.type="uri",n=new i({str:t[this.type]})),void 0!==t.dn&&(this.type="dn",this.explicit=!0,n=new a({str:t.dn})),void 0!==t.ldapdn&&(this.type="dn",this.explicit=!0,n=new a({ldapstr:t.ldapdn})),void 0!==t.certissuer){this.type="dn",this.explicit=!0;var u=null;if((f=t.certissuer).match(/^[0-9A-Fa-f]+$/),-1!=f.indexOf("-----BEGIN ")&&(u=h(f)),null==u)throw"certissuer param not cert";(l=new Dn).hex=u;var c=l.getIssuerHex();(n=new o).hTLV=c}if(void 0!==t.certsubj){this.type="dn",this.explicit=!0;var f,l;u=null;if((f=t.certsubj).match(/^[0-9A-Fa-f]+$/),-1!=f.indexOf("-----BEGIN ")&&(u=h(f)),null==u)throw"certsubj param not cert";(l=new Dn).hex=u;c=l.getSubjectHex();(n=new o).hTLV=c}if(void 0!==t.ip){this.type="ip",this.explicit=!1;var d,p=t.ip,g="malformed IP address";if(p.match(/^[0-9.]+[.][0-9.]+$/)){if(8!==(d=function(t){t=(t=(t=t.replace(/^\s*\[\s*/,"")).replace(/\s*\]\s*$/,"")).replace(/\s*/g,"");try{var e=t.split(/,/).map(function(t,e,n){var r=parseInt(t);if(r<0||255<r)throw"integer not in range 0-255";var i=("00"+r.toString(16)).slice(-2);return i}).join("");return e}catch(t){throw"malformed integer array string: "+t}}("["+p.split(".").join(",")+"]")).length)throw g}else if(p.match(/^[0-9A-Fa-f:]+:[0-9A-Fa-f:]+$/))d=function(t){var e="malformed IPv6 address";if(!t.match(/^[0-9A-Fa-f:]+$/))throw e;var n=(t=t.toLowerCase()).split(":").length-1;if(n<2)throw e;var r=":".repeat(7-n+2),i=(t=t.replace("::",r)).split(":");if(8!=i.length)throw e;for(var s=0;s<8;s++)i[s]=("0000"+i[s]).slice(-4);return i.join("")}(p);else{if(!p.match(/^([0-9A-Fa-f][0-9A-Fa-f]){1,}$/))throw g;d=p}n=new r({hex:d})}if(null==this.type)throw"unsupported type in params="+t;this.asn1Obj=new s({explicit:this.explicit,tag:e[this.type],obj:n})}},this.getEncodedHex=function(){return this.asn1Obj.getEncodedHex()},void 0!==t&&this.setByParam(t)},ie.lang.extend(tn.asn1.x509.GeneralName,tn.asn1.ASN1Object),tn.asn1.x509.GeneralNames=function(t){tn.asn1.x509.GeneralNames.superclass.constructor.call(this);var e=tn.asn1;this.setByParamArray=function(t){for(var n=0;n<t.length;n++){var r=new e.x509.GeneralName(t[n]);this.asn1Array.push(r)}},this.getEncodedHex=function(){return new e.DERSequence({array:this.asn1Array}).getEncodedHex()},this.asn1Array=new Array,void 0!==t&&this.setByParamArray(t)},ie.lang.extend(tn.asn1.x509.GeneralNames,tn.asn1.ASN1Object),tn.asn1.x509.DistributionPointName=function(t){tn.asn1.x509.DistributionPointName.superclass.constructor.call(this);var e=tn.asn1,n=e.DERTaggedObject;if(this.getEncodedHex=function(){if("full"!=this.type)throw"currently type shall be 'full': "+this.type;return this.asn1Obj=new n({explicit:!1,tag:this.tag,obj:this.asn1V}),this.hTLV=this.asn1Obj.getEncodedHex(),this.hTLV},void 0!==t){if(!e.x509.GeneralNames.prototype.isPrototypeOf(t))throw"This class supports GeneralNames only as argument";this.type="full",this.tag="a0",this.asn1V=t}},ie.lang.extend(tn.asn1.x509.DistributionPointName,tn.asn1.ASN1Object),tn.asn1.x509.DistributionPoint=function(t){tn.asn1.x509.DistributionPoint.superclass.constructor.call(this);var e=tn.asn1;this.getEncodedHex=function(){var t=new e.DERSequence;if(null!=this.asn1DP){var n=new e.DERTaggedObject({explicit:!0,tag:"a0",obj:this.asn1DP});t.appendASN1Object(n)}return this.hTLV=t.getEncodedHex(),this.hTLV},void 0!==t&&void 0!==t.dpobj&&(this.asn1DP=t.dpobj)},ie.lang.extend(tn.asn1.x509.DistributionPoint,tn.asn1.ASN1Object),tn.asn1.x509.OID=new function(t){this.atype2oidList={CN:"2.5.4.3",L:"2.5.4.7",ST:"2.5.4.8",O:"2.5.4.10",OU:"2.5.4.11",C:"2.5.4.6",STREET:"2.5.4.9",DC:"0.9.2342.19200300.100.1.25",UID:"0.9.2342.19200300.100.1.1",SN:"2.5.4.4",T:"2.5.4.12",DN:"2.5.4.49",E:"1.2.840.113549.1.9.1",description:"2.5.4.13",businessCategory:"2.5.4.15",postalCode:"2.5.4.17",serialNumber:"2.5.4.5",uniqueIdentifier:"2.5.4.45",organizationIdentifier:"2.5.4.97",jurisdictionOfIncorporationL:"1.3.6.1.4.1.311.60.2.1.1",jurisdictionOfIncorporationSP:"1.3.6.1.4.1.311.60.2.1.2",jurisdictionOfIncorporationC:"1.3.6.1.4.1.311.60.2.1.3"},this.name2oidList={sha1:"1.3.14.3.2.26",sha256:"2.16.840.1.101.3.4.2.1",sha384:"2.16.840.1.101.3.4.2.2",sha512:"2.16.840.1.101.3.4.2.3",sha224:"2.16.840.1.101.3.4.2.4",md5:"1.2.840.113549.2.5",md2:"1.3.14.7.2.2.1",ripemd160:"1.3.36.3.2.1",MD2withRSA:"1.2.840.113549.1.1.2",MD4withRSA:"1.2.840.113549.1.1.3",MD5withRSA:"1.2.840.113549.1.1.4",SHA1withRSA:"1.2.840.113549.1.1.5",SHA224withRSA:"1.2.840.113549.1.1.14",SHA256withRSA:"1.2.840.113549.1.1.11",SHA384withRSA:"1.2.840.113549.1.1.12",SHA512withRSA:"1.2.840.113549.1.1.13",SHA1withECDSA:"1.2.840.10045.4.1",SHA224withECDSA:"1.2.840.10045.4.3.1",SHA256withECDSA:"1.2.840.10045.4.3.2",SHA384withECDSA:"1.2.840.10045.4.3.3",SHA512withECDSA:"1.2.840.10045.4.3.4",dsa:"1.2.840.10040.4.1",SHA1withDSA:"1.2.840.10040.4.3",SHA224withDSA:"2.16.840.1.101.3.4.3.1",SHA256withDSA:"2.16.840.1.101.3.4.3.2",rsaEncryption:"1.2.840.113549.1.1.1",commonName:"2.5.4.3",countryName:"2.5.4.6",localityName:"2.5.4.7",stateOrProvinceName:"2.5.4.8",streetAddress:"2.5.4.9",organizationName:"2.5.4.10",organizationalUnitName:"2.5.4.11",domainComponent:"0.9.2342.19200300.100.1.25",userId:"0.9.2342.19200300.100.1.1",surname:"2.5.4.4",title:"2.5.4.12",distinguishedName:"2.5.4.49",emailAddress:"1.2.840.113549.1.9.1",description:"2.5.4.13",businessCategory:"2.5.4.15",postalCode:"2.5.4.17",uniqueIdentifier:"2.5.4.45",organizationIdentifier:"2.5.4.97",jurisdictionOfIncorporationL:"1.3.6.1.4.1.311.60.2.1.1",jurisdictionOfIncorporationSP:"1.3.6.1.4.1.311.60.2.1.2",jurisdictionOfIncorporationC:"1.3.6.1.4.1.311.60.2.1.3",subjectKeyIdentifier:"2.5.29.14",keyUsage:"2.5.29.15",subjectAltName:"2.5.29.17",issuerAltName:"2.5.29.18",basicConstraints:"2.5.29.19",nameConstraints:"2.5.29.30",cRLDistributionPoints:"2.5.29.31",certificatePolicies:"2.5.29.32",authorityKeyIdentifier:"2.5.29.35",policyConstraints:"2.5.29.36",extKeyUsage:"2.5.29.37",authorityInfoAccess:"1.3.6.1.5.5.7.1.1",ocsp:"1.3.6.1.5.5.7.48.1",caIssuers:"1.3.6.1.5.5.7.48.2",anyExtendedKeyUsage:"2.5.29.37.0",serverAuth:"1.3.6.1.5.5.7.3.1",clientAuth:"1.3.6.1.5.5.7.3.2",codeSigning:"1.3.6.1.5.5.7.3.3",emailProtection:"1.3.6.1.5.5.7.3.4",timeStamping:"1.3.6.1.5.5.7.3.8",ocspSigning:"1.3.6.1.5.5.7.3.9",ecPublicKey:"1.2.840.10045.2.1",secp256r1:"1.2.840.10045.3.1.7",secp256k1:"1.3.132.0.10",secp384r1:"1.3.132.0.34",pkcs5PBES2:"1.2.840.113549.1.5.13",pkcs5PBKDF2:"1.2.840.113549.1.5.12","des-EDE3-CBC":"1.2.840.113549.3.7",data:"1.2.840.113549.1.7.1","signed-data":"1.2.840.113549.1.7.2","enveloped-data":"1.2.840.113549.1.7.3","digested-data":"1.2.840.113549.1.7.5","encrypted-data":"1.2.840.113549.1.7.6","authenticated-data":"1.2.840.113549.1.9.16.1.2",tstinfo:"1.2.840.113549.1.9.16.1.4",extensionRequest:"1.2.840.113549.1.9.14"},this.objCache={},this.name2obj=function(t){if(void 0!==this.objCache[t])return this.objCache[t];if(void 0===this.name2oidList[t])throw"Name of ObjectIdentifier not defined: "+t;var e=this.name2oidList[t],n=new tn.asn1.DERObjectIdentifier({oid:e});return this.objCache[t]=n,n},this.atype2obj=function(t){if(void 0!==this.objCache[t])return this.objCache[t];if(void 0===this.atype2oidList[t])throw"AttributeType name undefined: "+t;var e=this.atype2oidList[t],n=new tn.asn1.DERObjectIdentifier({oid:e});return this.objCache[t]=n,n}},tn.asn1.x509.OID.oid2name=function(t){var e=tn.asn1.x509.OID.name2oidList;for(var n in e)if(e[n]==t)return n;return""},tn.asn1.x509.OID.oid2atype=function(t){var e=tn.asn1.x509.OID.atype2oidList;for(var n in e)if(e[n]==t)return n;return t},tn.asn1.x509.OID.name2oid=function(t){var e=tn.asn1.x509.OID.name2oidList;return void 0===e[t]?"":e[t]},tn.asn1.x509.X509Util={},tn.asn1.x509.X509Util.newCertPEM=function(t){var e=tn.asn1.x509,n=e.TBSCertificate,r=e.Certificate,i=new n;if(void 0===t.serial)throw"serial number undefined.";if(i.setSerialNumberByParam(t.serial),"string"!=typeof t.sigalg.name)throw"unproper signature algorithm name";if(i.setSignatureAlgByParam(t.sigalg),void 0===t.issuer)throw"issuer name undefined.";if(i.setIssuerByParam(t.issuer),void 0===t.notbefore)throw"notbefore undefined.";if(i.setNotBeforeByParam(t.notbefore),void 0===t.notafter)throw"notafter undefined.";if(i.setNotAfterByParam(t.notafter),void 0===t.subject)throw"subject name undefined.";if(i.setSubjectByParam(t.subject),void 0===t.sbjpubkey)throw"subject public key undefined.";if(i.setSubjectPublicKeyByGetKey(t.sbjpubkey),void 0!==t.ext&&void 0!==t.ext.length)for(var s=0;s<t.ext.length;s++)for(key in t.ext[s])i.appendExtensionByName(key,t.ext[s][key]);if(void 0===t.cakey&&void 0===t.sighex)throw"param cakey and sighex undefined.";var o=null;return t.cakey&&(o=new r({tbscertobj:i,prvkeyobj:!0===t.cakey.isPrivate?t.cakey:Fn.getKey.apply(null,t.cakey)})).sign(),t.sighex&&(o=new r({tbscertobj:i})).setSignatureHex(t.sighex),o.getPEMString()},void 0!==tn&&tn||(tn={}),void 0!==tn.asn1&&tn.asn1||(tn.asn1={}),void 0!==tn.asn1.cms&&tn.asn1.cms||(tn.asn1.cms={}),tn.asn1.cms.Attribute=function(t){var e=tn.asn1;e.cms.Attribute.superclass.constructor.call(this),this.getEncodedHex=function(){var t,n,r;t=new e.DERObjectIdentifier({oid:this.attrTypeOid}),n=new e.DERSet({array:this.valueList});try{n.getEncodedHex()}catch(t){throw"fail valueSet.getEncodedHex in Attribute(1)/"+t}r=new e.DERSequence({array:[t,n]});try{this.hTLV=r.getEncodedHex()}catch(t){throw"failed seq.getEncodedHex in Attribute(2)/"+t}return this.hTLV}},ie.lang.extend(tn.asn1.cms.Attribute,tn.asn1.ASN1Object),tn.asn1.cms.ContentType=function(t){var e=tn.asn1;e.cms.ContentType.superclass.constructor.call(this),this.attrTypeOid="1.2.840.113549.1.9.3";var n=null;if(void 0!==t){n=new e.DERObjectIdentifier(t);this.valueList=[n]}},ie.lang.extend(tn.asn1.cms.ContentType,tn.asn1.cms.Attribute),tn.asn1.cms.MessageDigest=function(t){var e=tn,n=e.asn1,r=n.DEROctetString,i=n.cms;if(i.MessageDigest.superclass.constructor.call(this),this.attrTypeOid="1.2.840.113549.1.9.4",void 0!==t)if(t.eciObj instanceof i.EncapsulatedContentInfo&&"string"==typeof t.hashAlg){var s=t.eciObj.eContentValueHex,o=t.hashAlg;(a=new r({hex:e.crypto.Util.hashHex(s,o)})).getEncodedHex(),this.valueList=[a]}else{var a;(a=new r(t)).getEncodedHex(),this.valueList=[a]}},ie.lang.extend(tn.asn1.cms.MessageDigest,tn.asn1.cms.Attribute),tn.asn1.cms.SigningTime=function(t){var e=tn.asn1;if(e.cms.SigningTime.superclass.constructor.call(this),this.attrTypeOid="1.2.840.113549.1.9.5",void 0!==t){var n=new e.x509.Time(t);try{n.getEncodedHex()}catch(t){throw"SigningTime.getEncodedHex() failed/"+t}this.valueList=[n]}},ie.lang.extend(tn.asn1.cms.SigningTime,tn.asn1.cms.Attribute),tn.asn1.cms.SigningCertificate=function(t){var e=tn,n=e.asn1,r=n.DERSequence,i=n.cms;e.crypto;i.SigningCertificate.superclass.constructor.call(this),this.attrTypeOid="1.2.840.113549.1.9.16.2.12",this.setCerts=function(t){for(var s=[],o=0;o<t.length;o++){var a=vn(t[o]),h=e.crypto.Util.hashHex(a,"sha1"),u=new n.DEROctetString({hex:h});u.getEncodedHex();var c=new i.IssuerAndSerialNumber({cert:t[o]});c.getEncodedHex();var f=new r({array:[u,c]});f.getEncodedHex(),s.push(f)}var l=new r({array:s});l.getEncodedHex(),this.valueList=[l]},void 0!==t&&"object"==typeof t.array&&this.setCerts(t.array)},ie.lang.extend(tn.asn1.cms.SigningCertificate,tn.asn1.cms.Attribute),tn.asn1.cms.SigningCertificateV2=function(t){var e=tn,n=e.asn1,r=n.DERSequence,i=n.x509,s=n.cms,o=e.crypto;if(s.SigningCertificateV2.superclass.constructor.call(this),this.attrTypeOid="1.2.840.113549.1.9.16.2.47",this.setCerts=function(t,e){for(var a=[],h=0;h<t.length;h++){var u=vn(t[h]),c=[];"sha256"!==e&&c.push(new i.AlgorithmIdentifier({name:e}));var f=o.Util.hashHex(u,e),l=new n.DEROctetString({hex:f});l.getEncodedHex(),c.push(l);var d=new s.IssuerAndSerialNumber({cert:t[h]});d.getEncodedHex(),c.push(d);var p=new r({array:c});p.getEncodedHex(),a.push(p)}var g=new r({array:a});g.getEncodedHex(),this.valueList=[g]},void 0!==t&&"object"==typeof t.array){var a="sha256";"string"==typeof t.hashAlg&&(a=t.hashAlg),this.setCerts(t.array,a)}},ie.lang.extend(tn.asn1.cms.SigningCertificateV2,tn.asn1.cms.Attribute),tn.asn1.cms.IssuerAndSerialNumber=function(t){var e=tn.asn1,n=e.DERInteger,r=e.cms,i=e.x509.X500Name,s=Dn;r.IssuerAndSerialNumber.superclass.constructor.call(this),this.setByCertPEM=function(t){var e=vn(t),r=new s;r.hex=e;var o=r.getIssuerHex();this.dIssuer=new i,this.dIssuer.hTLV=o;var a=r.getSerialNumberHex();this.dSerial=new n({hex:a})},this.getEncodedHex=function(){var t=new e.DERSequence({array:[this.dIssuer,this.dSerial]});return this.hTLV=t.getEncodedHex(),this.hTLV},void 0!==t&&("string"==typeof t&&-1!=t.indexOf("-----BEGIN ")&&this.setByCertPEM(t),t.issuer&&t.serial&&(t.issuer instanceof i?this.dIssuer=t.issuer:this.dIssuer=new i(t.issuer),t.serial instanceof n?this.dSerial=t.serial:this.dSerial=new n(t.serial)),"string"==typeof t.cert&&this.setByCertPEM(t.cert))},ie.lang.extend(tn.asn1.cms.IssuerAndSerialNumber,tn.asn1.ASN1Object),tn.asn1.cms.AttributeList=function(t){var e=tn.asn1,n=e.cms;n.AttributeList.superclass.constructor.call(this),this.list=new Array,this.sortFlag=!0,this.add=function(t){t instanceof n.Attribute&&this.list.push(t)},this.length=function(){return this.list.length},this.clear=function(){this.list=new Array,this.hTLV=null,this.hV=null},this.getEncodedHex=function(){if("string"==typeof this.hTLV)return this.hTLV;var t=new e.DERSet({array:this.list,sortflag:this.sortFlag});return this.hTLV=t.getEncodedHex(),this.hTLV},void 0!==t&&void 0!==t.sortflag&&0==t.sortflag&&(this.sortFlag=!1)},ie.lang.extend(tn.asn1.cms.AttributeList,tn.asn1.ASN1Object),tn.asn1.cms.SignerInfo=function(t){var e=tn,n=e.asn1,r=n.DERTaggedObject,i=n.cms,s=i.AttributeList,o=i.ContentType,a=i.EncapsulatedContentInfo,h=i.MessageDigest,u=i.SignedData,c=n.x509.AlgorithmIdentifier,f=e.crypto,l=Fn;i.SignerInfo.superclass.constructor.call(this),this.dCMSVersion=new n.DERInteger({int:1}),this.dSignerIdentifier=null,this.dDigestAlgorithm=null,this.dSignedAttrs=new s,this.dSigAlg=null,this.dSig=null,this.dUnsignedAttrs=new s,this.setSignerIdentifier=function(t){"string"==typeof t&&-1!=t.indexOf("CERTIFICATE")&&-1!=t.indexOf("BEGIN")&&-1!=t.indexOf("END")&&(this.dSignerIdentifier=new i.IssuerAndSerialNumber({cert:t}))},this.setForContentAndHash=function(t){void 0!==t&&(t.eciObj instanceof a&&(this.dSignedAttrs.add(new o({oid:"1.2.840.113549.1.7.1"})),this.dSignedAttrs.add(new h({eciObj:t.eciObj,hashAlg:t.hashAlg}))),void 0!==t.sdObj&&t.sdObj instanceof u&&-1==t.sdObj.digestAlgNameList.join(":").indexOf(t.hashAlg)&&t.sdObj.digestAlgNameList.push(t.hashAlg),"string"==typeof t.hashAlg&&(this.dDigestAlgorithm=new c({name:t.hashAlg})))},this.sign=function(t,e){this.dSigAlg=new c({name:e});var r=this.dSignedAttrs.getEncodedHex(),i=l.getKey(t),s=new f.Signature({alg:e});s.init(i),s.updateHex(r);var o=s.sign();this.dSig=new n.DEROctetString({hex:o})},this.addUnsigned=function(t){this.hTLV=null,this.dUnsignedAttrs.hTLV=null,this.dUnsignedAttrs.add(t)},this.getEncodedHex=function(){if(this.dSignedAttrs instanceof s&&0==this.dSignedAttrs.length())throw"SignedAttrs length = 0 (empty)";var t=new r({obj:this.dSignedAttrs,tag:"a0",explicit:!1}),e=null;this.dUnsignedAttrs.length()>0&&(e=new r({obj:this.dUnsignedAttrs,tag:"a1",explicit:!1}));var i=[this.dCMSVersion,this.dSignerIdentifier,this.dDigestAlgorithm,t,this.dSigAlg,this.dSig];null!=e&&i.push(e);var o=new n.DERSequence({array:i});return this.hTLV=o.getEncodedHex(),this.hTLV}},ie.lang.extend(tn.asn1.cms.SignerInfo,tn.asn1.ASN1Object),tn.asn1.cms.EncapsulatedContentInfo=function(t){var e=tn.asn1,n=e.DERTaggedObject,r=e.DERSequence,i=e.DERObjectIdentifier,s=e.DEROctetString;e.cms.EncapsulatedContentInfo.superclass.constructor.call(this),this.dEContentType=new i({name:"data"}),this.dEContent=null,this.isDetached=!1,this.eContentValueHex=null,this.setContentType=function(t){t.match(/^[0-2][.][0-9.]+$/)?this.dEContentType=new i({oid:t}):this.dEContentType=new i({name:t})},this.setContentValue=function(t){void 0!==t&&("string"==typeof t.hex?this.eContentValueHex=t.hex:"string"==typeof t.str&&(this.eContentValueHex=fn(t.str)))},this.setContentValueHex=function(t){this.eContentValueHex=t},this.setContentValueStr=function(t){this.eContentValueHex=fn(t)},this.getEncodedHex=function(){if("string"!=typeof this.eContentValueHex)throw"eContentValue not yet set";var t=new s({hex:this.eContentValueHex});this.dEContent=new n({obj:t,tag:"a0",explicit:!0});var e=[this.dEContentType];this.isDetached||e.push(this.dEContent);var i=new r({array:e});return this.hTLV=i.getEncodedHex(),this.hTLV}},ie.lang.extend(tn.asn1.cms.EncapsulatedContentInfo,tn.asn1.ASN1Object),tn.asn1.cms.ContentInfo=function(t){var e=tn.asn1,n=e.DERTaggedObject,r=e.DERSequence,i=e.x509;tn.asn1.cms.ContentInfo.superclass.constructor.call(this),this.dContentType=null,this.dContent=null,this.setContentType=function(t){"string"==typeof t&&(this.dContentType=i.OID.name2obj(t))},this.getEncodedHex=function(){var t=new n({obj:this.dContent,tag:"a0",explicit:!0}),e=new r({array:[this.dContentType,t]});return this.hTLV=e.getEncodedHex(),this.hTLV},void 0!==t&&(t.type&&this.setContentType(t.type),t.obj&&t.obj instanceof e.ASN1Object&&(this.dContent=t.obj))},ie.lang.extend(tn.asn1.cms.ContentInfo,tn.asn1.ASN1Object),tn.asn1.cms.SignedData=function(t){var e=tn.asn1,n=e.ASN1Object,r=e.DERInteger,i=e.DERSet,s=e.DERSequence,o=e.DERTaggedObject,a=e.cms,h=a.EncapsulatedContentInfo,u=a.SignerInfo,c=a.ContentInfo,f=e.x509.AlgorithmIdentifier;tn.asn1.cms.SignedData.superclass.constructor.call(this),this.dCMSVersion=new r({int:1}),this.dDigestAlgs=null,this.digestAlgNameList=[],this.dEncapContentInfo=new h,this.dCerts=null,this.certificateList=[],this.crlList=[],this.signerInfoList=[new u],this.addCertificatesByPEM=function(t){var e=vn(t),r=new n;r.hTLV=e,this.certificateList.push(r)},this.getEncodedHex=function(){if("string"==typeof this.hTLV)return this.hTLV;if(null==this.dDigestAlgs){for(var t=[],e=0;e<this.digestAlgNameList.length;e++){var n=this.digestAlgNameList[e],r=new f({name:n});t.push(r)}this.dDigestAlgs=new i({array:t})}var a=[this.dCMSVersion,this.dDigestAlgs,this.dEncapContentInfo];if(null==this.dCerts&&this.certificateList.length>0){var h=new i({array:this.certificateList});this.dCerts=new o({obj:h,tag:"a0",explicit:!1})}null!=this.dCerts&&a.push(this.dCerts);var u=new i({array:this.signerInfoList});a.push(u);var c=new s({array:a});return this.hTLV=c.getEncodedHex(),this.hTLV},this.getContentInfo=function(){return this.getEncodedHex(),new c({type:"signed-data",obj:this})},this.getContentInfoEncodedHex=function(){return this.getContentInfo().getEncodedHex()},this.getPEM=function(){return yn(this.getContentInfoEncodedHex(),"CMS")}},ie.lang.extend(tn.asn1.cms.SignedData,tn.asn1.ASN1Object),tn.asn1.cms.CMSUtil=new function(){},tn.asn1.cms.CMSUtil.newSignedData=function(t){var e=tn.asn1,n=e.cms,r=n.SignerInfo,i=n.SignedData,s=n.SigningTime,o=n.SigningCertificate,a=n.SigningCertificateV2,h=e.cades.SignaturePolicyIdentifier,u=new i;if(u.dEncapContentInfo.setContentValue(t.content),"object"==typeof t.certs)for(var c=0;c<t.certs.length;c++)u.addCertificatesByPEM(t.certs[c]);u.signerInfoList=[];for(c=0;c<t.signerInfos.length;c++){var f=t.signerInfos[c],l=new r;for(attrName in l.setSignerIdentifier(f.signerCert),l.setForContentAndHash({sdObj:u,eciObj:u.dEncapContentInfo,hashAlg:f.hashAlg}),f.sAttr){var d=f.sAttr[attrName];if("SigningTime"==attrName){var p=new s(d);l.dSignedAttrs.add(p)}if("SigningCertificate"==attrName){p=new o(d);l.dSignedAttrs.add(p)}if("SigningCertificateV2"==attrName){p=new a(d);l.dSignedAttrs.add(p)}if("SignaturePolicyIdentifier"==attrName){p=new h(d);l.dSignedAttrs.add(p)}}l.sign(f.signerPrvKey,f.sigAlg),u.signerInfoList.push(l)}return u},tn.asn1.cms.CMSUtil.verifySignedData=function(t){var e=tn,n=e.asn1,r=n.cms,i=(r.SignerInfo,r.SignedData,r.SigningTime,r.SigningCertificate,r.SigningCertificateV2,n.cades.SignaturePolicyIdentifier,e.lang.String.isHex),s=rn,o=s.getVbyList,a=s.getTLVbyList,h=s.getIdxbyList,u=s.getChildIdx,c=s.getTLV,f=s.oidname,l=e.crypto.Util.hashHex;void 0===t.cms&&i(t.cms);var d=t.cms,p=function(t,e){var n=e.idx;e.signerid_issuer1=a(t,n,[1,0],"30"),e.signerid_serial1=o(t,n,[1,1],"02"),e.hashalg=f(o(t,n,[2,0],"06"));var r=h(t,n,[3],"a0");e.idxSignedAttrs=r,g(t,e,r);var i=u(t,n).length;if(i<6)throw"malformed SignerInfo";e.sigalg=f(o(t,n,[i-2,0],"06")),e.sigval=o(t,n,[i-1],"04")},g=function(t,e,n){var r=u(t,n);e.signedAttrIdxList=r;for(var i=0;i<r.length;i++){var s,a=r[i],h=o(t,a,[0],"06");"2a864886f70d010905"===h?(s=ln(o(t,a,[1,0])),e.saSigningTime=s):"2a864886f70d010904"===h&&(s=o(t,a,[1,0],"04"),e.saMessageDigest=s)}},y=function(t,e,n,r){n.verifyDetail={};var i=n.verifyDetail,s=e.parse.econtent,o=n.hashalg,a=n.saMessageDigest;i.validMessageDigest=!1,l(s,o)===a&&(i.validMessageDigest=!0),function(t,e,n,r){var i,s=e.parse.certsIdx;if(void 0===e.certs){i=[],e.certkeys=[];for(var o=u(t,s),a=0;a<o.length;a++){var h=c(t,o[a]),f=new Dn;f.readCertHex(h),i[a]=f,e.certkeys[a]=f.getPublicKey()}e.certs=i}else i=e.certs;e.cccc=i.length,e.cccci=o.length;for(a=0;a<i.length;a++){var l=f.getIssuerHex(),d=f.getSerialNumberHex();n.signerid_issuer1===l&&n.signerid_serial1===d&&(n.certkey_idx=a)}}(t,e,n),i.validSignatureValue=!1;var h=n.sigalg,f="31"+c(t,n.idxSignedAttrs).substr(2);n.signedattrshex=f;var d=e.certs[n.certkey_idx].getPublicKey(),p=new tn.crypto.Signature({alg:h});p.init(d),p.updateHex(f);var g=p.verify(n.sigval);i.validSignatureValue_isValid=g,!0===g&&(i.validSignatureValue=!0),n.isValid=!1,i.validMessageDigest&&i.validSignatureValue&&(n.isValid=!0)},v={isValid:!1,parse:{}};return function(t,e){if("2a864886f70d010702"!==o(t,0,[0],"06"))return e;e.cmsType="signedData",e.econtent=o(t,0,[1,0,2,1,0]),function(t,e){for(var n,r=3;r<6;r++)if(void 0!==(n=h(t,0,[1,0,r]))){var i=t.substr(n,2);"a0"===i&&(e.certsIdx=n),"a1"===i&&(e.revinfosIdx=n),"31"===i&&(e.signerinfosIdx=n)}}(t,e),e.signerInfos=[],function(t,e){var n=e.signerinfosIdx;if(void 0!==n){var r=u(t,n);e.signerInfoIdxList=r;for(var i=0;i<r.length;i++){var s={idx:r[i]};p(t,s),e.signerInfos.push(s)}}}(t,e)}(d,v.parse),function(t,e){for(var n=e.parse.signerInfos,r=n.length,i=!0,s=0;s<r;s++){var o=n[s];y(t,e,o,s),o.isValid||(i=!1)}e.isValid=i}(d,v),v},void 0!==tn&&tn||(tn={}),void 0!==tn.asn1&&tn.asn1||(tn.asn1={}),void 0!==tn.asn1.tsp&&tn.asn1.tsp||(tn.asn1.tsp={}),tn.asn1.tsp.Accuracy=function(t){var e=tn.asn1,n=e.DERInteger,r=e.DERSequence,i=e.DERTaggedObject;e.tsp.Accuracy.superclass.constructor.call(this),this.seconds=null,this.millis=null,this.micros=null,this.getEncodedHex=function(){var t=null,e=null,s=null,o=[];if(null!=this.seconds&&(t=new n({int:this.seconds}),o.push(t)),null!=this.millis){var a=new n({int:this.millis});e=new i({obj:a,tag:"80",explicit:!1}),o.push(e)}if(null!=this.micros){var h=new n({int:this.micros});s=new i({obj:h,tag:"81",explicit:!1}),o.push(s)}var u=new r({array:o});return this.hTLV=u.getEncodedHex(),this.hTLV},void 0!==t&&("number"==typeof t.seconds&&(this.seconds=t.seconds),"number"==typeof t.millis&&(this.millis=t.millis),"number"==typeof t.micros&&(this.micros=t.micros))},ie.lang.extend(tn.asn1.tsp.Accuracy,tn.asn1.ASN1Object),tn.asn1.tsp.MessageImprint=function(t){var e=tn.asn1,n=e.DERSequence,r=e.DEROctetString,i=e.x509.AlgorithmIdentifier;e.tsp.MessageImprint.superclass.constructor.call(this),this.dHashAlg=null,this.dHashValue=null,this.getEncodedHex=function(){return"string"==typeof this.hTLV?this.hTLV:new n({array:[this.dHashAlg,this.dHashValue]}).getEncodedHex()},void 0!==t&&("string"==typeof t.hashAlg&&(this.dHashAlg=new i({name:t.hashAlg})),"string"==typeof t.hashValue&&(this.dHashValue=new r({hex:t.hashValue})))},ie.lang.extend(tn.asn1.tsp.MessageImprint,tn.asn1.ASN1Object),tn.asn1.tsp.TimeStampReq=function(t){var e=tn.asn1,n=e.DERSequence,r=e.DERInteger,i=e.DERBoolean,s=e.DERObjectIdentifier,o=e.tsp,a=o.MessageImprint;o.TimeStampReq.superclass.constructor.call(this),this.dVersion=new r({int:1}),this.dMessageImprint=null,this.dPolicy=null,this.dNonce=null,this.certReq=!0,this.setMessageImprint=function(t){t instanceof a?this.dMessageImprint=t:"object"==typeof t&&(this.dMessageImprint=new a(t))},this.getEncodedHex=function(){if(null==this.dMessageImprint)throw"messageImprint shall be specified";var t=[this.dVersion,this.dMessageImprint];null!=this.dPolicy&&t.push(this.dPolicy),null!=this.dNonce&&t.push(this.dNonce),this.certReq&&t.push(new i);var e=new n({array:t});return this.hTLV=e.getEncodedHex(),this.hTLV},void 0!==t&&("object"==typeof t.mi&&this.setMessageImprint(t.mi),"object"==typeof t.policy&&(this.dPolicy=new s(t.policy)),"object"==typeof t.nonce&&(this.dNonce=new r(t.nonce)),"boolean"==typeof t.certreq&&(this.certReq=t.certreq))},ie.lang.extend(tn.asn1.tsp.TimeStampReq,tn.asn1.ASN1Object),tn.asn1.tsp.TSTInfo=function(t){var e=tn.asn1,n=e.DERSequence,r=e.DERInteger,i=e.DERBoolean,s=e.DERGeneralizedTime,o=e.DERObjectIdentifier,a=e.tsp,h=a.MessageImprint,u=a.Accuracy,c=e.x509.X500Name;if(a.TSTInfo.superclass.constructor.call(this),this.dVersion=new r({int:1}),this.dPolicy=null,this.dMessageImprint=null,this.dSerialNumber=null,this.dGenTime=null,this.dAccuracy=null,this.dOrdering=null,this.dNonce=null,this.dTsa=null,this.getEncodedHex=function(){var t=[this.dVersion];if(null==this.dPolicy)throw"policy shall be specified.";if(t.push(this.dPolicy),null==this.dMessageImprint)throw"messageImprint shall be specified.";if(t.push(this.dMessageImprint),null==this.dSerialNumber)throw"serialNumber shall be specified.";if(t.push(this.dSerialNumber),null==this.dGenTime)throw"genTime shall be specified.";t.push(this.dGenTime),null!=this.dAccuracy&&t.push(this.dAccuracy),null!=this.dOrdering&&t.push(this.dOrdering),null!=this.dNonce&&t.push(this.dNonce),null!=this.dTsa&&t.push(this.dTsa);var e=new n({array:t});return this.hTLV=e.getEncodedHex(),this.hTLV},void 0!==t){if("string"==typeof t.policy){if(!t.policy.match(/^[0-9.]+$/))throw"policy shall be oid like 0.1.4.134";this.dPolicy=new o({oid:t.policy})}void 0!==t.messageImprint&&(this.dMessageImprint=new h(t.messageImprint)),void 0!==t.serialNumber&&(this.dSerialNumber=new r(t.serialNumber)),void 0!==t.genTime&&(this.dGenTime=new s(t.genTime)),void 0!==t.accuracy&&(this.dAccuracy=new u(t.accuracy)),void 0!==t.ordering&&1==t.ordering&&(this.dOrdering=new i),void 0!==t.nonce&&(this.dNonce=new r(t.nonce)),void 0!==t.tsa&&(this.dTsa=new c(t.tsa))}},ie.lang.extend(tn.asn1.tsp.TSTInfo,tn.asn1.ASN1Object),tn.asn1.tsp.TimeStampResp=function(t){var e=tn.asn1,n=e.DERSequence,r=e.ASN1Object,i=e.tsp,s=i.PKIStatusInfo;i.TimeStampResp.superclass.constructor.call(this),this.dStatus=null,this.dTST=null,this.getEncodedHex=function(){if(null==this.dStatus)throw"status shall be specified";var t=[this.dStatus];null!=this.dTST&&t.push(this.dTST);var e=new n({array:t});return this.hTLV=e.getEncodedHex(),this.hTLV},void 0!==t&&("object"==typeof t.status&&(this.dStatus=new s(t.status)),void 0!==t.tst&&t.tst instanceof r&&(this.dTST=t.tst.getContentInfo()))},ie.lang.extend(tn.asn1.tsp.TimeStampResp,tn.asn1.ASN1Object),tn.asn1.tsp.PKIStatusInfo=function(t){var e=tn.asn1,n=e.DERSequence,r=e.tsp,i=r.PKIStatus,s=r.PKIFreeText,o=r.PKIFailureInfo;r.PKIStatusInfo.superclass.constructor.call(this),this.dStatus=null,this.dStatusString=null,this.dFailureInfo=null,this.getEncodedHex=function(){if(null==this.dStatus)throw"status shall be specified";var t=[this.dStatus];null!=this.dStatusString&&t.push(this.dStatusString),null!=this.dFailureInfo&&t.push(this.dFailureInfo);var e=new n({array:t});return this.hTLV=e.getEncodedHex(),this.hTLV},void 0!==t&&("object"==typeof t.status&&(this.dStatus=new i(t.status)),"object"==typeof t.statstr&&(this.dStatusString=new s({array:t.statstr})),"object"==typeof t.failinfo&&(this.dFailureInfo=new o(t.failinfo)))},ie.lang.extend(tn.asn1.tsp.PKIStatusInfo,tn.asn1.ASN1Object),tn.asn1.tsp.PKIStatus=function(t){var e=tn.asn1,n=e.DERInteger,r=e.tsp,i=r.PKIStatus;if(r.PKIStatus.superclass.constructor.call(this),this.getEncodedHex=function(){return this.hTLV=this.dStatus.getEncodedHex(),this.hTLV},void 0!==t)if(void 0!==t.name){var s=i.valueList;if(void 0===s[t.name])throw"name undefined: "+t.name;this.dStatus=new n({int:s[t.name]})}else this.dStatus=new n(t)},ie.lang.extend(tn.asn1.tsp.PKIStatus,tn.asn1.ASN1Object),tn.asn1.tsp.PKIStatus.valueList={granted:0,grantedWithMods:1,rejection:2,waiting:3,revocationWarning:4,revocationNotification:5},tn.asn1.tsp.PKIFreeText=function(t){var e=tn.asn1,n=e.DERSequence,r=e.DERUTF8String;e.tsp.PKIFreeText.superclass.constructor.call(this),this.textList=[],this.getEncodedHex=function(){for(var t=[],e=0;e<this.textList.length;e++)t.push(new r({str:this.textList[e]}));var i=new n({array:t});return this.hTLV=i.getEncodedHex(),this.hTLV},void 0!==t&&"object"==typeof t.array&&(this.textList=t.array)},ie.lang.extend(tn.asn1.tsp.PKIFreeText,tn.asn1.ASN1Object),tn.asn1.tsp.PKIFailureInfo=function(t){var e=tn.asn1,n=e.DERBitString,r=e.tsp.PKIFailureInfo;if(r.superclass.constructor.call(this),this.value=null,this.getEncodedHex=function(){if(null==this.value)throw"value shall be specified";var t=new Number(this.value).toString(2),e=new n;return e.setByBinaryString(t),this.hTLV=e.getEncodedHex(),this.hTLV},void 0!==t)if("string"==typeof t.name){var i=r.valueList;if(void 0===i[t.name])throw"name undefined: "+t.name;this.value=i[t.name]}else"number"==typeof t.int&&(this.value=t.int)},ie.lang.extend(tn.asn1.tsp.PKIFailureInfo,tn.asn1.ASN1Object),tn.asn1.tsp.PKIFailureInfo.valueList={badAlg:0,badRequest:2,badDataFormat:5,timeNotAvailable:14,unacceptedPolicy:15,unacceptedExtension:16,addInfoNotAvailable:17,systemFailure:25},tn.asn1.tsp.AbstractTSAAdapter=function(t){this.getTSTHex=function(t,e){throw"not implemented yet"}},tn.asn1.tsp.SimpleTSAAdapter=function(t){var e=tn,n=e.asn1.tsp,r=e.crypto.Util.hashHex;n.SimpleTSAAdapter.superclass.constructor.call(this),this.params=null,this.serial=0,this.getTSTHex=function(t,e){var i=r(t,e);this.params.tstInfo.messageImprint={hashAlg:e,hashValue:i},this.params.tstInfo.serialNumber={int:this.serial++};var s=Math.floor(1e9*Math.random());return this.params.tstInfo.nonce={int:s},n.TSPUtil.newTimeStampToken(this.params).getContentInfoEncodedHex()},void 0!==t&&(this.params=t)},ie.lang.extend(tn.asn1.tsp.SimpleTSAAdapter,tn.asn1.tsp.AbstractTSAAdapter),tn.asn1.tsp.FixedTSAAdapter=function(t){var e=tn,n=e.asn1.tsp,r=e.crypto.Util.hashHex;n.FixedTSAAdapter.superclass.constructor.call(this),this.params=null,this.getTSTHex=function(t,e){var i=r(t,e);return this.params.tstInfo.messageImprint={hashAlg:e,hashValue:i},n.TSPUtil.newTimeStampToken(this.params).getContentInfoEncodedHex()},void 0!==t&&(this.params=t)},ie.lang.extend(tn.asn1.tsp.FixedTSAAdapter,tn.asn1.tsp.AbstractTSAAdapter),tn.asn1.tsp.TSPUtil=new function(){},tn.asn1.tsp.TSPUtil.newTimeStampToken=function(t){var e=tn.asn1,n=e.cms,r=(e.tsp,e.tsp.TSTInfo),i=new n.SignedData,s=new r(t.tstInfo).getEncodedHex();if(i.dEncapContentInfo.setContentValue({hex:s}),i.dEncapContentInfo.setContentType("tstinfo"),"object"==typeof t.certs)for(var o=0;o<t.certs.length;o++)i.addCertificatesByPEM(t.certs[o]);var a=i.signerInfoList[0];a.setSignerIdentifier(t.signerCert),a.setForContentAndHash({sdObj:i,eciObj:i.dEncapContentInfo,hashAlg:t.hashAlg});var h=new n.SigningCertificate({array:[t.signerCert]});return a.dSignedAttrs.add(h),a.sign(t.signerPrvKey,t.sigAlg),i},tn.asn1.tsp.TSPUtil.parseTimeStampReq=function(t){var e=rn,n=e.getChildIdx,r=e.getV,i=e.getTLV,s={certreq:!1},o=n(t,0);if(o.length<2)throw"TimeStampReq must have at least 2 items";var a=i(t,o[1]);s.mi=tn.asn1.tsp.TSPUtil.parseMessageImprint(a);for(var h=2;h<o.length;h++){var u=o[h],c=t.substr(u,2);if("06"==c){var f=r(t,u);s.policy=e.hextooidstr(f)}"02"==c&&(s.nonce=r(t,u)),"01"==c&&(s.certreq=!0)}return s},tn.asn1.tsp.TSPUtil.parseMessageImprint=function(t){var e=rn,n=e.getChildIdx,r=e.getV,i=e.getIdxbyList,s={};if("30"!=t.substr(0,2))throw"head of messageImprint hex shall be '30'";n(t,0);var o=r(t,i(t,0,[0,0])),a=e.hextooidstr(o),h=tn.asn1.x509.OID.oid2name(a);if(""==h)throw"hashAlg name undefined: "+a;var u=h,c=i(t,0,[1]);return s.hashAlg=u,s.hashValue=r(t,c),s},void 0!==tn&&tn||(tn={}),void 0!==tn.asn1&&tn.asn1||(tn.asn1={}),void 0!==tn.asn1.cades&&tn.asn1.cades||(tn.asn1.cades={}),tn.asn1.cades.SignaturePolicyIdentifier=function(t){var e=tn.asn1,n=e.DERObjectIdentifier,r=e.DERSequence,i=e.cades,s=i.OtherHashAlgAndValue;if(i.SignaturePolicyIdentifier.superclass.constructor.call(this),this.attrTypeOid="1.2.840.113549.1.9.16.2.15",void 0!==t&&"string"==typeof t.oid&&"object"==typeof t.hash){var o=new r({array:[new n({oid:t.oid}),new s(t.hash)]});this.valueList=[o]}},ie.lang.extend(tn.asn1.cades.SignaturePolicyIdentifier,tn.asn1.cms.Attribute),tn.asn1.cades.OtherHashAlgAndValue=function(t){var e=tn.asn1,n=e.DERSequence,r=e.DEROctetString,i=e.x509.AlgorithmIdentifier;e.cades.OtherHashAlgAndValue.superclass.constructor.call(this),this.dAlg=null,this.dHash=null,this.getEncodedHex=function(){var t=new n({array:[this.dAlg,this.dHash]});return this.hTLV=t.getEncodedHex(),this.hTLV},void 0!==t&&"string"==typeof t.alg&&"string"==typeof t.hash&&(this.dAlg=new i({name:t.alg}),this.dHash=new r({hex:t.hash}))},ie.lang.extend(tn.asn1.cades.OtherHashAlgAndValue,tn.asn1.ASN1Object),tn.asn1.cades.SignatureTimeStamp=function(t){var e=tn.asn1,n=e.ASN1Object;e.x509;if(e.cades.SignatureTimeStamp.superclass.constructor.call(this),this.attrTypeOid="1.2.840.113549.1.9.16.2.14",this.tstHex=null,void 0!==t){if(void 0!==t.res)if("string"==typeof t.res&&t.res.match(/^[0-9A-Fa-f]+$/));else if(!(t.res instanceof n))throw"res param shall be ASN1Object or hex string";if(void 0!==t.tst)if("string"==typeof t.tst&&t.tst.match(/^[0-9A-Fa-f]+$/)){var r=new n;this.tstHex=t.tst,r.hTLV=this.tstHex,r.getEncodedHex(),this.valueList=[r]}else if(!(t.tst instanceof n))throw"tst param shall be ASN1Object or hex string"}},ie.lang.extend(tn.asn1.cades.SignatureTimeStamp,tn.asn1.cms.Attribute),tn.asn1.cades.CompleteCertificateRefs=function(t){var e=tn.asn1.cades;e.CompleteCertificateRefs.superclass.constructor.call(this),this.attrTypeOid="1.2.840.113549.1.9.16.2.21",this.setByArray=function(t){this.valueList=[];for(var n=0;n<t.length;n++){var r=new e.OtherCertID(t[n]);this.valueList.push(r)}},void 0!==t&&"object"==typeof t&&"number"==typeof t.length&&this.setByArray(t)},ie.lang.extend(tn.asn1.cades.CompleteCertificateRefs,tn.asn1.cms.Attribute),tn.asn1.cades.OtherCertID=function(t){var e=tn.asn1,n=e.cms,r=e.cades;r.OtherCertID.superclass.constructor.call(this),this.hasIssuerSerial=!0,this.dOtherCertHash=null,this.dIssuerSerial=null,this.setByCertPEM=function(t){this.dOtherCertHash=new r.OtherHash(t),this.hasIssuerSerial&&(this.dIssuerSerial=new n.IssuerAndSerialNumber(t))},this.getEncodedHex=function(){if(null!=this.hTLV)return this.hTLV;if(null==this.dOtherCertHash)throw"otherCertHash not set";var t=[this.dOtherCertHash];null!=this.dIssuerSerial&&t.push(this.dIssuerSerial);var n=new e.DERSequence({array:t});return this.hTLV=n.getEncodedHex(),this.hTLV},void 0!==t&&("string"==typeof t&&-1!=t.indexOf("-----BEGIN ")&&this.setByCertPEM(t),"object"==typeof t&&(!1===t.hasis&&(this.hasIssuerSerial=!1),"string"==typeof t.cert&&this.setByCertPEM(t.cert)))},ie.lang.extend(tn.asn1.cades.OtherCertID,tn.asn1.ASN1Object),tn.asn1.cades.OtherHash=function(t){var e=tn,n=e.asn1,r=(n.cms,n.cades),i=r.OtherHashAlgAndValue,s=e.crypto.Util.hashHex;if(r.OtherHash.superclass.constructor.call(this),this.alg="sha256",this.dOtherHash=null,this.setByCertPEM=function(t){if(-1==t.indexOf("-----BEGIN "))throw"certPEM not to seem PEM format";var e=vn(t),n=s(e,this.alg);this.dOtherHash=new i({alg:this.alg,hash:n})},this.getEncodedHex=function(){if(null==this.dOtherHash)throw"OtherHash not set";return this.dOtherHash.getEncodedHex()},void 0!==t)if("string"==typeof t)if(-1!=t.indexOf("-----BEGIN "))this.setByCertPEM(t);else{if(!t.match(/^[0-9A-Fa-f]+$/))throw"unsupported string value for params";this.dOtherHash=new n.DEROctetString({hex:t})}else"object"==typeof t&&("string"==typeof t.cert?("string"==typeof t.alg&&(this.alg=t.alg),this.setByCertPEM(t.cert)):this.dOtherHash=new i(t))},ie.lang.extend(tn.asn1.cades.OtherHash,tn.asn1.ASN1Object),tn.asn1.cades.CAdESUtil=new function(){},tn.asn1.cades.CAdESUtil.addSigTS=function(t,e,n){},tn.asn1.cades.CAdESUtil.parseSignedDataForAddingUnsigned=function(t){var e=rn,n=e.getChildIdx,r=e.getTLV,i=e.getTLVbyList,s=e.getIdxbyList,o=tn.asn1,a=o.ASN1Object,h=o.cms.SignedData,u=o.cades.CAdESUtil,c={};if("06092a864886f70d010702"!=i(t,0,[0]))throw"hex is not CMS SignedData";var f=n(t,s(t,0,[1,0]));if(f.length<4)throw"num of SignedData elem shall be 4 at least";var l=f.shift();c.version=r(t,l);var d=f.shift();c.algs=r(t,d);var p=f.shift();c.encapcontent=r(t,p),c.certs=null,c.revs=null,c.si=[];var g=f.shift();"a0"==t.substr(g,2)&&(c.certs=r(t,g),g=f.shift()),"a1"==t.substr(g,2)&&(c.revs=r(t,g),g=f.shift());var y=g;if("31"!=t.substr(y,2))throw"Can't find signerInfos";for(var v=n(t,y),m=0;m<v.length;m++){var w=v[m],b=u.parseSignerInfoForAddingUnsigned(t,w,m);c.si[m]=b}var S=null;c.obj=new h,(S=new a).hTLV=c.version,c.obj.dCMSVersion=S,(S=new a).hTLV=c.algs,c.obj.dDigestAlgs=S,(S=new a).hTLV=c.encapcontent,c.obj.dEncapContentInfo=S,(S=new a).hTLV=c.certs,c.obj.dCerts=S,c.obj.signerInfoList=[];for(m=0;m<c.si.length;m++)c.obj.signerInfoList.push(c.si[m].obj);return c},tn.asn1.cades.CAdESUtil.parseSignerInfoForAddingUnsigned=function(t,e,n){var r=rn,i=r.getChildIdx,s=r.getTLV,o=r.getV,a=tn.asn1,h=a.ASN1Object,u=a.cms,c=u.AttributeList,f=u.SignerInfo,l={},d=i(t,e);if(6!=d.length)throw"not supported items for SignerInfo (!=6)";var p=d.shift();l.version=s(t,p);var g=d.shift();l.si=s(t,g);var y=d.shift();l.digalg=s(t,y);var v=d.shift();l.sattrs=s(t,v);var m=d.shift();l.sigalg=s(t,m);var w=d.shift();l.sig=s(t,w),l.sigval=o(t,w);var b=null;return l.obj=new f,(b=new h).hTLV=l.version,l.obj.dCMSVersion=b,(b=new h).hTLV=l.si,l.obj.dSignerIdentifier=b,(b=new h).hTLV=l.digalg,l.obj.dDigestAlgorithm=b,(b=new h).hTLV=l.sattrs,l.obj.dSignedAttrs=b,(b=new h).hTLV=l.sigalg,l.obj.dSigAlg=b,(b=new h).hTLV=l.sig,l.obj.dSig=b,l.obj.dUnsignedAttrs=new c,l},void 0!==tn.asn1.csr&&tn.asn1.csr||(tn.asn1.csr={}),tn.asn1.csr.CertificationRequest=function(t){var e=tn,n=e.asn1,r=n.DERBitString,i=n.DERSequence,s=n.csr,o=n.x509;s.CertificationRequest.superclass.constructor.call(this),this.sign=function(t,n){null==this.prvKey&&(this.prvKey=n),this.asn1SignatureAlg=new o.AlgorithmIdentifier({name:t}),sig=new e.crypto.Signature({alg:t}),sig.init(this.prvKey),sig.updateHex(this.asn1CSRInfo.getEncodedHex()),this.hexSig=sig.sign(),this.asn1Sig=new r({hex:"00"+this.hexSig});var s=new i({array:[this.asn1CSRInfo,this.asn1SignatureAlg,this.asn1Sig]});this.hTLV=s.getEncodedHex(),this.isModified=!1},this.getPEMString=function(){return yn(this.getEncodedHex(),"CERTIFICATE REQUEST")},this.getEncodedHex=function(){if(0==this.isModified&&null!=this.hTLV)return this.hTLV;throw"not signed yet"},void 0!==t&&void 0!==t.csrinfo&&(this.asn1CSRInfo=t.csrinfo)},ie.lang.extend(tn.asn1.csr.CertificationRequest,tn.asn1.ASN1Object),tn.asn1.csr.CertificationRequestInfo=function(t){var e=tn.asn1,n=e.DERInteger,r=e.DERSequence,i=e.DERSet,s=e.DERNull,o=e.DERTaggedObject,a=e.DERObjectIdentifier,h=e.csr,u=e.x509,c=u.X500Name,f=u.Extension,l=Fn;h.CertificationRequestInfo.superclass.constructor.call(this),this._initialize=function(){this.asn1Array=new Array,this.asn1Version=new n({int:0}),this.asn1Subject=null,this.asn1SubjPKey=null,this.extensionsArray=new Array},this.setSubjectByParam=function(t){this.asn1Subject=new c(t)},this.setSubjectPublicKeyByGetKey=function(t){var e=l.getKey(t);this.asn1SubjPKey=new u.SubjectPublicKeyInfo(e)},this.appendExtensionByName=function(t,e){f.appendByNameToArray(t,e,this.extensionsArray)},this.getEncodedHex=function(){if(this.asn1Array=new Array,this.asn1Array.push(this.asn1Version),this.asn1Array.push(this.asn1Subject),this.asn1Array.push(this.asn1SubjPKey),this.extensionsArray.length>0){var t=new r({array:this.extensionsArray}),e=new i({array:[t]}),n=new r({array:[new a({oid:"1.2.840.113549.1.9.14"}),e]}),h=new o({explicit:!0,tag:"a0",obj:n});this.asn1Array.push(h)}else{h=new o({explicit:!1,tag:"a0",obj:new s});this.asn1Array.push(h)}var u=new r({array:this.asn1Array});return this.hTLV=u.getEncodedHex(),this.isModified=!1,this.hTLV},this._initialize()},ie.lang.extend(tn.asn1.csr.CertificationRequestInfo,tn.asn1.ASN1Object),tn.asn1.csr.CSRUtil=new function(){},tn.asn1.csr.CSRUtil.newCSRPEM=function(t){var e=Fn,n=tn.asn1.csr;if(void 0===t.subject)throw"parameter subject undefined";if(void 0===t.sbjpubkey)throw"parameter sbjpubkey undefined";if(void 0===t.sigalg)throw"parameter sigalg undefined";if(void 0===t.sbjprvkey)throw"parameter sbjpubkey undefined";var r=new n.CertificationRequestInfo;if(r.setSubjectByParam(t.subject),r.setSubjectPublicKeyByGetKey(t.sbjpubkey),void 0!==t.ext&&void 0!==t.ext.length)for(var i=0;i<t.ext.length;i++)for(key in t.ext[i])r.appendExtensionByName(key,t.ext[i][key]);var s=new n.CertificationRequest({csrinfo:r}),o=e.getKey(t.sbjprvkey);return s.sign(t.sigalg,o),s.getPEMString()},tn.asn1.csr.CSRUtil.getInfo=function(t){var e=rn.getTLVbyList,n={subject:{},pubkey:{}};if(-1==t.indexOf("-----BEGIN CERTIFICATE REQUEST"))throw"argument is not PEM file";var r=vn(t,"CERTIFICATE REQUEST");return n.subject.hex=e(r,0,[0,1]),n.subject.name=Dn.hex2dn(n.subject.hex),n.pubkey.hex=e(r,0,[0,2]),n.pubkey.obj=Fn.getKey(n.pubkey.hex,null,"pkcs8pub"),n},void 0!==tn&&tn||(tn={}),void 0!==tn.asn1&&tn.asn1||(tn.asn1={}),void 0!==tn.asn1.ocsp&&tn.asn1.ocsp||(tn.asn1.ocsp={}),tn.asn1.ocsp.DEFAULT_HASH="sha1",tn.asn1.ocsp.CertID=function(t){var e=tn,n=e.asn1,r=n.DEROctetString,i=n.DERInteger,s=n.DERSequence,o=n.x509.AlgorithmIdentifier,a=n.ocsp,h=a.DEFAULT_HASH,u=e.crypto.Util.hashHex,c=Dn,f=rn;if(a.CertID.superclass.constructor.call(this),this.dHashAlg=null,this.dIssuerNameHash=null,this.dIssuerKeyHash=null,this.dSerialNumber=null,this.setByValue=function(t,e,n,s){void 0===s&&(s=h),this.dHashAlg=new o({name:s}),this.dIssuerNameHash=new r({hex:t}),this.dIssuerKeyHash=new r({hex:e}),this.dSerialNumber=new i({hex:n})},this.setByCert=function(t,e,n){void 0===n&&(n=h);var r=new c;r.readCertPEM(e);var i=new c;i.readCertPEM(t);var s=i.getPublicKeyHex(),o=f.getTLVbyList(s,0,[1,0],"30"),a=r.getSerialNumberHex(),l=u(i.getSubjectHex(),n),d=u(o,n);this.setByValue(l,d,a,n),this.hoge=r.getSerialNumberHex()},this.getEncodedHex=function(){if(null===this.dHashAlg&&null===this.dIssuerNameHash&&null===this.dIssuerKeyHash&&null===this.dSerialNumber)throw"not yet set values";var t=[this.dHashAlg,this.dIssuerNameHash,this.dIssuerKeyHash,this.dSerialNumber],e=new s({array:t});return this.hTLV=e.getEncodedHex(),this.hTLV},void 0!==t){var l=t;if(void 0!==l.issuerCert&&void 0!==l.subjectCert){var d=h;void 0===l.alg&&(d=void 0),this.setByCert(l.issuerCert,l.subjectCert,d)}else{if(void 0===l.namehash||void 0===l.keyhash||void 0===l.serial)throw"invalid constructor arguments";d=h;void 0===l.alg&&(d=void 0),this.setByValue(l.namehash,l.keyhash,l.serial,d)}}},ie.lang.extend(tn.asn1.ocsp.CertID,tn.asn1.ASN1Object),tn.asn1.ocsp.Request=function(t){var e=tn.asn1,n=e.DERSequence,r=e.ocsp;if(r.Request.superclass.constructor.call(this),this.dReqCert=null,this.dExt=null,this.getEncodedHex=function(){var t=[];if(null===this.dReqCert)throw"reqCert not set";t.push(this.dReqCert);var e=new n({array:t});return this.hTLV=e.getEncodedHex(),this.hTLV},void 0!==t){var i=new r.CertID(t);this.dReqCert=i}},ie.lang.extend(tn.asn1.ocsp.Request,tn.asn1.ASN1Object),tn.asn1.ocsp.TBSRequest=function(t){var e=tn.asn1,n=e.DERSequence,r=e.ocsp;r.TBSRequest.superclass.constructor.call(this),this.version=0,this.dRequestorName=null,this.dRequestList=[],this.dRequestExt=null,this.setRequestListByParam=function(t){for(var e=[],n=0;n<t.length;n++){var i=new r.Request(t[0]);e.push(i)}this.dRequestList=e},this.getEncodedHex=function(){var t=[];if(0!==this.version)throw"not supported version: "+this.version;if(null!==this.dRequestorName)throw"requestorName not supported";var e=new n({array:this.dRequestList});if(t.push(e),null!==this.dRequestExt)throw"requestExtensions not supported";var r=new n({array:t});return this.hTLV=r.getEncodedHex(),this.hTLV},void 0!==t&&void 0!==t.reqList&&this.setRequestListByParam(t.reqList)},ie.lang.extend(tn.asn1.ocsp.TBSRequest,tn.asn1.ASN1Object),tn.asn1.ocsp.OCSPRequest=function(t){var e=tn.asn1,n=e.DERSequence,r=e.ocsp;if(r.OCSPRequest.superclass.constructor.call(this),this.dTbsRequest=null,this.dOptionalSignature=null,this.getEncodedHex=function(){var t=[];if(null===this.dTbsRequest)throw"tbsRequest not set";if(t.push(this.dTbsRequest),null!==this.dOptionalSignature)throw"optionalSignature not supported";var e=new n({array:t});return this.hTLV=e.getEncodedHex(),this.hTLV},void 0!==t&&void 0!==t.reqList){var i=new r.TBSRequest(t);this.dTbsRequest=i}},ie.lang.extend(tn.asn1.ocsp.OCSPRequest,tn.asn1.ASN1Object),tn.asn1.ocsp.OCSPUtil={},tn.asn1.ocsp.OCSPUtil.getRequestHex=function(t,e,n){var r=tn.asn1.ocsp;void 0===n&&(n=r.DEFAULT_HASH);var i={alg:n,issuerCert:t,subjectCert:e};return new r.OCSPRequest({reqList:[i]}).getEncodedHex()},tn.asn1.ocsp.OCSPUtil.getOCSPResponseInfo=function(t){var e=rn,n=e.getVbyList,r=e.getIdxbyList,i=(n=e.getVbyList,e.getV),s={};try{var o=n(t,0,[0],"0a");s.responseStatus=parseInt(o,16)}catch(t){}if(0!==s.responseStatus)return s;try{var a=r(t,0,[1,0,1,0,0,2,0,1]);"80"===t.substr(a,2)?s.certStatus="good":"a1"===t.substr(a,2)?(s.certStatus="revoked",s.revocationTime=ln(n(t,a,[0]))):"82"===t.substr(a,2)&&(s.certStatus="unknown")}catch(t){}try{var h=r(t,0,[1,0,1,0,0,2,0,2]);s.thisUpdate=ln(i(t,h))}catch(t){}try{var u=r(t,0,[1,0,1,0,0,2,0,3]);"a0"===t.substr(u,2)&&(s.nextUpdate=ln(n(t,u,[0])))}catch(t){}return s},void 0!==tn&&tn||(tn={}),void 0!==tn.lang&&tn.lang||(tn.lang={}),tn.lang.String=function(){},en=function(t){return an(new mt(t,"utf8").toString("base64"))},nn=function(t){return new mt(hn(t),"base64").toString("utf8")},tn.lang.String.isInteger=function(t){return!!t.match(/^[0-9]+$/)||!!t.match(/^-[0-9]+$/)},tn.lang.String.isHex=function(t){return!(t.length%2!=0||!t.match(/^[0-9a-f]+$/)&&!t.match(/^[0-9A-F]+$/))},tn.lang.String.isBase64=function(t){return!(!(t=t.replace(/\s+/g,"")).match(/^[0-9A-Za-z+\/]+={0,3}$/)||t.length%4!=0)},tn.lang.String.isBase64URL=function(t){return!t.match(/[+\/=]/)&&(t=hn(t),tn.lang.String.isBase64(t))},tn.lang.String.isIntegerArray=function(t){return!!(t=t.replace(/\s+/g,"")).match(/^\[[0-9,]+\]$/)},void 0!==tn&&tn||(tn={}),void 0!==tn.crypto&&tn.crypto||(tn.crypto={}),tn.crypto.Util=new function(){this.DIGESTINFOHEAD={sha1:"3021300906052b0e03021a05000414",sha224:"302d300d06096086480165030402040500041c",sha256:"3031300d060960864801650304020105000420",sha384:"3041300d060960864801650304020205000430",sha512:"3051300d060960864801650304020305000440",md2:"3020300c06082a864886f70d020205000410",md5:"3020300c06082a864886f70d020505000410",ripemd160:"3021300906052b2403020105000414"},this.DEFAULTPROVIDER={md5:"cryptojs",sha1:"cryptojs",sha224:"cryptojs",sha256:"cryptojs",sha384:"cryptojs",sha512:"cryptojs",ripemd160:"cryptojs",hmacmd5:"cryptojs",hmacsha1:"cryptojs",hmacsha224:"cryptojs",hmacsha256:"cryptojs",hmacsha384:"cryptojs",hmacsha512:"cryptojs",hmacripemd160:"cryptojs",MD5withRSA:"cryptojs/jsrsa",SHA1withRSA:"cryptojs/jsrsa",SHA224withRSA:"cryptojs/jsrsa",SHA256withRSA:"cryptojs/jsrsa",SHA384withRSA:"cryptojs/jsrsa",SHA512withRSA:"cryptojs/jsrsa",RIPEMD160withRSA:"cryptojs/jsrsa",MD5withECDSA:"cryptojs/jsrsa",SHA1withECDSA:"cryptojs/jsrsa",SHA224withECDSA:"cryptojs/jsrsa",SHA256withECDSA:"cryptojs/jsrsa",SHA384withECDSA:"cryptojs/jsrsa",SHA512withECDSA:"cryptojs/jsrsa",RIPEMD160withECDSA:"cryptojs/jsrsa",SHA1withDSA:"cryptojs/jsrsa",SHA224withDSA:"cryptojs/jsrsa",SHA256withDSA:"cryptojs/jsrsa",MD5withRSAandMGF1:"cryptojs/jsrsa",SHA1withRSAandMGF1:"cryptojs/jsrsa",SHA224withRSAandMGF1:"cryptojs/jsrsa",SHA256withRSAandMGF1:"cryptojs/jsrsa",SHA384withRSAandMGF1:"cryptojs/jsrsa",SHA512withRSAandMGF1:"cryptojs/jsrsa",RIPEMD160withRSAandMGF1:"cryptojs/jsrsa"},this.CRYPTOJSMESSAGEDIGESTNAME={md5:ue.algo.MD5,sha1:ue.algo.SHA1,sha224:ue.algo.SHA224,sha256:ue.algo.SHA256,sha384:ue.algo.SHA384,sha512:ue.algo.SHA512,ripemd160:ue.algo.RIPEMD160},this.getDigestInfoHex=function(t,e){if(void 0===this.DIGESTINFOHEAD[e])throw"alg not supported in Util.DIGESTINFOHEAD: "+e;return this.DIGESTINFOHEAD[e]+t},this.getPaddedDigestInfoHex=function(t,e,n){var r=this.getDigestInfoHex(t,e),i=n/4;if(r.length+22>i)throw"key is too short for SigAlg: keylen="+n+","+e;for(var s="0001",o="00"+r,a="",h=i-s.length-o.length,u=0;u<h;u+=2)a+="ff";return s+a+o},this.hashString=function(t,e){return new tn.crypto.MessageDigest({alg:e}).digestString(t)},this.hashHex=function(t,e){return new tn.crypto.MessageDigest({alg:e}).digestHex(t)},this.sha1=function(t){return new tn.crypto.MessageDigest({alg:"sha1",prov:"cryptojs"}).digestString(t)},this.sha256=function(t){return new tn.crypto.MessageDigest({alg:"sha256",prov:"cryptojs"}).digestString(t)},this.sha256Hex=function(t){return new tn.crypto.MessageDigest({alg:"sha256",prov:"cryptojs"}).digestHex(t)},this.sha512=function(t){return new tn.crypto.MessageDigest({alg:"sha512",prov:"cryptojs"}).digestString(t)},this.sha512Hex=function(t){return new tn.crypto.MessageDigest({alg:"sha512",prov:"cryptojs"}).digestHex(t)}},tn.crypto.Util.md5=function(t){return new tn.crypto.MessageDigest({alg:"md5",prov:"cryptojs"}).digestString(t)},tn.crypto.Util.ripemd160=function(t){return new tn.crypto.MessageDigest({alg:"ripemd160",prov:"cryptojs"}).digestString(t)},tn.crypto.Util.SECURERANDOMGEN=new ze,tn.crypto.Util.getRandomHexOfNbytes=function(t){var e=new Array(t);return tn.crypto.Util.SECURERANDOMGEN.nextBytes(e),sn(e)},tn.crypto.Util.getRandomBigIntegerOfNbytes=function(t){return new pe(tn.crypto.Util.getRandomHexOfNbytes(t),16)},tn.crypto.Util.getRandomHexOfNbits=function(t){var e=t%8,n=new Array((t-e)/8+1);return tn.crypto.Util.SECURERANDOMGEN.nextBytes(n),n[0]=(255<<e&255^255)&n[0],sn(n)},tn.crypto.Util.getRandomBigIntegerOfNbits=function(t){return new pe(tn.crypto.Util.getRandomHexOfNbits(t),16)},tn.crypto.Util.getRandomBigIntegerZeroToMax=function(t){for(var e=t.bitLength();;){var n=tn.crypto.Util.getRandomBigIntegerOfNbits(e);if(-1!=t.compareTo(n))return n}},tn.crypto.Util.getRandomBigIntegerMinToMax=function(t,e){var n=t.compareTo(e);if(1==n)throw"biMin is greater than biMax";if(0==n)return t;var r=e.subtract(t);return tn.crypto.Util.getRandomBigIntegerZeroToMax(r).add(t)},tn.crypto.MessageDigest=function(t){this.setAlgAndProvider=function(t,e){if(null!==(t=tn.crypto.MessageDigest.getCanonicalAlgName(t))&&void 0===e&&(e=tn.crypto.Util.DEFAULTPROVIDER[t]),-1!=":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(t)&&"cryptojs"==e){try{this.md=tn.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[t].create()}catch(e){throw"setAlgAndProvider hash alg set fail alg="+t+"/"+e}this.updateString=function(t){this.md.update(t)},this.updateHex=function(t){var e=ue.enc.Hex.parse(t);this.md.update(e)},this.digest=function(){return this.md.finalize().toString(ue.enc.Hex)},this.digestString=function(t){return this.updateString(t),this.digest()},this.digestHex=function(t){return this.updateHex(t),this.digest()}}if(-1!=":sha256:".indexOf(t)&&"sjcl"==e){try{this.md=new sjcl.hash.sha256}catch(e){throw"setAlgAndProvider hash alg set fail alg="+t+"/"+e}this.updateString=function(t){this.md.update(t)},this.updateHex=function(t){var e=sjcl.codec.hex.toBits(t);this.md.update(e)},this.digest=function(){var t=this.md.finalize();return sjcl.codec.hex.fromBits(t)},this.digestString=function(t){return this.updateString(t),this.digest()},this.digestHex=function(t){return this.updateHex(t),this.digest()}}},this.updateString=function(t){throw"updateString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.updateHex=function(t){throw"updateHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digest=function(){throw"digest() not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digestString=function(t){throw"digestString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digestHex=function(t){throw"digestHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName},void 0!==t&&void 0!==t.alg&&(this.algName=t.alg,void 0===t.prov&&(this.provName=tn.crypto.Util.DEFAULTPROVIDER[this.algName]),this.setAlgAndProvider(this.algName,this.provName))},tn.crypto.MessageDigest.getCanonicalAlgName=function(t){return"string"==typeof t&&(t=(t=t.toLowerCase()).replace(/-/,"")),t},tn.crypto.MessageDigest.getHashLength=function(t){var e=tn.crypto.MessageDigest,n=e.getCanonicalAlgName(t);if(void 0===e.HASHLENGTH[n])throw"not supported algorithm: "+t;return e.HASHLENGTH[n]},tn.crypto.MessageDigest.HASHLENGTH={md5:16,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64,ripemd160:20},tn.crypto.Mac=function(t){this.setAlgAndProvider=function(t,e){if(null==(t=t.toLowerCase())&&(t="hmacsha1"),"hmac"!=(t=t.toLowerCase()).substr(0,4))throw"setAlgAndProvider unsupported HMAC alg: "+t;void 0===e&&(e=tn.crypto.Util.DEFAULTPROVIDER[t]),this.algProv=t+"/"+e;var n=t.substr(4);if(-1!=":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(n)&&"cryptojs"==e){try{var r=tn.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[n];this.mac=ue.algo.HMAC.create(r,this.pass)}catch(t){throw"setAlgAndProvider hash alg set fail hashAlg="+n+"/"+t}this.updateString=function(t){this.mac.update(t)},this.updateHex=function(t){var e=ue.enc.Hex.parse(t);this.mac.update(e)},this.doFinal=function(){return this.mac.finalize().toString(ue.enc.Hex)},this.doFinalString=function(t){return this.updateString(t),this.doFinal()},this.doFinalHex=function(t){return this.updateHex(t),this.doFinal()}}},this.updateString=function(t){throw"updateString(str) not supported for this alg/prov: "+this.algProv},this.updateHex=function(t){throw"updateHex(hex) not supported for this alg/prov: "+this.algProv},this.doFinal=function(){throw"digest() not supported for this alg/prov: "+this.algProv},this.doFinalString=function(t){throw"digestString(str) not supported for this alg/prov: "+this.algProv},this.doFinalHex=function(t){throw"digestHex(hex) not supported for this alg/prov: "+this.algProv},this.setPassword=function(t){if("string"==typeof t){var e=t;return t.length%2!=1&&t.match(/^[0-9A-Fa-f]+$/)||(e=pn(t)),void(this.pass=ue.enc.Hex.parse(e))}if("object"!=typeof t)throw"KJUR.crypto.Mac unsupported password type: "+t;e=null;if(void 0!==t.hex){if(t.hex.length%2!=0||!t.hex.match(/^[0-9A-Fa-f]+$/))throw"Mac: wrong hex password: "+t.hex;e=t.hex}if(void 0!==t.utf8&&(e=fn(t.utf8)),void 0!==t.rstr&&(e=pn(t.rstr)),void 0!==t.b64&&(e=de(t.b64)),void 0!==t.b64u&&(e=cn(t.b64u)),null==e)throw"KJUR.crypto.Mac unsupported password type: "+t;this.pass=ue.enc.Hex.parse(e)},void 0!==t&&(void 0!==t.pass&&this.setPassword(t.pass),void 0!==t.alg&&(this.algName=t.alg,void 0===t.prov&&(this.provName=tn.crypto.Util.DEFAULTPROVIDER[this.algName]),this.setAlgAndProvider(this.algName,this.provName)))},tn.crypto.Signature=function(t){var e=null;if(this._setAlgNames=function(){var t=this.algName.match(/^(.+)with(.+)$/);t&&(this.mdAlgName=t[1].toLowerCase(),this.pubkeyAlgName=t[2].toLowerCase())},this._zeroPaddingOfSignature=function(t,e){for(var n="",r=e/4-t.length,i=0;i<r;i++)n+="0";return n+t},this.setAlgAndProvider=function(t,e){if(this._setAlgNames(),"cryptojs/jsrsa"!=e)throw"provider not supported: "+e;if(-1!=":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(this.mdAlgName)){try{this.md=new tn.crypto.MessageDigest({alg:this.mdAlgName})}catch(t){throw"setAlgAndProvider hash alg set fail alg="+this.mdAlgName+"/"+t}this.init=function(t,e){var n=null;try{n=void 0===e?Fn.getKey(t):Fn.getKey(t,e)}catch(t){throw"init failed:"+t}if(!0===n.isPrivate)this.prvKey=n,this.state="SIGN";else{if(!0!==n.isPublic)throw"init failed.:"+n;this.pubKey=n,this.state="VERIFY"}},this.updateString=function(t){this.md.updateString(t)},this.updateHex=function(t){this.md.updateHex(t)},this.sign=function(){if(this.sHashHex=this.md.digest(),void 0!==this.ecprvhex&&void 0!==this.eccurvename){var t=new tn.crypto.ECDSA({curve:this.eccurvename});this.hSign=t.signHex(this.sHashHex,this.ecprvhex)}else if(this.prvKey instanceof Ge&&"rsaandmgf1"===this.pubkeyAlgName)this.hSign=this.prvKey.signWithMessageHashPSS(this.sHashHex,this.mdAlgName,this.pssSaltLen);else if(this.prvKey instanceof Ge&&"rsa"===this.pubkeyAlgName)this.hSign=this.prvKey.signWithMessageHash(this.sHashHex,this.mdAlgName);else if(this.prvKey instanceof tn.crypto.ECDSA)this.hSign=this.prvKey.signWithMessageHash(this.sHashHex);else{if(!(this.prvKey instanceof tn.crypto.DSA))throw"Signature: unsupported private key alg: "+this.pubkeyAlgName;this.hSign=this.prvKey.signWithMessageHash(this.sHashHex)}return this.hSign},this.signString=function(t){return this.updateString(t),this.sign()},this.signHex=function(t){return this.updateHex(t),this.sign()},this.verify=function(t){if(this.sHashHex=this.md.digest(),void 0!==this.ecpubhex&&void 0!==this.eccurvename)return new tn.crypto.ECDSA({curve:this.eccurvename}).verifyHex(this.sHashHex,t,this.ecpubhex);if(this.pubKey instanceof Ge&&"rsaandmgf1"===this.pubkeyAlgName)return this.pubKey.verifyWithMessageHashPSS(this.sHashHex,t,this.mdAlgName,this.pssSaltLen);if(this.pubKey instanceof Ge&&"rsa"===this.pubkeyAlgName)return this.pubKey.verifyWithMessageHash(this.sHashHex,t);if(void 0!==tn.crypto.ECDSA&&this.pubKey instanceof tn.crypto.ECDSA)return this.pubKey.verifyWithMessageHash(this.sHashHex,t);if(void 0!==tn.crypto.DSA&&this.pubKey instanceof tn.crypto.DSA)return this.pubKey.verifyWithMessageHash(this.sHashHex,t);throw"Signature: unsupported public key alg: "+this.pubkeyAlgName}}},this.init=function(t,e){throw"init(key, pass) not supported for this alg:prov="+this.algProvName},this.updateString=function(t){throw"updateString(str) not supported for this alg:prov="+this.algProvName},this.updateHex=function(t){throw"updateHex(hex) not supported for this alg:prov="+this.algProvName},this.sign=function(){throw"sign() not supported for this alg:prov="+this.algProvName},this.signString=function(t){throw"digestString(str) not supported for this alg:prov="+this.algProvName},this.signHex=function(t){throw"digestHex(hex) not supported for this alg:prov="+this.algProvName},this.verify=function(t){throw"verify(hSigVal) not supported for this alg:prov="+this.algProvName},this.initParams=t,void 0!==t&&(void 0!==t.alg&&(this.algName=t.alg,void 0===t.prov?this.provName=tn.crypto.Util.DEFAULTPROVIDER[this.algName]:this.provName=t.prov,this.algProvName=this.algName+":"+this.provName,this.setAlgAndProvider(this.algName,this.provName),this._setAlgNames()),void 0!==t.psssaltlen&&(this.pssSaltLen=t.psssaltlen),void 0!==t.prvkeypem)){if(void 0!==t.prvkeypas)throw"both prvkeypem and prvkeypas parameters not supported";try{e=Fn.getKey(t.prvkeypem);this.init(e)}catch(t){throw"fatal error to load pem private key: "+t}}},tn.crypto.Cipher=function(t){},tn.crypto.Cipher.encrypt=function(t,e,n){if(e instanceof Ge&&e.isPublic){var r=tn.crypto.Cipher.getAlgByKeyAndName(e,n);if("RSA"===r)return e.encrypt(t);if("RSAOAEP"===r)return e.encryptOAEP(t,"sha1");var i=r.match(/^RSAOAEP(\d+)$/);if(null!==i)return e.encryptOAEP(t,"sha"+i[1]);throw"Cipher.encrypt: unsupported algorithm for RSAKey: "+n}throw"Cipher.encrypt: unsupported key or algorithm"},tn.crypto.Cipher.decrypt=function(t,e,n){if(e instanceof Ge&&e.isPrivate){var r=tn.crypto.Cipher.getAlgByKeyAndName(e,n);if("RSA"===r)return e.decrypt(t);if("RSAOAEP"===r)return e.decryptOAEP(t,"sha1");var i=r.match(/^RSAOAEP(\d+)$/);if(null!==i)return e.decryptOAEP(t,"sha"+i[1]);throw"Cipher.decrypt: unsupported algorithm for RSAKey: "+n}throw"Cipher.decrypt: unsupported key or algorithm"},tn.crypto.Cipher.getAlgByKeyAndName=function(t,e){if(t instanceof Ge){if(-1!=":RSA:RSAOAEP:RSAOAEP224:RSAOAEP256:RSAOAEP384:RSAOAEP512:".indexOf(e))return e;if(null==e)return"RSA";throw"getAlgByKeyAndName: not supported algorithm name for RSAKey: "+e}throw"getAlgByKeyAndName: not supported algorithm name: "+e},tn.crypto.OID=new function(){this.oidhex2name={"2a864886f70d010101":"rsaEncryption","2a8648ce3d0201":"ecPublicKey","2a8648ce380401":"dsa","2a8648ce3d030107":"secp256r1","2b8104001f":"secp192k1","2b81040021":"secp224r1","2b8104000a":"secp256k1","2b81040023":"secp521r1","2b81040022":"secp384r1","2a8648ce380403":"SHA1withDSA","608648016503040301":"SHA224withDSA","608648016503040302":"SHA256withDSA"}},void 0!==tn&&tn||(tn={}),void 0!==tn.crypto&&tn.crypto||(tn.crypto={}),tn.crypto.ECDSA=function(t){var e=new ze;this.type="EC",this.isPrivate=!1,this.isPublic=!1,this.getBigRandom=function(t){return new pe(t.bitLength(),e).mod(t.subtract(pe.ONE)).add(pe.ONE)},this.setNamedCurve=function(t){this.ecparams=tn.crypto.ECParameterDB.getByName(t),this.prvKeyHex=null,this.pubKeyHex=null,this.curveName=t},this.setPrivateKeyHex=function(t){this.isPrivate=!0,this.prvKeyHex=t},this.setPublicKeyHex=function(t){this.isPublic=!0,this.pubKeyHex=t},this.getPublicKeyXYHex=function(){var t=this.pubKeyHex;if("04"!==t.substr(0,2))throw"this method supports uncompressed format(04) only";var e=this.ecparams.keylen/4;if(t.length!==2+2*e)throw"malformed public key hex length";var n={};return n.x=t.substr(2,e),n.y=t.substr(2+e),n},this.getShortNISTPCurveName=function(){var t=this.curveName;return"secp256r1"===t||"NIST P-256"===t||"P-256"===t||"prime256v1"===t?"P-256":"secp384r1"===t||"NIST P-384"===t||"P-384"===t?"P-384":null},this.generateKeyPairHex=function(){var t=this.ecparams.n,e=this.getBigRandom(t),n=this.ecparams.G.multiply(e),r=n.getX().toBigInteger(),i=n.getY().toBigInteger(),s=this.ecparams.keylen/4,o=("0000000000"+e.toString(16)).slice(-s),a="04"+("0000000000"+r.toString(16)).slice(-s)+("0000000000"+i.toString(16)).slice(-s);return this.setPrivateKeyHex(o),this.setPublicKeyHex(a),{ecprvhex:o,ecpubhex:a}},this.signWithMessageHash=function(t){return this.signHex(t,this.prvKeyHex)},this.signHex=function(t,e){var n=new pe(e,16),r=this.ecparams.n,i=new pe(t,16);do{var s=this.getBigRandom(r),o=this.ecparams.G.multiply(s).getX().toBigInteger().mod(r)}while(o.compareTo(pe.ZERO)<=0);var a=s.modInverse(r).multiply(i.add(n.multiply(o))).mod(r);return tn.crypto.ECDSA.biRSSigToASN1Sig(o,a)},this.sign=function(t,e){var n=e,r=this.ecparams.n,i=pe.fromByteArrayUnsigned(t);do{var s=this.getBigRandom(r),o=this.ecparams.G.multiply(s).getX().toBigInteger().mod(r)}while(o.compareTo(pe.ZERO)<=0);var a=s.modInverse(r).multiply(i.add(n.multiply(o))).mod(r);return this.serializeSig(o,a)},this.verifyWithMessageHash=function(t,e){return this.verifyHex(t,e,this.pubKeyHex)},this.verifyHex=function(t,e,n){var r,i,s,o=tn.crypto.ECDSA.parseSigHex(e);r=o.r,i=o.s,s=$e.decodeFromHex(this.ecparams.curve,n);var a=new pe(t,16);return this.verifyRaw(a,r,i,s)},this.verify=function(t,e,n){var r,i,s;if(Bitcoin.Util.isArray(e)){var o=this.parseSig(e);r=o.r,i=o.s}else{if("object"!=typeof e||!e.r||!e.s)throw"Invalid value for signature";r=e.r,i=e.s}if(n instanceof $e)s=n;else{if(!Bitcoin.Util.isArray(n))throw"Invalid format for pubkey value, must be byte array or ECPointFp";s=$e.decodeFrom(this.ecparams.curve,n)}var a=pe.fromByteArrayUnsigned(t);return this.verifyRaw(a,r,i,s)},this.verifyRaw=function(t,e,n,r){var i=this.ecparams.n,s=this.ecparams.G;if(e.compareTo(pe.ONE)<0||e.compareTo(i)>=0)return!1;if(n.compareTo(pe.ONE)<0||n.compareTo(i)>=0)return!1;var o=n.modInverse(i),a=t.multiply(o).mod(i),h=e.multiply(o).mod(i);return s.multiply(a).add(r.multiply(h)).getX().toBigInteger().mod(i).equals(e)},this.serializeSig=function(t,e){var n=t.toByteArraySigned(),r=e.toByteArraySigned(),i=[];return i.push(2),i.push(n.length),(i=i.concat(n)).push(2),i.push(r.length),(i=i.concat(r)).unshift(i.length),i.unshift(48),i},this.parseSig=function(t){var e;if(48!=t[0])throw new Error("Signature not a valid DERSequence");if(2!=t[e=2])throw new Error("First element in signature must be a DERInteger");var n=t.slice(e+2,e+2+t[e+1]);if(2!=t[e+=2+t[e+1]])throw new Error("Second element in signature must be a DERInteger");var r=t.slice(e+2,e+2+t[e+1]);return e+=2+t[e+1],{r:pe.fromByteArrayUnsigned(n),s:pe.fromByteArrayUnsigned(r)}},this.parseSigCompact=function(t){if(65!==t.length)throw"Signature has the wrong length";var e=t[0]-27;if(e<0||e>7)throw"Invalid signature type";var n=this.ecparams.n;return{r:pe.fromByteArrayUnsigned(t.slice(1,33)).mod(n),s:pe.fromByteArrayUnsigned(t.slice(33,65)).mod(n),i:e}},this.readPKCS5PrvKeyHex=function(t){var e,n,r,i=rn,s=tn.crypto.ECDSA.getName,o=i.getVbyList;if(!1===i.isASN1HEX(t))throw"not ASN.1 hex string";try{e=o(t,0,[2,0],"06"),n=o(t,0,[1],"04");try{r=o(t,0,[3,0],"03").substr(2)}catch(t){}}catch(t){throw"malformed PKCS#1/5 plain ECC private key"}if(this.curveName=s(e),void 0===this.curveName)throw"unsupported curve name";this.setNamedCurve(this.curveName),this.setPublicKeyHex(r),this.setPrivateKeyHex(n),this.isPublic=!1},this.readPKCS8PrvKeyHex=function(t){var e,n,r,i=rn,s=tn.crypto.ECDSA.getName,o=i.getVbyList;if(!1===i.isASN1HEX(t))throw"not ASN.1 hex string";try{o(t,0,[1,0],"06"),e=o(t,0,[1,1],"06"),n=o(t,0,[2,0,1],"04");try{r=o(t,0,[2,0,2,0],"03").substr(2)}catch(t){}}catch(t){throw"malformed PKCS#8 plain ECC private key"}if(this.curveName=s(e),void 0===this.curveName)throw"unsupported curve name";this.setNamedCurve(this.curveName),this.setPublicKeyHex(r),this.setPrivateKeyHex(n),this.isPublic=!1},this.readPKCS8PubKeyHex=function(t){var e,n,r=rn,i=tn.crypto.ECDSA.getName,s=r.getVbyList;if(!1===r.isASN1HEX(t))throw"not ASN.1 hex string";try{s(t,0,[0,0],"06"),e=s(t,0,[0,1],"06"),n=s(t,0,[1],"03").substr(2)}catch(t){throw"malformed PKCS#8 ECC public key"}if(this.curveName=i(e),null===this.curveName)throw"unsupported curve name";this.setNamedCurve(this.curveName),this.setPublicKeyHex(n)},this.readCertPubKeyHex=function(t,e){5!==e&&(e=6);var n,r,i=rn,s=tn.crypto.ECDSA.getName,o=i.getVbyList;if(!1===i.isASN1HEX(t))throw"not ASN.1 hex string";try{n=o(t,0,[0,e,0,1],"06"),r=o(t,0,[0,e,1],"03").substr(2)}catch(t){throw"malformed X.509 certificate ECC public key"}if(this.curveName=s(n),null===this.curveName)throw"unsupported curve name";this.setNamedCurve(this.curveName),this.setPublicKeyHex(r)},void 0!==t&&void 0!==t.curve&&(this.curveName=t.curve),void 0===this.curveName&&(this.curveName="secp256r1"),this.setNamedCurve(this.curveName),void 0!==t&&(void 0!==t.prv&&this.setPrivateKeyHex(t.prv),void 0!==t.pub&&this.setPublicKeyHex(t.pub))},tn.crypto.ECDSA.parseSigHex=function(t){var e=tn.crypto.ECDSA.parseSigHexInHexRS(t);return{r:new pe(e.r,16),s:new pe(e.s,16)}},tn.crypto.ECDSA.parseSigHexInHexRS=function(t){var e=rn,n=e.getChildIdx,r=e.getV;if("30"!=t.substr(0,2))throw"signature is not a ASN.1 sequence";var i=n(t,0);if(2!=i.length)throw"number of signature ASN.1 sequence elements seem wrong";var s=i[0],o=i[1];if("02"!=t.substr(s,2))throw"1st item of sequene of signature is not ASN.1 integer";if("02"!=t.substr(o,2))throw"2nd item of sequene of signature is not ASN.1 integer";return{r:r(t,s),s:r(t,o)}},tn.crypto.ECDSA.asn1SigToConcatSig=function(t){var e=tn.crypto.ECDSA.parseSigHexInHexRS(t),n=e.r,r=e.s;if("00"==n.substr(0,2)&&n.length%32==2&&(n=n.substr(2)),"00"==r.substr(0,2)&&r.length%32==2&&(r=r.substr(2)),n.length%32==30&&(n="00"+n),r.length%32==30&&(r="00"+r),n.length%32!=0)throw"unknown ECDSA sig r length error";if(r.length%32!=0)throw"unknown ECDSA sig s length error";return n+r},tn.crypto.ECDSA.concatSigToASN1Sig=function(t){if(t.length/2*8%128!=0)throw"unknown ECDSA concatinated r-s sig  length error";var e=t.substr(0,t.length/2),n=t.substr(t.length/2);return tn.crypto.ECDSA.hexRSSigToASN1Sig(e,n)},tn.crypto.ECDSA.hexRSSigToASN1Sig=function(t,e){var n=new pe(t,16),r=new pe(e,16);return tn.crypto.ECDSA.biRSSigToASN1Sig(n,r)},tn.crypto.ECDSA.biRSSigToASN1Sig=function(t,e){var n=tn.asn1,r=new n.DERInteger({bigint:t}),i=new n.DERInteger({bigint:e});return new n.DERSequence({array:[r,i]}).getEncodedHex()},tn.crypto.ECDSA.getName=function(t){return"2a8648ce3d030107"===t?"secp256r1":"2b8104000a"===t?"secp256k1":"2b81040022"===t?"secp384r1":-1!=="|secp256r1|NIST P-256|P-256|prime256v1|".indexOf(t)?"secp256r1":-1!=="|secp256k1|".indexOf(t)?"secp256k1":-1!=="|secp384r1|NIST P-384|P-384|".indexOf(t)?"secp384r1":null},void 0!==tn&&tn||(tn={}),void 0!==tn.crypto&&tn.crypto||(tn.crypto={}),tn.crypto.ECParameterDB=new function(){var t={},e={};function n(t){return new pe(t,16)}this.getByName=function(n){var r=n;if(void 0!==e[r]&&(r=e[n]),void 0!==t[r])return t[r];throw"unregistered EC curve name: "+r},this.regist=function(r,i,s,o,a,h,u,c,f,l,d,p){t[r]={};var g=n(s),y=n(o),v=n(a),m=n(h),w=n(u),b=new Ze(g,y,v),S=b.decodePointHex("04"+c+f);t[r].name=r,t[r].keylen=i,t[r].curve=b,t[r].G=S,t[r].n=m,t[r].h=w,t[r].oid=d,t[r].info=p;for(var x=0;x<l.length;x++)e[l[x]]=r}},tn.crypto.ECParameterDB.regist("secp128r1",128,"FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFC","E87579C11079F43DD824993C2CEE5ED3","FFFFFFFE0000000075A30D1B9038A115","1","161FF7528B899B2D0C28607CA52C5B86","CF5AC8395BAFEB13C02DA292DDED7A83",[],"","secp128r1 : SECG curve over a 128 bit prime field"),tn.crypto.ECParameterDB.regist("secp160k1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFAC73","0","7","0100000000000000000001B8FA16DFAB9ACA16B6B3","1","3B4C382CE37AA192A4019E763036F4F5DD4D7EBB","938CF935318FDCED6BC28286531733C3F03C4FEE",[],"","secp160k1 : SECG curve over a 160 bit prime field"),tn.crypto.ECParameterDB.regist("secp160r1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFC","1C97BEFC54BD7A8B65ACF89F81D4D4ADC565FA45","0100000000000000000001F4C8F927AED3CA752257","1","4A96B5688EF573284664698968C38BB913CBFC82","23A628553168947D59DCC912042351377AC5FB32",[],"","secp160r1 : SECG curve over a 160 bit prime field"),tn.crypto.ECParameterDB.regist("secp192k1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFEE37","0","3","FFFFFFFFFFFFFFFFFFFFFFFE26F2FC170F69466A74DEFD8D","1","DB4FF10EC057E9AE26B07D0280B7F4341DA5D1B1EAE06C7D","9B2F2F6D9C5628A7844163D015BE86344082AA88D95E2F9D",[]),tn.crypto.ECParameterDB.regist("secp192r1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFC","64210519E59C80E70FA7E9AB72243049FEB8DEECC146B9B1","FFFFFFFFFFFFFFFFFFFFFFFF99DEF836146BC9B1B4D22831","1","188DA80EB03090F67CBF20EB43A18800F4FF0AFD82FF1012","07192B95FFC8DA78631011ED6B24CDD573F977A11E794811",[]),tn.crypto.ECParameterDB.regist("secp224r1",224,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF000000000000000000000001","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFE","B4050A850C04B3ABF54132565044B0B7D7BFD8BA270B39432355FFB4","FFFFFFFFFFFFFFFFFFFFFFFFFFFF16A2E0B8F03E13DD29455C5C2A3D","1","B70E0CBD6BB4BF7F321390B94A03C1D356C21122343280D6115C1D21","BD376388B5F723FB4C22DFE6CD4375A05A07476444D5819985007E34",[]),tn.crypto.ECParameterDB.regist("secp256k1",256,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F","0","7","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141","1","79BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798","483ADA7726A3C4655DA4FBFC0E1108A8FD17B448A68554199C47D08FFB10D4B8",[]),tn.crypto.ECParameterDB.regist("secp256r1",256,"FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFC","5AC635D8AA3A93E7B3EBBD55769886BC651D06B0CC53B0F63BCE3C3E27D2604B","FFFFFFFF00000000FFFFFFFFFFFFFFFFBCE6FAADA7179E84F3B9CAC2FC632551","1","6B17D1F2E12C4247F8BCE6E563A440F277037D812DEB33A0F4A13945D898C296","4FE342E2FE1A7F9B8EE7EB4A7C0F9E162BCE33576B315ECECBB6406837BF51F5",["NIST P-256","P-256","prime256v1"]),tn.crypto.ECParameterDB.regist("secp384r1",384,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFC","B3312FA7E23EE7E4988E056BE3F82D19181D9C6EFE8141120314088F5013875AC656398D8A2ED19D2A85C8EDD3EC2AEF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC7634D81F4372DDF581A0DB248B0A77AECEC196ACCC52973","1","AA87CA22BE8B05378EB1C71EF320AD746E1D3B628BA79B9859F741E082542A385502F25DBF55296C3A545E3872760AB7","3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f",["NIST P-384","P-384"]),tn.crypto.ECParameterDB.regist("secp521r1",521,"1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC","051953EB9618E1C9A1F929A21A0B68540EEA2DA725B99B315F3B8B489918EF109E156193951EC7E937B1652C0BD3BB1BF073573DF883D2C34F1EF451FD46B503F00","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFA51868783BF2F966B7FCC0148F709A5D03BB5C9B8899C47AEBB6FB71E91386409","1","C6858E06B70404E9CD9E3ECB662395B4429C648139053FB521F828AF606B4D3DBAA14B5E77EFE75928FE1DC127A2FFA8DE3348B3C1856A429BF97E7E31C2E5BD66","011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650",["NIST P-521","P-521"]),void 0!==tn&&tn||(tn={}),void 0!==tn.crypto&&tn.crypto||(tn.crypto={}),tn.crypto.DSA=function(){this.p=null,this.q=null,this.g=null,this.y=null,this.x=null,this.type="DSA",this.isPrivate=!1,this.isPublic=!1,this.setPrivate=function(t,e,n,r,i){this.isPrivate=!0,this.p=t,this.q=e,this.g=n,this.y=r,this.x=i},this.setPrivateHex=function(t,e,n,r,i){var s,o,a,h,u;s=new pe(t,16),o=new pe(e,16),a=new pe(n,16),h="string"==typeof r&&r.length>1?new pe(r,16):null,u=new pe(i,16),this.setPrivate(s,o,a,h,u)},this.setPublic=function(t,e,n,r){this.isPublic=!0,this.p=t,this.q=e,this.g=n,this.y=r,this.x=null},this.setPublicHex=function(t,e,n,r){var i,s,o,a;i=new pe(t,16),s=new pe(e,16),o=new pe(n,16),a=new pe(r,16),this.setPublic(i,s,o,a)},this.signWithMessageHash=function(t){var e=this.p,n=this.q,r=this.g,i=(this.y,this.x),s=tn.crypto.Util.getRandomBigIntegerMinToMax(pe.ONE.add(pe.ONE),n.subtract(pe.ONE)),o=new pe(t.substr(0,n.bitLength()/4),16),a=r.modPow(s,e).mod(n),h=s.modInverse(n).multiply(o.add(i.multiply(a))).mod(n);return tn.asn1.ASN1Util.jsonToASN1HEX({seq:[{int:{bigint:a}},{int:{bigint:h}}]})},this.verifyWithMessageHash=function(t,e){var n=this.p,r=this.q,i=this.g,s=this.y,o=this.parseASN1Signature(e),a=o[0],h=o[1],u=new pe(t.substr(0,r.bitLength()/4),16);if(pe.ZERO.compareTo(a)>0||a.compareTo(r)>0)throw"invalid DSA signature";if(pe.ZERO.compareTo(h)>=0||h.compareTo(r)>0)throw"invalid DSA signature";var c=h.modInverse(r),f=u.multiply(c).mod(r),l=a.multiply(c).mod(r);return 0==i.modPow(f,n).multiply(s.modPow(l,n)).mod(n).mod(r).compareTo(a)},this.parseASN1Signature=function(t){try{return[new pe(rn.getVbyList(t,0,[0],"02"),16),new pe(rn.getVbyList(t,0,[1],"02"),16)]}catch(t){throw"malformed ASN.1 DSA signature"}},this.readPKCS5PrvKeyHex=function(t){var e,n,r,i,s,o=rn,a=o.getVbyList;if(!1===o.isASN1HEX(t))throw"not ASN.1 hex string";try{e=a(t,0,[1],"02"),n=a(t,0,[2],"02"),r=a(t,0,[3],"02"),i=a(t,0,[4],"02"),s=a(t,0,[5],"02")}catch(t){throw console.log("EXCEPTION:"+t),"malformed PKCS#1/5 plain DSA private key"}this.setPrivateHex(e,n,r,i,s)},this.readPKCS8PrvKeyHex=function(t){var e,n,r,i,s=rn,o=s.getVbyList;if(!1===s.isASN1HEX(t))throw"not ASN.1 hex string";try{e=o(t,0,[1,1,0],"02"),n=o(t,0,[1,1,1],"02"),r=o(t,0,[1,1,2],"02"),i=o(t,0,[2,0],"02")}catch(t){throw console.log("EXCEPTION:"+t),"malformed PKCS#8 plain DSA private key"}this.setPrivateHex(e,n,r,null,i)},this.readPKCS8PubKeyHex=function(t){var e,n,r,i,s=rn,o=s.getVbyList;if(!1===s.isASN1HEX(t))throw"not ASN.1 hex string";try{e=o(t,0,[0,1,0],"02"),n=o(t,0,[0,1,1],"02"),r=o(t,0,[0,1,2],"02"),i=o(t,0,[1,0],"02")}catch(t){throw console.log("EXCEPTION:"+t),"malformed PKCS#8 DSA public key"}this.setPublicHex(e,n,r,i)},this.readCertPubKeyHex=function(t,e){var n,r,i,s;5!==e&&(e=6);var o=rn,a=o.getVbyList;if(!1===o.isASN1HEX(t))throw"not ASN.1 hex string";try{n=a(t,0,[0,e,0,1,0],"02"),r=a(t,0,[0,e,0,1,1],"02"),i=a(t,0,[0,e,0,1,2],"02"),s=a(t,0,[0,e,1,0],"02")}catch(t){throw console.log("EXCEPTION:"+t),"malformed X.509 certificate DSA public key"}this.setPublicHex(n,r,i,s)}};var Fn=function(){var t=function(t,n,r){return e(ue.AES,t,n,r)},e=function(t,e,n,r){var i=ue.enc.Hex.parse(e),s=ue.enc.Hex.parse(n),o=ue.enc.Hex.parse(r),a={};a.key=s,a.iv=o,a.ciphertext=i;var h=t.decrypt(a,s,{iv:o});return ue.enc.Hex.stringify(h)},n=function(t,e,n){return r(ue.AES,t,e,n)},r=function(t,e,n,r){var i=ue.enc.Hex.parse(e),s=ue.enc.Hex.parse(n),o=ue.enc.Hex.parse(r),a=t.encrypt(i,s,{iv:o}),h=ue.enc.Hex.parse(a.toString());return ue.enc.Base64.stringify(h)},i={"AES-256-CBC":{proc:t,eproc:n,keylen:32,ivlen:16},"AES-192-CBC":{proc:t,eproc:n,keylen:24,ivlen:16},"AES-128-CBC":{proc:t,eproc:n,keylen:16,ivlen:16},"DES-EDE3-CBC":{proc:function(t,n,r){return e(ue.TripleDES,t,n,r)},eproc:function(t,e,n){return r(ue.TripleDES,t,e,n)},keylen:24,ivlen:8},"DES-CBC":{proc:function(t,n,r){return e(ue.DES,t,n,r)},eproc:function(t,e,n){return r(ue.DES,t,e,n)},keylen:8,ivlen:8}},s=function(t){var e={},n=t.match(new RegExp("DEK-Info: ([^,]+),([0-9A-Fa-f]+)","m"));n&&(e.cipher=n[1],e.ivsalt=n[2]);var r=t.match(new RegExp("-----BEGIN ([A-Z]+) PRIVATE KEY-----"));r&&(e.type=r[1]);var i=-1,s=0;-1!=t.indexOf("\r\n\r\n")&&(i=t.indexOf("\r\n\r\n"),s=2),-1!=t.indexOf("\n\n")&&(i=t.indexOf("\n\n"),s=1);var o=t.indexOf("-----END");if(-1!=i&&-1!=o){var a=t.substring(i+2*s,o-s);a=a.replace(/\s+/g,""),e.data=a}return e},o=function(t,e,n){for(var r=n.substring(0,16),s=ue.enc.Hex.parse(r),o=ue.enc.Utf8.parse(e),a=i[t].keylen+i[t].ivlen,h="",u=null;;){var c=ue.algo.MD5.create();if(null!=u&&c.update(u),c.update(o),c.update(s),u=c.finalize(),(h+=ue.enc.Hex.stringify(u)).length>=2*a)break}var f={};return f.keyhex=h.substr(0,2*i[t].keylen),f.ivhex=h.substr(2*i[t].keylen,2*i[t].ivlen),f},a=function(t,e,n,r){var s=ue.enc.Base64.parse(t),o=ue.enc.Hex.stringify(s);return(0,i[e].proc)(o,n,r)};return{version:"1.0.0",parsePKCS5PEM:function(t){return s(t)},getKeyAndUnusedIvByPasscodeAndIvsalt:function(t,e,n){return o(t,e,n)},decryptKeyB64:function(t,e,n,r){return a(t,e,n,r)},getDecryptedKeyHex:function(t,e){var n=s(t),r=n.cipher,i=n.ivsalt,h=n.data,u=o(r,e,i).keyhex;return a(h,r,u,i)},getEncryptedPKCS5PEMFromPrvKeyHex:function(t,e,n,r,s){var a="";if(void 0!==r&&null!=r||(r="AES-256-CBC"),void 0===i[r])throw"KEYUTIL unsupported algorithm: "+r;void 0!==s&&null!=s||(s=function(t){var e=ue.lib.WordArray.random(t);return ue.enc.Hex.stringify(e)}(i[r].ivlen).toUpperCase());var h=function(t,e,n,r){return(0,i[e].eproc)(t,n,r)}(e,r,o(r,n,s).keyhex,s);a="-----BEGIN "+t+" PRIVATE KEY-----\r\n";return a+="Proc-Type: 4,ENCRYPTED\r\n",a+="DEK-Info: "+r+","+s+"\r\n",a+="\r\n",a+=h.replace(/(.{64})/g,"$1\r\n"),a+="\r\n-----END "+t+" PRIVATE KEY-----\r\n"},parseHexOfEncryptedPKCS8:function(t){var e=rn,n=e.getChildIdx,r=e.getV,i={},s=n(t,0);if(2!=s.length)throw"malformed format: SEQUENCE(0).items != 2: "+s.length;i.ciphertext=r(t,s[1]);var o=n(t,s[0]);if(2!=o.length)throw"malformed format: SEQUENCE(0.0).items != 2: "+o.length;if("2a864886f70d01050d"!=r(t,o[0]))throw"this only supports pkcs5PBES2";var a=n(t,o[1]);if(2!=o.length)throw"malformed format: SEQUENCE(0.0.1).items != 2: "+a.length;var h=n(t,a[1]);if(2!=h.length)throw"malformed format: SEQUENCE(0.0.1.1).items != 2: "+h.length;if("2a864886f70d0307"!=r(t,h[0]))throw"this only supports TripleDES";i.encryptionSchemeAlg="TripleDES",i.encryptionSchemeIV=r(t,h[1]);var u=n(t,a[0]);if(2!=u.length)throw"malformed format: SEQUENCE(0.0.1.0).items != 2: "+u.length;if("2a864886f70d01050c"!=r(t,u[0]))throw"this only supports pkcs5PBKDF2";var c=n(t,u[1]);if(c.length<2)throw"malformed format: SEQUENCE(0.0.1.0.1).items < 2: "+c.length;i.pbkdf2Salt=r(t,c[0]);var f=r(t,c[1]);try{i.pbkdf2Iter=parseInt(f,16)}catch(t){throw"malformed format pbkdf2Iter: "+f}return i},getPBKDF2KeyHexFromParam:function(t,e){var n=ue.enc.Hex.parse(t.pbkdf2Salt),r=t.pbkdf2Iter,i=ue.PBKDF2(e,n,{keySize:6,iterations:r});return ue.enc.Hex.stringify(i)},_getPlainPKCS8HexFromEncryptedPKCS8PEM:function(t,e){var n=vn(t,"ENCRYPTED PRIVATE KEY"),r=this.parseHexOfEncryptedPKCS8(n),i=Fn.getPBKDF2KeyHexFromParam(r,e),s={};s.ciphertext=ue.enc.Hex.parse(r.ciphertext);var o=ue.enc.Hex.parse(i),a=ue.enc.Hex.parse(r.encryptionSchemeIV),h=ue.TripleDES.decrypt(s,o,{iv:a});return ue.enc.Hex.stringify(h)},getKeyFromEncryptedPKCS8PEM:function(t,e){var n=this._getPlainPKCS8HexFromEncryptedPKCS8PEM(t,e);return this.getKeyFromPlainPrivatePKCS8Hex(n)},parsePlainPrivatePKCS8Hex:function(t){var e=rn,n=e.getChildIdx,r=e.getV,i={algparam:null};if("30"!=t.substr(0,2))throw"malformed plain PKCS8 private key(code:001)";var s=n(t,0);if(3!=s.length)throw"malformed plain PKCS8 private key(code:002)";if("30"!=t.substr(s[1],2))throw"malformed PKCS8 private key(code:003)";var o=n(t,s[1]);if(2!=o.length)throw"malformed PKCS8 private key(code:004)";if("06"!=t.substr(o[0],2))throw"malformed PKCS8 private key(code:005)";if(i.algoid=r(t,o[0]),"06"==t.substr(o[1],2)&&(i.algparam=r(t,o[1])),"04"!=t.substr(s[2],2))throw"malformed PKCS8 private key(code:006)";return i.keyidx=e.getVidx(t,s[2]),i},getKeyFromPlainPrivatePKCS8PEM:function(t){var e=vn(t,"PRIVATE KEY");return this.getKeyFromPlainPrivatePKCS8Hex(e)},getKeyFromPlainPrivatePKCS8Hex:function(t){var e,n=this.parsePlainPrivatePKCS8Hex(t);if("2a864886f70d010101"==n.algoid)e=new Ge;else if("2a8648ce380401"==n.algoid)e=new tn.crypto.DSA;else{if("2a8648ce3d0201"!=n.algoid)throw"unsupported private key algorithm";e=new tn.crypto.ECDSA}return e.readPKCS8PrvKeyHex(t),e},_getKeyFromPublicPKCS8Hex:function(t){var e,n=rn.getVbyList(t,0,[0,0],"06");if("2a864886f70d010101"===n)e=new Ge;else if("2a8648ce380401"===n)e=new tn.crypto.DSA;else{if("2a8648ce3d0201"!==n)throw"unsupported PKCS#8 public key hex";e=new tn.crypto.ECDSA}return e.readPKCS8PubKeyHex(t),e},parsePublicRawRSAKeyHex:function(t){var e=rn,n=e.getChildIdx,r=e.getV,i={};if("30"!=t.substr(0,2))throw"malformed RSA key(code:001)";var s=n(t,0);if(2!=s.length)throw"malformed RSA key(code:002)";if("02"!=t.substr(s[0],2))throw"malformed RSA key(code:003)";if(i.n=r(t,s[0]),"02"!=t.substr(s[1],2))throw"malformed RSA key(code:004)";return i.e=r(t,s[1]),i},parsePublicPKCS8Hex:function(t){var e=rn,n=e.getChildIdx,r=e.getV,i={algparam:null},s=n(t,0);if(2!=s.length)throw"outer DERSequence shall have 2 elements: "+s.length;var o=s[0];if("30"!=t.substr(o,2))throw"malformed PKCS8 public key(code:001)";var a=n(t,o);if(2!=a.length)throw"malformed PKCS8 public key(code:002)";if("06"!=t.substr(a[0],2))throw"malformed PKCS8 public key(code:003)";if(i.algoid=r(t,a[0]),"06"==t.substr(a[1],2)?i.algparam=r(t,a[1]):"30"==t.substr(a[1],2)&&(i.algparam={},i.algparam.p=e.getVbyList(t,a[1],[0],"02"),i.algparam.q=e.getVbyList(t,a[1],[1],"02"),i.algparam.g=e.getVbyList(t,a[1],[2],"02")),"03"!=t.substr(s[1],2))throw"malformed PKCS8 public key(code:004)";return i.key=r(t,s[1]).substr(2),i}}}();Fn.getKey=function(t,e,n){var r=(y=rn).getChildIdx,i=(y.getV,y.getVbyList),s=tn.crypto,o=s.ECDSA,a=s.DSA,h=Ge,u=vn,c=Fn;if(void 0!==h&&t instanceof h)return t;if(void 0!==o&&t instanceof o)return t;if(void 0!==a&&t instanceof a)return t;if(void 0!==t.curve&&void 0!==t.xy&&void 0===t.d)return new o({pub:t.xy,curve:t.curve});if(void 0!==t.curve&&void 0!==t.d)return new o({prv:t.d,curve:t.curve});if(void 0===t.kty&&void 0!==t.n&&void 0!==t.e&&void 0===t.d)return(T=new h).setPublic(t.n,t.e),T;if(void 0===t.kty&&void 0!==t.n&&void 0!==t.e&&void 0!==t.d&&void 0!==t.p&&void 0!==t.q&&void 0!==t.dp&&void 0!==t.dq&&void 0!==t.co&&void 0===t.qi)return(T=new h).setPrivateEx(t.n,t.e,t.d,t.p,t.q,t.dp,t.dq,t.co),T;if(void 0===t.kty&&void 0!==t.n&&void 0!==t.e&&void 0!==t.d&&void 0===t.p)return(T=new h).setPrivate(t.n,t.e,t.d),T;if(void 0!==t.p&&void 0!==t.q&&void 0!==t.g&&void 0!==t.y&&void 0===t.x)return(T=new a).setPublic(t.p,t.q,t.g,t.y),T;if(void 0!==t.p&&void 0!==t.q&&void 0!==t.g&&void 0!==t.y&&void 0!==t.x)return(T=new a).setPrivate(t.p,t.q,t.g,t.y,t.x),T;if("RSA"===t.kty&&void 0!==t.n&&void 0!==t.e&&void 0===t.d)return(T=new h).setPublic(cn(t.n),cn(t.e)),T;if("RSA"===t.kty&&void 0!==t.n&&void 0!==t.e&&void 0!==t.d&&void 0!==t.p&&void 0!==t.q&&void 0!==t.dp&&void 0!==t.dq&&void 0!==t.qi)return(T=new h).setPrivateEx(cn(t.n),cn(t.e),cn(t.d),cn(t.p),cn(t.q),cn(t.dp),cn(t.dq),cn(t.qi)),T;if("RSA"===t.kty&&void 0!==t.n&&void 0!==t.e&&void 0!==t.d)return(T=new h).setPrivate(cn(t.n),cn(t.e),cn(t.d)),T;if("EC"===t.kty&&void 0!==t.crv&&void 0!==t.x&&void 0!==t.y&&void 0===t.d){var f=(C=new o({curve:t.crv})).ecparams.keylen/4,l="04"+("0000000000"+cn(t.x)).slice(-f)+("0000000000"+cn(t.y)).slice(-f);return C.setPublicKeyHex(l),C}if("EC"===t.kty&&void 0!==t.crv&&void 0!==t.x&&void 0!==t.y&&void 0!==t.d){f=(C=new o({curve:t.crv})).ecparams.keylen/4,l="04"+("0000000000"+cn(t.x)).slice(-f)+("0000000000"+cn(t.y)).slice(-f);var d=("0000000000"+cn(t.d)).slice(-f);return C.setPublicKeyHex(l),C.setPrivateKeyHex(d),C}if("pkcs5prv"===n){var p,g=t,y=rn;if(9===(p=r(g,0)).length)(T=new h).readPKCS5PrvKeyHex(g);else if(6===p.length)(T=new a).readPKCS5PrvKeyHex(g);else{if(!(p.length>2&&"04"===g.substr(p[1],2)))throw"unsupported PKCS#1/5 hexadecimal key";(T=new o).readPKCS5PrvKeyHex(g)}return T}if("pkcs8prv"===n)return T=c.getKeyFromPlainPrivatePKCS8Hex(t);if("pkcs8pub"===n)return c._getKeyFromPublicPKCS8Hex(t);if("x509pub"===n)return Dn.getPublicKeyFromCertHex(t);if(-1!=t.indexOf("-END CERTIFICATE-",0)||-1!=t.indexOf("-END X509 CERTIFICATE-",0)||-1!=t.indexOf("-END TRUSTED CERTIFICATE-",0))return Dn.getPublicKeyFromCertPEM(t);if(-1!=t.indexOf("-END PUBLIC KEY-")){var v=vn(t,"PUBLIC KEY");return c._getKeyFromPublicPKCS8Hex(v)}if(-1!=t.indexOf("-END RSA PRIVATE KEY-")&&-1==t.indexOf("4,ENCRYPTED")){var m=u(t,"RSA PRIVATE KEY");return c.getKey(m,null,"pkcs5prv")}if(-1!=t.indexOf("-END DSA PRIVATE KEY-")&&-1==t.indexOf("4,ENCRYPTED")){var w=i(I=u(t,"DSA PRIVATE KEY"),0,[1],"02"),b=i(I,0,[2],"02"),S=i(I,0,[3],"02"),x=i(I,0,[4],"02"),E=i(I,0,[5],"02");return(T=new a).setPrivate(new pe(w,16),new pe(b,16),new pe(S,16),new pe(x,16),new pe(E,16)),T}if(-1!=t.indexOf("-END PRIVATE KEY-"))return c.getKeyFromPlainPrivatePKCS8PEM(t);if(-1!=t.indexOf("-END RSA PRIVATE KEY-")&&-1!=t.indexOf("4,ENCRYPTED")){var F=c.getDecryptedKeyHex(t,e),A=new Ge;return A.readPKCS5PrvKeyHex(F),A}if(-1!=t.indexOf("-END EC PRIVATE KEY-")&&-1!=t.indexOf("4,ENCRYPTED")){var C,T=i(I=c.getDecryptedKeyHex(t,e),0,[1],"04"),P=i(I,0,[2,0],"06"),D=i(I,0,[3,0],"03").substr(2);if(void 0===tn.crypto.OID.oidhex2name[P])throw"undefined OID(hex) in KJUR.crypto.OID: "+P;return(C=new o({curve:tn.crypto.OID.oidhex2name[P]})).setPublicKeyHex(D),C.setPrivateKeyHex(T),C.isPublic=!1,C}if(-1!=t.indexOf("-END DSA PRIVATE KEY-")&&-1!=t.indexOf("4,ENCRYPTED")){var I;w=i(I=c.getDecryptedKeyHex(t,e),0,[1],"02"),b=i(I,0,[2],"02"),S=i(I,0,[3],"02"),x=i(I,0,[4],"02"),E=i(I,0,[5],"02");return(T=new a).setPrivate(new pe(w,16),new pe(b,16),new pe(S,16),new pe(x,16),new pe(E,16)),T}if(-1!=t.indexOf("-END ENCRYPTED PRIVATE KEY-"))return c.getKeyFromEncryptedPKCS8PEM(t,e);throw"not supported argument"},Fn.generateKeypair=function(t,e){if("RSA"==t){var n=e;(o=new Ge).generate(n,"10001"),o.isPrivate=!0,o.isPublic=!0;var r=new Ge,i=o.n.toString(16),s=o.e.toString(16);return r.setPublic(i,s),r.isPrivate=!1,r.isPublic=!0,(a={}).prvKeyObj=o,a.pubKeyObj=r,a}if("EC"==t){var o,a,h=e,u=new tn.crypto.ECDSA({curve:h}).generateKeyPairHex();return(o=new tn.crypto.ECDSA({curve:h})).setPublicKeyHex(u.ecpubhex),o.setPrivateKeyHex(u.ecprvhex),o.isPrivate=!0,o.isPublic=!1,(r=new tn.crypto.ECDSA({curve:h})).setPublicKeyHex(u.ecpubhex),r.isPrivate=!1,r.isPublic=!0,(a={}).prvKeyObj=o,a.pubKeyObj=r,a}throw"unknown algorithm: "+t},Fn.getPEM=function(t,e,n,r,i,s){var o=tn,a=o.asn1,h=a.DERObjectIdentifier,u=a.DERInteger,c=a.ASN1Util.newObject,f=a.x509.SubjectPublicKeyInfo,l=o.crypto,d=l.DSA,p=l.ECDSA,g=Ge;function y(t){return c({seq:[{int:0},{int:{bigint:t.n}},{int:t.e},{int:{bigint:t.d}},{int:{bigint:t.p}},{int:{bigint:t.q}},{int:{bigint:t.dmp1}},{int:{bigint:t.dmq1}},{int:{bigint:t.coeff}}]})}function v(t){return c({seq:[{int:1},{octstr:{hex:t.prvKeyHex}},{tag:["a0",!0,{oid:{name:t.curveName}}]},{tag:["a1",!0,{bitstr:{hex:"00"+t.pubKeyHex}}]}]})}function m(t){return c({seq:[{int:0},{int:{bigint:t.p}},{int:{bigint:t.q}},{int:{bigint:t.g}},{int:{bigint:t.y}},{int:{bigint:t.x}}]})}if((void 0!==g&&t instanceof g||void 0!==d&&t instanceof d||void 0!==p&&t instanceof p)&&1==t.isPublic&&(void 0===e||"PKCS8PUB"==e))return yn(x=new f(t).getEncodedHex(),"PUBLIC KEY");if("PKCS1PRV"==e&&void 0!==g&&t instanceof g&&(void 0===n||null==n)&&1==t.isPrivate)return yn(x=y(t).getEncodedHex(),"RSA PRIVATE KEY");if("PKCS1PRV"==e&&void 0!==p&&t instanceof p&&(void 0===n||null==n)&&1==t.isPrivate){var w=new h({name:t.curveName}).getEncodedHex(),b=v(t).getEncodedHex(),S="";return S+=yn(w,"EC PARAMETERS"),S+=yn(b,"EC PRIVATE KEY")}if("PKCS1PRV"==e&&void 0!==d&&t instanceof d&&(void 0===n||null==n)&&1==t.isPrivate)return yn(x=m(t).getEncodedHex(),"DSA PRIVATE KEY");if("PKCS5PRV"==e&&void 0!==g&&t instanceof g&&void 0!==n&&null!=n&&1==t.isPrivate){var x=y(t).getEncodedHex();return void 0===r&&(r="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("RSA",x,n,r,s)}if("PKCS5PRV"==e&&void 0!==p&&t instanceof p&&void 0!==n&&null!=n&&1==t.isPrivate){x=v(t).getEncodedHex();return void 0===r&&(r="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("EC",x,n,r,s)}if("PKCS5PRV"==e&&void 0!==d&&t instanceof d&&void 0!==n&&null!=n&&1==t.isPrivate){x=m(t).getEncodedHex();return void 0===r&&(r="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("DSA",x,n,r,s)}var E=function(t,e){var n=F(t,e);return new c({seq:[{seq:[{oid:{name:"pkcs5PBES2"}},{seq:[{seq:[{oid:{name:"pkcs5PBKDF2"}},{seq:[{octstr:{hex:n.pbkdf2Salt}},{int:n.pbkdf2Iter}]}]},{seq:[{oid:{name:"des-EDE3-CBC"}},{octstr:{hex:n.encryptionSchemeIV}}]}]}]},{octstr:{hex:n.ciphertext}}]}).getEncodedHex()},F=function(t,e){var n=ue.lib.WordArray.random(8),r=ue.lib.WordArray.random(8),i=ue.PBKDF2(e,n,{keySize:6,iterations:100}),s=ue.enc.Hex.parse(t),o=ue.TripleDES.encrypt(s,i,{iv:r})+"",a={};return a.ciphertext=o,a.pbkdf2Salt=ue.enc.Hex.stringify(n),a.pbkdf2Iter=100,a.encryptionSchemeAlg="DES-EDE3-CBC",a.encryptionSchemeIV=ue.enc.Hex.stringify(r),a};if("PKCS8PRV"==e&&null!=g&&t instanceof g&&1==t.isPrivate){var A=y(t).getEncodedHex();x=c({seq:[{int:0},{seq:[{oid:{name:"rsaEncryption"}},{null:!0}]},{octstr:{hex:A}}]}).getEncodedHex();return void 0===n||null==n?yn(x,"PRIVATE KEY"):yn(b=E(x,n),"ENCRYPTED PRIVATE KEY")}if("PKCS8PRV"==e&&void 0!==p&&t instanceof p&&1==t.isPrivate){A=new c({seq:[{int:1},{octstr:{hex:t.prvKeyHex}},{tag:["a1",!0,{bitstr:{hex:"00"+t.pubKeyHex}}]}]}).getEncodedHex(),x=c({seq:[{int:0},{seq:[{oid:{name:"ecPublicKey"}},{oid:{name:t.curveName}}]},{octstr:{hex:A}}]}).getEncodedHex();return void 0===n||null==n?yn(x,"PRIVATE KEY"):yn(b=E(x,n),"ENCRYPTED PRIVATE KEY")}if("PKCS8PRV"==e&&void 0!==d&&t instanceof d&&1==t.isPrivate){A=new u({bigint:t.x}).getEncodedHex(),x=c({seq:[{int:0},{seq:[{oid:{name:"dsa"}},{seq:[{int:{bigint:t.p}},{int:{bigint:t.q}},{int:{bigint:t.g}}]}]},{octstr:{hex:A}}]}).getEncodedHex();return void 0===n||null==n?yn(x,"PRIVATE KEY"):yn(b=E(x,n),"ENCRYPTED PRIVATE KEY")}throw"unsupported object nor format"},Fn.getKeyFromCSRPEM=function(t){var e=vn(t,"CERTIFICATE REQUEST");return Fn.getKeyFromCSRHex(e)},Fn.getKeyFromCSRHex=function(t){var e=Fn.parseCSRHex(t);return Fn.getKey(e.p8pubkeyhex,null,"pkcs8pub")},Fn.parseCSRHex=function(t){var e=rn,n=e.getChildIdx,r=e.getTLV,i={},s=t;if("30"!=s.substr(0,2))throw"malformed CSR(code:001)";var o=n(s,0);if(o.length<1)throw"malformed CSR(code:002)";if("30"!=s.substr(o[0],2))throw"malformed CSR(code:003)";var a=n(s,o[0]);if(a.length<3)throw"malformed CSR(code:004)";return i.p8pubkeyhex=r(s,a[2]),i},Fn.getJWKFromKey=function(t){var e={};if(t instanceof Ge&&t.isPrivate)return e.kty="RSA",e.n=un(t.n.toString(16)),e.e=un(t.e.toString(16)),e.d=un(t.d.toString(16)),e.p=un(t.p.toString(16)),e.q=un(t.q.toString(16)),e.dp=un(t.dmp1.toString(16)),e.dq=un(t.dmq1.toString(16)),e.qi=un(t.coeff.toString(16)),e;if(t instanceof Ge&&t.isPublic)return e.kty="RSA",e.n=un(t.n.toString(16)),e.e=un(t.e.toString(16)),e;if(t instanceof tn.crypto.ECDSA&&t.isPrivate){if("P-256"!==(r=t.getShortNISTPCurveName())&&"P-384"!==r)throw"unsupported curve name for JWT: "+r;var n=t.getPublicKeyXYHex();return e.kty="EC",e.crv=r,e.x=un(n.x),e.y=un(n.y),e.d=un(t.prvKeyHex),e}if(t instanceof tn.crypto.ECDSA&&t.isPublic){var r;if("P-256"!==(r=t.getShortNISTPCurveName())&&"P-384"!==r)throw"unsupported curve name for JWT: "+r;n=t.getPublicKeyXYHex();return e.kty="EC",e.crv=r,e.x=un(n.x),e.y=un(n.y),e}throw"not supported key object"},Ge.getPosArrayOfChildrenFromHex=function(t){return rn.getChildIdx(t,0)},Ge.getHexValueArrayOfChildrenFromHex=function(t){var e,n=rn.getV,r=n(t,(e=Ge.getPosArrayOfChildrenFromHex(t))[0]),i=n(t,e[1]),s=n(t,e[2]),o=n(t,e[3]),a=n(t,e[4]),h=n(t,e[5]),u=n(t,e[6]),c=n(t,e[7]),f=n(t,e[8]);return(e=new Array).push(r,i,s,o,a,h,u,c,f),e},Ge.prototype.readPrivateKeyFromPEMString=function(t){var e=vn(t),n=Ge.getHexValueArrayOfChildrenFromHex(e);this.setPrivateEx(n[1],n[2],n[3],n[4],n[5],n[6],n[7],n[8])},Ge.prototype.readPKCS5PrvKeyHex=function(t){var e=Ge.getHexValueArrayOfChildrenFromHex(t);this.setPrivateEx(e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8])},Ge.prototype.readPKCS8PrvKeyHex=function(t){var e,n,r,i,s,o,a,h,u=rn,c=u.getVbyList;if(!1===u.isASN1HEX(t))throw"not ASN.1 hex string";try{e=c(t,0,[2,0,1],"02"),n=c(t,0,[2,0,2],"02"),r=c(t,0,[2,0,3],"02"),i=c(t,0,[2,0,4],"02"),s=c(t,0,[2,0,5],"02"),o=c(t,0,[2,0,6],"02"),a=c(t,0,[2,0,7],"02"),h=c(t,0,[2,0,8],"02")}catch(t){throw"malformed PKCS#8 plain RSA private key"}this.setPrivateEx(e,n,r,i,s,o,a,h)},Ge.prototype.readPKCS5PubKeyHex=function(t){var e=rn,n=e.getV;if(!1===e.isASN1HEX(t))throw"keyHex is not ASN.1 hex string";var r=e.getChildIdx(t,0);if(2!==r.length||"02"!==t.substr(r[0],2)||"02"!==t.substr(r[1],2))throw"wrong hex for PKCS#5 public key";var i=n(t,r[0]),s=n(t,r[1]);this.setPublic(i,s)},Ge.prototype.readPKCS8PubKeyHex=function(t){var e=rn;if(!1===e.isASN1HEX(t))throw"not ASN.1 hex string";if("06092a864886f70d010101"!==e.getTLVbyList(t,0,[0,0]))throw"not PKCS8 RSA public key";var n=e.getTLVbyList(t,0,[1,0]);this.readPKCS5PubKeyHex(n)},Ge.prototype.readCertPubKeyHex=function(t,e){var n,r;(n=new Dn).readCertHex(t),r=n.getPublicKeyHex(),this.readPKCS8PubKeyHex(r)};var An=new RegExp("");function Cn(t,e){for(var n="",r=e/4-t.length,i=0;i<r;i++)n+="0";return n+t}function Tn(t,e,n){for(var r="",i=0;r.length<e;)r+=dn(n(pn(t+String.fromCharCode.apply(String,[(4278190080&i)>>24,(16711680&i)>>16,(65280&i)>>8,255&i])))),i+=1;return r}function Pn(t){for(var e in tn.crypto.Util.DIGESTINFOHEAD){var n=tn.crypto.Util.DIGESTINFOHEAD[e],r=n.length;if(t.substring(0,r)==n)return[e,t.substring(r)]}return[]}function Dn(){var t=rn,e=t.getChildIdx,n=t.getV,r=t.getTLV,i=t.getVbyList,s=t.getTLVbyList,o=t.getIdxbyList,a=t.getVidx,h=t.oidname,u=Dn,c=vn;this.hex=null,this.version=0,this.foffset=0,this.aExtInfo=null,this.getVersion=function(){return null===this.hex||0!==this.version?this.version:"a003020102"!==s(this.hex,0,[0,0])?(this.version=1,this.foffset=-1,1):(this.version=3,3)},this.getSerialNumberHex=function(){return i(this.hex,0,[0,1+this.foffset],"02")},this.getSignatureAlgorithmField=function(){return h(i(this.hex,0,[0,2+this.foffset,0],"06"))},this.getIssuerHex=function(){return s(this.hex,0,[0,3+this.foffset],"30")},this.getIssuerString=function(){return u.hex2dn(this.getIssuerHex())},this.getSubjectHex=function(){return s(this.hex,0,[0,5+this.foffset],"30")},this.getSubjectString=function(){return u.hex2dn(this.getSubjectHex())},this.getNotBefore=function(){var t=i(this.hex,0,[0,4+this.foffset,0]);return t=t.replace(/(..)/g,"%$1"),t=decodeURIComponent(t)},this.getNotAfter=function(){var t=i(this.hex,0,[0,4+this.foffset,1]);return t=t.replace(/(..)/g,"%$1"),t=decodeURIComponent(t)},this.getPublicKeyHex=function(){return t.getTLVbyList(this.hex,0,[0,6+this.foffset],"30")},this.getPublicKeyIdx=function(){return o(this.hex,0,[0,6+this.foffset],"30")},this.getPublicKeyContentIdx=function(){var t=this.getPublicKeyIdx();return o(this.hex,t,[1,0],"30")},this.getPublicKey=function(){return Fn.getKey(this.getPublicKeyHex(),null,"pkcs8pub")},this.getSignatureAlgorithmName=function(){return h(i(this.hex,0,[1,0],"06"))},this.getSignatureValueHex=function(){return i(this.hex,0,[2],"03",!0)},this.verifySignature=function(t){var e=this.getSignatureAlgorithmName(),n=this.getSignatureValueHex(),r=s(this.hex,0,[0],"30"),i=new tn.crypto.Signature({alg:e});return i.init(t),i.updateHex(r),i.verify(n)},this.parseExt=function(){if(3!==this.version)return-1;var n=o(this.hex,0,[0,7,0],"30"),r=e(this.hex,n);this.aExtInfo=new Array;for(var s=0;s<r.length;s++){var h={critical:!1},u=0;3===e(this.hex,r[s]).length&&(h.critical=!0,u=1),h.oid=t.hextooidstr(i(this.hex,r[s],[0],"06"));var c=o(this.hex,r[s],[1+u]);h.vidx=a(this.hex,c),this.aExtInfo.push(h)}},this.getExtInfo=function(t){var e=this.aExtInfo,n=t;if(t.match(/^[0-9.]+$/)||(n=tn.asn1.x509.OID.name2oid(t)),""!==n)for(var r=0;r<e.length;r++)if(e[r].oid===n)return e[r]},this.getExtBasicConstraints=function(){var t=this.getExtInfo("basicConstraints");if(void 0===t)return t;var e=n(this.hex,t.vidx);if(""===e)return{};if("0101ff"===e)return{cA:!0};if("0101ff02"===e.substr(0,8)){var r=n(e,6);return{cA:!0,pathLen:parseInt(r,16)}}throw"basicConstraints parse error"},this.getExtKeyUsageBin=function(){var t=this.getExtInfo("keyUsage");if(void 0===t)return"";var e=n(this.hex,t.vidx);if(e.length%2!=0||e.length<=2)throw"malformed key usage value";var r=parseInt(e.substr(0,2)),i=parseInt(e.substr(2),16).toString(2);return i.substr(0,i.length-r)},this.getExtKeyUsageString=function(){for(var t=this.getExtKeyUsageBin(),e=new Array,n=0;n<t.length;n++)"1"==t.substr(n,1)&&e.push(Dn.KEYUSAGE_NAME[n]);return e.join(",")},this.getExtSubjectKeyIdentifier=function(){var t=this.getExtInfo("subjectKeyIdentifier");return void 0===t?t:n(this.hex,t.vidx)},this.getExtAuthorityKeyIdentifier=function(){var t=this.getExtInfo("authorityKeyIdentifier");if(void 0===t)return t;for(var i={},s=r(this.hex,t.vidx),o=e(s,0),a=0;a<o.length;a++)"80"===s.substr(o[a],2)&&(i.kid=n(s,o[a]));return i},this.getExtExtKeyUsageName=function(){var t=this.getExtInfo("extKeyUsage");if(void 0===t)return t;var i=new Array,s=r(this.hex,t.vidx);if(""===s)return i;for(var o=e(s,0),a=0;a<o.length;a++)i.push(h(n(s,o[a])));return i},this.getExtSubjectAltName=function(){for(var t=this.getExtSubjectAltName2(),e=new Array,n=0;n<t.length;n++)"DNS"===t[n][0]&&e.push(t[n][1]);return e},this.getExtSubjectAltName2=function(){var t,i,s,o=this.getExtInfo("subjectAltName");if(void 0===o)return o;for(var a=new Array,h=r(this.hex,o.vidx),u=e(h,0),c=0;c<u.length;c++)s=h.substr(u[c],2),t=n(h,u[c]),"81"===s&&(i=ln(t),a.push(["MAIL",i])),"82"===s&&(i=ln(t),a.push(["DNS",i])),"84"===s&&(i=Dn.hex2dn(t,0),a.push(["DN",i])),"86"===s&&(i=ln(t),a.push(["URI",i])),"87"===s&&(i=Sn(t),a.push(["IP",i]));return a},this.getExtCRLDistributionPointsURI=function(){var t=this.getExtInfo("cRLDistributionPoints");if(void 0===t)return t;for(var n=new Array,r=e(this.hex,t.vidx),s=0;s<r.length;s++)try{var o=ln(i(this.hex,r[s],[0,0,0],"86"));n.push(o)}catch(t){}return n},this.getExtAIAInfo=function(){var t=this.getExtInfo("authorityInfoAccess");if(void 0===t)return t;for(var n={ocsp:[],caissuer:[]},r=e(this.hex,t.vidx),s=0;s<r.length;s++){var o=i(this.hex,r[s],[0],"06"),a=i(this.hex,r[s],[1],"86");"2b06010505073001"===o&&n.ocsp.push(ln(a)),"2b06010505073002"===o&&n.caissuer.push(ln(a))}return n},this.getExtCertificatePolicies=function(){var t=this.getExtInfo("certificatePolicies");if(void 0===t)return t;for(var s=r(this.hex,t.vidx),o=[],a=e(s,0),u=0;u<a.length;u++){var c={},f=e(s,a[u]);if(c.id=h(n(s,f[0])),2===f.length)for(var l=e(s,f[1]),d=0;d<l.length;d++){var p=i(s,l[d],[0],"06");"2b06010505070201"===p?c.cps=ln(i(s,l[d],[1])):"2b06010505070202"===p&&(c.unotice=ln(i(s,l[d],[1,0])))}o.push(c)}return o},this.readCertPEM=function(t){this.readCertHex(c(t))},this.readCertHex=function(t){this.hex=t,this.getVersion();try{o(this.hex,0,[0,7],"a3"),this.parseExt()}catch(t){}},this.getInfo=function(){var t,e,n;if(t="Basic Fields\n",t+="  serial number: "+this.getSerialNumberHex()+"\n",t+="  signature algorithm: "+this.getSignatureAlgorithmField()+"\n",t+="  issuer: "+this.getIssuerString()+"\n",t+="  notBefore: "+this.getNotBefore()+"\n",t+="  notAfter: "+this.getNotAfter()+"\n",t+="  subject: "+this.getSubjectString()+"\n",t+="  subject public key info: \n",t+="    key algorithm: "+(e=this.getPublicKey()).type+"\n","RSA"===e.type&&(t+="    n="+En(e.n.toString(16)).substr(0,16)+"...\n",t+="    e="+En(e.e.toString(16))+"\n"),null!=(n=this.aExtInfo)){t+="X509v3 Extensions:\n";for(var r=0;r<n.length;r++){var i=n[r],s=tn.asn1.x509.OID.oid2name(i.oid);""===s&&(s=i.oid);var o="";if(!0===i.critical&&(o="CRITICAL"),t+="  "+s+" "+o+":\n","basicConstraints"===s){var a=this.getExtBasicConstraints();void 0===a.cA?t+="    {}\n":(t+="    cA=true",void 0!==a.pathLen&&(t+=", pathLen="+a.pathLen),t+="\n")}else if("keyUsage"===s)t+="    "+this.getExtKeyUsageString()+"\n";else if("subjectKeyIdentifier"===s)t+="    "+this.getExtSubjectKeyIdentifier()+"\n";else if("authorityKeyIdentifier"===s){var h=this.getExtAuthorityKeyIdentifier();void 0!==h.kid&&(t+="    kid="+h.kid+"\n")}else{if("extKeyUsage"===s)t+="    "+this.getExtExtKeyUsageName().join(", ")+"\n";else if("subjectAltName"===s)t+="    "+this.getExtSubjectAltName2()+"\n";else if("cRLDistributionPoints"===s)t+="    "+this.getExtCRLDistributionPointsURI()+"\n";else if("authorityInfoAccess"===s){var u=this.getExtAIAInfo();void 0!==u.ocsp&&(t+="    ocsp: "+u.ocsp.join(",")+"\n"),void 0!==u.caissuer&&(t+="    caissuer: "+u.caissuer.join(",")+"\n")}else if("certificatePolicies"===s)for(var c=this.getExtCertificatePolicies(),f=0;f<c.length;f++)void 0!==c[f].id&&(t+="    policy oid: "+c[f].id+"\n"),void 0!==c[f].cps&&(t+="    cps: "+c[f].cps+"\n")}}}return t+="signature algorithm: "+this.getSignatureAlgorithmName()+"\n",t+="signature: "+this.getSignatureValueHex().substr(0,16)+"...\n"}}An.compile("[^0-9a-f]","gi"),Ge.prototype.sign=function(t,e){var n,r=(n=t,tn.crypto.Util.hashString(n,e));return this.signWithMessageHash(r,e)},Ge.prototype.signWithMessageHash=function(t,e){var n=Ye(tn.crypto.Util.getPaddedDigestInfoHex(t,e,this.n.bitLength()),16);return Cn(this.doPrivate(n).toString(16),this.n.bitLength())},Ge.prototype.signPSS=function(t,e,n){var r,i=(r=pn(t),tn.crypto.Util.hashHex(r,e));return void 0===n&&(n=-1),this.signWithMessageHashPSS(i,e,n)},Ge.prototype.signWithMessageHashPSS=function(t,e,n){var r,i=dn(t),s=i.length,o=this.n.bitLength()-1,a=Math.ceil(o/8),h=function(t){return tn.crypto.Util.hashHex(t,e)};if(-1===n||void 0===n)n=s;else if(-2===n)n=a-s-2;else if(n<-2)throw"invalid salt length";if(a<s+n+2)throw"data too long";var u="";n>0&&(u=new Array(n),(new ze).nextBytes(u),u=String.fromCharCode.apply(String,u));var c=dn(h(pn("\0\0\0\0\0\0\0\0"+i+u))),f=[];for(r=0;r<a-n-s-2;r+=1)f[r]=0;var l=String.fromCharCode.apply(String,f)+""+u,d=Tn(c,l.length,h),p=[];for(r=0;r<l.length;r+=1)p[r]=l.charCodeAt(r)^d.charCodeAt(r);var g=65280>>8*a-o&255;for(p[0]&=~g,r=0;r<s;r++)p.push(c.charCodeAt(r));return p.push(188),Cn(this.doPrivate(new pe(p)).toString(16),this.n.bitLength())},Ge.prototype.verify=function(t,e){var n=Ye(e=(e=e.replace(An,"")).replace(/[ \n]+/g,""),16);if(n.bitLength()>this.n.bitLength())return 0;var r=Pn(this.doPublic(n).toString(16).replace(/^1f+00/,""));if(0==r.length)return!1;var i,s=r[0];return r[1]==(i=t,tn.crypto.Util.hashString(i,s))},Ge.prototype.verifyWithMessageHash=function(t,e){var n=Ye(e=(e=e.replace(An,"")).replace(/[ \n]+/g,""),16);if(n.bitLength()>this.n.bitLength())return 0;var r=Pn(this.doPublic(n).toString(16).replace(/^1f+00/,""));if(0==r.length)return!1;r[0];return r[1]==t},Ge.prototype.verifyPSS=function(t,e,n,r){var i,s=(i=pn(t),tn.crypto.Util.hashHex(i,n));return void 0===r&&(r=-1),this.verifyWithMessageHashPSS(s,e,n,r)},Ge.prototype.verifyWithMessageHashPSS=function(t,e,n,r){var i=new pe(e,16);if(i.bitLength()>this.n.bitLength())return!1;var s,o=function(t){return tn.crypto.Util.hashHex(t,n)},a=dn(t),h=a.length,u=this.n.bitLength()-1,c=Math.ceil(u/8);if(-1===r||void 0===r)r=h;else if(-2===r)r=c-h-2;else if(r<-2)throw"invalid salt length";if(c<h+r+2)throw"data too long";var f=this.doPublic(i).toByteArray();for(s=0;s<f.length;s+=1)f[s]&=255;for(;f.length<c;)f.unshift(0);if(188!==f[c-1])throw"encoded message does not end in 0xbc";var l=(f=String.fromCharCode.apply(String,f)).substr(0,c-h-1),d=f.substr(l.length,h),p=65280>>8*c-u&255;if(0!=(l.charCodeAt(0)&p))throw"bits beyond keysize not zero";var g=Tn(d,l.length,o),y=[];for(s=0;s<l.length;s+=1)y[s]=l.charCodeAt(s)^g.charCodeAt(s);y[0]&=~p;var v=c-h-r-2;for(s=0;s<v;s+=1)if(0!==y[s])throw"leftmost octets not zero";if(1!==y[v])throw"0x01 marker not found";return d===dn(o(pn("\0\0\0\0\0\0\0\0"+a+String.fromCharCode.apply(String,y.slice(-r)))))},Ge.SALT_LEN_HLEN=-1,Ge.SALT_LEN_MAX=-2,Ge.SALT_LEN_RECOVER=-2,Dn.hex2dn=function(t,e){if(void 0===e&&(e=0),"30"!==t.substr(e,2))throw"malformed DN";for(var n=new Array,r=rn.getChildIdx(t,e),i=0;i<r.length;i++)n.push(Dn.hex2rdn(t,r[i]));return"/"+(n=n.map(function(t){return t.replace("/","\\/")})).join("/")},Dn.hex2rdn=function(t,e){if(void 0===e&&(e=0),"31"!==t.substr(e,2))throw"malformed RDN";for(var n=new Array,r=rn.getChildIdx(t,e),i=0;i<r.length;i++)n.push(Dn.hex2attrTypeValue(t,r[i]));return(n=n.map(function(t){return t.replace("+","\\+")})).join("+")},Dn.hex2attrTypeValue=function(t,e){var n=rn,r=n.getV;if(void 0===e&&(e=0),"30"!==t.substr(e,2))throw"malformed attribute type and value";var i=n.getChildIdx(t,e);2!==i.length||t.substr(i[0],2);var s=r(t,i[0]),o=tn.asn1.ASN1Util.oidHexToInt(s);return tn.asn1.x509.OID.oid2atype(o)+"="+dn(r(t,i[1]))},Dn.getPublicKeyFromCertHex=function(t){var e=new Dn;return e.readCertHex(t),e.getPublicKey()},Dn.getPublicKeyFromCertPEM=function(t){var e=new Dn;return e.readCertPEM(t),e.getPublicKey()},Dn.getPublicKeyInfoPropOfCertPEM=function(t){var e,n,r=rn.getVbyList,i={};return i.algparam=null,(e=new Dn).readCertPEM(t),n=e.getPublicKeyHex(),i.keyhex=r(n,0,[1],"03").substr(2),i.algoid=r(n,0,[0,0],"06"),"2a8648ce3d0201"===i.algoid&&(i.algparam=r(n,0,[0,1],"06")),i},Dn.KEYUSAGE_NAME=["digitalSignature","nonRepudiation","keyEncipherment","dataEncipherment","keyAgreement","keyCertSign","cRLSign","encipherOnly","decipherOnly"],void 0!==tn&&tn||(tn={}),void 0!==tn.jws&&tn.jws||(tn.jws={}),tn.jws.JWS=function(){var t=tn.jws.JWS.isSafeJSONString;this.parseJWS=function(e,n){if(void 0===this.parsedJWS||!n&&void 0===this.parsedJWS.sigvalH){var r=e.match(/^([^.]+)\.([^.]+)\.([^.]+)$/);if(null==r)throw"JWS signature is not a form of 'Head.Payload.SigValue'.";var i=r[1],s=r[2],o=r[3],a=i+"."+s;if(this.parsedJWS={},this.parsedJWS.headB64U=i,this.parsedJWS.payloadB64U=s,this.parsedJWS.sigvalB64U=o,this.parsedJWS.si=a,!n){var h=cn(o),u=Ye(h,16);this.parsedJWS.sigvalH=h,this.parsedJWS.sigvalBI=u}var c=nn(i),f=nn(s);if(this.parsedJWS.headS=c,this.parsedJWS.payloadS=f,!t(c,this.parsedJWS,"headP"))throw"malformed JSON string for JWS Head: "+c}}},tn.jws.JWS.sign=function(t,e,n,r,i){var s,o,a,h=tn,u=h.jws.JWS,c=u.readSafeJSONString,f=u.isSafeJSONString,l=h.crypto,d=(l.ECDSA,l.Mac),p=l.Signature,g=JSON;if("string"!=typeof e&&"object"!=typeof e)throw"spHeader must be JSON string or object: "+e;if("object"==typeof e&&(o=e,s=g.stringify(o)),"string"==typeof e){if(!f(s=e))throw"JWS Head is not safe JSON string: "+s;o=c(s)}if(a=n,"object"==typeof n&&(a=g.stringify(n)),""!=t&&null!=t||void 0===o.alg||(t=o.alg),""!=t&&null!=t&&void 0===o.alg&&(o.alg=t,s=g.stringify(o)),t!==o.alg)throw"alg and sHeader.alg doesn't match: "+t+"!="+o.alg;var y=null;if(void 0===u.jwsalg2sigalg[t])throw"unsupported alg name: "+t;y=u.jwsalg2sigalg[t];var v=en(s)+"."+en(a),m="";if("Hmac"==y.substr(0,4)){if(void 0===r)throw"mac key shall be specified for HS* alg";var w=new d({alg:y,prov:"cryptojs",pass:r});w.updateString(v),m=w.doFinal()}else if(-1!=y.indexOf("withECDSA")){(S=new p({alg:y})).init(r,i),S.updateString(v);var b=S.sign();m=tn.crypto.ECDSA.asn1SigToConcatSig(b)}else{var S;if("none"!=y)(S=new p({alg:y})).init(r,i),S.updateString(v),m=S.sign()}return v+"."+un(m)},tn.jws.JWS.verify=function(t,e,n){var r,i=tn,s=i.jws.JWS,o=s.readSafeJSONString,a=i.crypto,h=a.ECDSA,u=a.Mac,c=a.Signature;r=Ge;var f=t.split(".");if(3!==f.length)return!1;var l=f[0]+"."+f[1],d=cn(f[2]),p=o(nn(f[0])),g=null,y=null;if(void 0===p.alg)throw"algorithm not specified in header";if((y=(g=p.alg).substr(0,2),null!=n&&"[object Array]"===Object.prototype.toString.call(n)&&n.length>0)&&-1==(":"+n.join(":")+":").indexOf(":"+g+":"))throw"algorithm '"+g+"' not accepted in the list";if("none"!=g&&null===e)throw"key shall be specified to verify.";if("string"==typeof e&&-1!=e.indexOf("-----BEGIN ")&&(e=Fn.getKey(e)),!("RS"!=y&&"PS"!=y||e instanceof r))throw"key shall be a RSAKey obj for RS* and PS* algs";if("ES"==y&&!(e instanceof h))throw"key shall be a ECDSA obj for ES* algs";var v=null;if(void 0===s.jwsalg2sigalg[p.alg])throw"unsupported alg name: "+g;if("none"==(v=s.jwsalg2sigalg[g]))throw"not supported";if("Hmac"==v.substr(0,4)){if(void 0===e)throw"hexadecimal key shall be specified for HMAC";var m=new u({alg:v,pass:e});return m.updateString(l),d==m.doFinal()}if(-1!=v.indexOf("withECDSA")){var w,b=null;try{b=h.concatSigToASN1Sig(d)}catch(t){return!1}return(w=new c({alg:v})).init(e),w.updateString(l),w.verify(b)}return(w=new c({alg:v})).init(e),w.updateString(l),w.verify(d)},tn.jws.JWS.parse=function(t){var e,n,r,i=t.split("."),s={};if(2!=i.length&&3!=i.length)throw"malformed sJWS: wrong number of '.' splitted elements";return e=i[0],n=i[1],3==i.length&&(r=i[2]),s.headerObj=tn.jws.JWS.readSafeJSONString(nn(e)),s.payloadObj=tn.jws.JWS.readSafeJSONString(nn(n)),s.headerPP=JSON.stringify(s.headerObj,null,"  "),null==s.payloadObj?s.payloadPP=nn(n):s.payloadPP=JSON.stringify(s.payloadObj,null,"  "),void 0!==r&&(s.sigHex=cn(r)),s},tn.jws.JWS.verifyJWT=function(t,e,n){var r=tn.jws,i=r.JWS,s=i.readSafeJSONString,o=i.inArray,a=i.includedArray,h=t.split("."),u=h[0],c=h[1],f=(cn(h[2]),s(nn(u))),l=s(nn(c));if(void 0===f.alg)return!1;if(void 0===n.alg)throw"acceptField.alg shall be specified";if(!o(f.alg,n.alg))return!1;if(void 0!==l.iss&&"object"==typeof n.iss&&!o(l.iss,n.iss))return!1;if(void 0!==l.sub&&"object"==typeof n.sub&&!o(l.sub,n.sub))return!1;if(void 0!==l.aud&&"object"==typeof n.aud)if("string"==typeof l.aud){if(!o(l.aud,n.aud))return!1}else if("object"==typeof l.aud&&!a(l.aud,n.aud))return!1;var d=r.IntDate.getNow();return void 0!==n.verifyAt&&"number"==typeof n.verifyAt&&(d=n.verifyAt),void 0!==n.gracePeriod&&"number"==typeof n.gracePeriod||(n.gracePeriod=0),!(void 0!==l.exp&&"number"==typeof l.exp&&l.exp+n.gracePeriod<d)&&(!(void 0!==l.nbf&&"number"==typeof l.nbf&&d<l.nbf-n.gracePeriod)&&(!(void 0!==l.iat&&"number"==typeof l.iat&&d<l.iat-n.gracePeriod)&&((void 0===l.jti||void 0===n.jti||l.jti===n.jti)&&!!i.verify(t,e,n.alg))))},tn.jws.JWS.includedArray=function(t,e){var n=tn.jws.JWS.inArray;if(null===t)return!1;if("object"!=typeof t)return!1;if("number"!=typeof t.length)return!1;for(var r=0;r<t.length;r++)if(!n(t[r],e))return!1;return!0},tn.jws.JWS.inArray=function(t,e){if(null===e)return!1;if("object"!=typeof e)return!1;if("number"!=typeof e.length)return!1;for(var n=0;n<e.length;n++)if(e[n]==t)return!0;return!1},tn.jws.JWS.jwsalg2sigalg={HS256:"HmacSHA256",HS384:"HmacSHA384",HS512:"HmacSHA512",RS256:"SHA256withRSA",RS384:"SHA384withRSA",RS512:"SHA512withRSA",ES256:"SHA256withECDSA",ES384:"SHA384withECDSA",PS256:"SHA256withRSAandMGF1",PS384:"SHA384withRSAandMGF1",PS512:"SHA512withRSAandMGF1",none:"none"},tn.jws.JWS.isSafeJSONString=function(t,e,n){var r=null;try{return"object"!=typeof(r=Qe(t))?0:r.constructor===Array?0:(e&&(e[n]=r),1)}catch(t){return 0}},tn.jws.JWS.readSafeJSONString=function(t){var e=null;try{return"object"!=typeof(e=Qe(t))?null:e.constructor===Array?null:e}catch(t){return null}},tn.jws.JWS.getEncodedSignatureValueFromJWS=function(t){var e=t.match(/^[^.]+\.[^.]+\.([^.]+)$/);if(null==e)throw"JWS signature is not a form of 'Head.Payload.SigValue'.";return e[1]},tn.jws.JWS.getJWKthumbprint=function(t){if("RSA"!==t.kty&&"EC"!==t.kty&&"oct"!==t.kty)throw"unsupported algorithm for JWK Thumprint";var e="{";if("RSA"===t.kty){if("string"!=typeof t.n||"string"!=typeof t.e)throw"wrong n and e value for RSA key";e+='"e":"'+t.e+'",',e+='"kty":"'+t.kty+'",',e+='"n":"'+t.n+'"}'}else if("EC"===t.kty){if("string"!=typeof t.crv||"string"!=typeof t.x||"string"!=typeof t.y)throw"wrong crv, x and y value for EC key";e+='"crv":"'+t.crv+'",',e+='"kty":"'+t.kty+'",',e+='"x":"'+t.x+'",',e+='"y":"'+t.y+'"}'}else if("oct"===t.kty){if("string"!=typeof t.k)throw"wrong k value for oct(symmetric) key";e+='"kty":"'+t.kty+'",',e+='"k":"'+t.k+'"}'}var n=pn(e);return un(tn.crypto.Util.hashHex(n,"sha256"))},tn.jws.IntDate={},tn.jws.IntDate.get=function(t){var e=tn.jws.IntDate,n=e.getNow,r=e.getZulu;if("now"==t)return n();if("now + 1hour"==t)return n()+3600;if("now + 1day"==t)return n()+86400;if("now + 1month"==t)return n()+2592e3;if("now + 1year"==t)return n()+31536e3;if(t.match(/Z$/))return r(t);if(t.match(/^[0-9]+$/))return parseInt(t);throw"unsupported format: "+t},tn.jws.IntDate.getZulu=function(t){return mn(t)},tn.jws.IntDate.getNow=function(){return~~(new Date/1e3)},tn.jws.IntDate.intDate2UTCString=function(t){return new Date(1e3*t).toUTCString()},tn.jws.IntDate.intDate2Zulu=function(t){var e=new Date(1e3*t);return("0000"+e.getUTCFullYear()).slice(-4)+("00"+(e.getUTCMonth()+1)).slice(-2)+("00"+e.getUTCDate()).slice(-2)+("00"+e.getUTCHours()).slice(-2)+("00"+e.getUTCMinutes()).slice(-2)+("00"+e.getUTCSeconds()).slice(-2)+"Z"},void 0!==tn&&tn||(tn={}),void 0!==tn.jws&&tn.jws||(tn.jws={}),tn.jws.JWSJS=function(){var t=tn.jws.JWS,e=t.readSafeJSONString;this.aHeader=[],this.sPayload="",this.aSignature=[],this.init=function(){this.aHeader=[],this.sPayload=void 0,this.aSignature=[]},this.initWithJWS=function(t){this.init();var e=t.split(".");if(3!=e.length)throw"malformed input JWS";this.aHeader.push(e[0]),this.sPayload=e[1],this.aSignature.push(e[2])},this.addSignature=function(t,e,n,r){if(void 0===this.sPayload||null===this.sPayload)throw"there's no JSON-JS signature to add.";var i=this.aHeader.length;if(this.aHeader.length!=this.aSignature.length)throw"aHeader.length != aSignature.length";try{var s=tn.jws.JWS.sign(t,e,this.sPayload,n,r).split(".");s[0],s[2];this.aHeader.push(s[0]),this.aSignature.push(s[2])}catch(t){throw this.aHeader.length>i&&this.aHeader.pop(),this.aSignature.length>i&&this.aSignature.pop(),"addSignature failed: "+t}},this.verifyAll=function(t){if(this.aHeader.length!==t.length||this.aSignature.length!==t.length)return!1;for(var e=0;e<t.length;e++){var n=t[e];if(2!==n.length)return!1;if(!1===this.verifyNth(e,n[0],n[1]))return!1}return!0},this.verifyNth=function(e,n,r){if(this.aHeader.length<=e||this.aSignature.length<=e)return!1;var i=this.aHeader[e],s=this.aSignature[e],o=i+"."+this.sPayload+"."+s,a=!1;try{a=t.verify(o,n,r)}catch(t){return!1}return a},this.readJWSJS=function(t){if("string"==typeof t){var n=e(t);if(null==n)throw"argument is not safe JSON object string";this.aHeader=n.headers,this.sPayload=n.payload,this.aSignature=n.signatures}else try{if(!(t.headers.length>0))throw"malformed header";if(this.aHeader=t.headers,"string"!=typeof t.payload)throw"malformed signatures";if(this.sPayload=t.payload,!(t.signatures.length>0))throw"malformed signatures";this.aSignatures=t.signatures}catch(t){throw"malformed JWS-JS JSON object: "+t}},this.getJSON=function(){return{headers:this.aHeader,payload:this.sPayload,signatures:this.aSignature}},this.isEmpty=function(){return 0==this.aHeader.length?1:0}};tn.crypto.ECDSA,tn.crypto.DSA,tn.crypto.Signature;var In=tn.crypto.MessageDigest,Rn=(tn.crypto.Mac,tn.crypto.Cipher,Fn),Bn=vn,Hn=(tn.crypto,tn.asn1),_n=tn.jws,kn=(tn.lang,{apiRoot:"http://127.0.0.1:4944/api",request:function(t){t.headers=void 0!==t.headers?t.json:{"Content-Type":"application/json"},t.method="POST";var e=void 0!==t.uri?t.uri:this.apiRoot;return t.apiMethod&&(t.uri+="/"+t.apiMethod),t.apiIdType&&(t.uri+="/"+encodeURIComponent(t.apiIdType)),t.apiId&&(t.uri+="/"+encodeURIComponent(t.apiId)),t.apiAction&&(t.uri+="/"+t.apiAction),rt(e,t)},getJwt:function(t,e){var n=Math.floor(Date.now()/1e3)+60;return e=nt({exp:n},e),_n.sign({header:{typ:"JWT",alg:"ES256"},payload:e,privateKey:t})}}),Nn=s.JSON||(s.JSON={stringify:JSON.stringify}),On=function(t){return Nn.stringify.apply(Nn,arguments)},jn=n(r(function(t){t.exports={default:On,__esModule:!0}})),Ln=n(r(function(t,e){e.__esModule=!0,e.default=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}})),Mn=b,Vn={},Kn=f?Object.defineProperties:function(t,e){u(t);for(var n,r=J(e),i=r.length,s=0;i>s;)m.f(t,n=r[s++],e[n]);return t},Un=i.document,qn=Un&&Un.documentElement,zn=q("IE_PROTO"),Yn=function(){},Wn=function(){var t,e=p("iframe"),n=G.length;for(e.style.display="none",qn.appendChild(e),e.src="javascript:",(t=e.contentWindow.document).open(),t.write("<script>document.F=Object<\/script>"),t.close(),Wn=t.F;n--;)delete Wn.prototype[G[n]];return Wn()},Gn=Object.create||function(t,e){var n;return null!==t?(Yn.prototype=u(t),n=new Yn,Yn.prototype=null,n[zn]=t):n=Wn(),void 0===e?n:Kn(n,e)},Jn=r(function(t){var e=L("wks"),n=i.Symbol,r="function"==typeof n;(t.exports=function(t){return e[t]||(e[t]=r&&n[t]||(r?n:K)("Symbol."+t))}).store=e}),Xn=m.f,$n=Jn("toStringTag"),Zn=function(t,e,n){t&&!A(t=n?t:t.prototype,$n)&&Xn(t,$n,{configurable:!0,value:e})},Qn={};b(Qn,Jn("iterator"),function(){return this});var tr,er=function(t,e,n){t.prototype=Gn(Qn,{next:w(1,n)}),Zn(t,e+" Iterator")},nr=q("IE_PROTO"),rr=Object.prototype,ir=Object.getPrototypeOf||function(t){return t=Z(t),A(t,nr)?t[nr]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?rr:null},sr=Jn("iterator"),or=!([].keys&&"next"in[].keys()),ar=function(){return this},hr=function(t,e,n,r,i,s,o){er(n,e,r);var a,h,u,c=function(t){if(!or&&t in p)return p[t];switch(t){case"keys":case"values":return function(){return new n(this,t)}}return function(){return new n(this,t)}},f=e+" Iterator",l="values"==i,d=!1,p=t.prototype,g=p[sr]||p["@@iterator"]||i&&p[i],y=!or&&g||c(i),v=i?l?c("entries"):y:void 0,m="Array"==e&&p.entries||g;if(m&&(u=ir(m.call(new t)))!==Object.prototype&&u.next&&Zn(u,f,!0),l&&g&&"values"!==g.name&&(d=!0,y=function(){return g.call(this)}),o&&(or||d||!p[sr])&&b(p,sr,y),Vn[e]=y,Vn[f]=ar,i)if(a={values:l?y:c("values"),keys:s?y:c("keys"),entries:v},o)for(h in a)h in p||Mn(p,h,a[h]);else E(E.P+E.F*(or||d),e,a);return a},ur=(tr=!0,function(t,e){var n,r,i=String(D(t)),s=H(e),o=i.length;return s<0||s>=o?tr?"":void 0:(n=i.charCodeAt(s))<55296||n>56319||s+1===o||(r=i.charCodeAt(s+1))<56320||r>57343?tr?i.charAt(s):n:tr?i.slice(s,s+2):r-56320+(n-55296<<10)+65536});hr(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,e=this._t,n=this._i;return n>=e.length?{value:void 0,done:!0}:(t=ur(e,n),this._i+=t.length,{value:t,done:!1})});var cr=function(t,e){return{value:e,done:!!t}};hr(Array,"Array",function(t,e){this._t=I(t),this._i=0,this._k=e},function(){var t=this._t,e=this._k,n=this._i++;return!t||n>=t.length?(this._t=void 0,cr(1)):cr(0,"keys"==e?n:"values"==e?t[n]:[n,t[n]])},"values");Vn.Arguments=Vn.Array;for(var fr=Jn("toStringTag"),lr="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),dr=0;dr<lr.length;dr++){var pr=lr[dr],gr=i[pr],yr=gr&&gr.prototype;yr&&!yr[fr]&&b(yr,fr,pr),Vn[pr]=Vn.Array}var vr={f:Jn},mr=vr.f("iterator"),wr=r(function(t){t.exports={default:mr,__esModule:!0}});n(wr);var br=r(function(t){var e=K("meta"),n=m.f,r=0,i=Object.isExtensible||function(){return!0},s=!c(function(){return i(Object.preventExtensions({}))}),o=function(t){n(t,e,{value:{i:"O"+ ++r,w:{}}})},a=t.exports={KEY:e,NEED:!1,fastKey:function(t,n){if(!h(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!A(t,e)){if(!i(t))return"F";if(!n)return"E";o(t)}return t[e].i},getWeak:function(t,n){if(!A(t,e)){if(!i(t))return!0;if(!n)return!1;o(t)}return t[e].w},onFreeze:function(t){return s&&a.NEED&&i(t)&&!A(t,e)&&o(t),t}}}),Sr=(br.KEY,br.NEED,br.fastKey,br.getWeak,br.onFreeze,m.f),xr=function(t){var e=s.Symbol||(s.Symbol={});"_"==t.charAt(0)||t in e||Sr(e,t,{value:vr.f(t)})},Er=Array.isArray||function(t){return"Array"==T(t)},Fr=G.concat("length","prototype"),Ar={f:Object.getOwnPropertyNames||function(t){return W(t,Fr)}},Cr=Ar.f,Tr={}.toString,Pr="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],Dr={f:function(t){return Pr&&"[object Window]"==Tr.call(t)?function(t){try{return Cr(t)}catch(t){return Pr.slice()}}(t):Cr(I(t))}},Ir=Object.getOwnPropertyDescriptor,Rr={f:f?Ir:function(t,e){if(t=I(t),e=y(e,!0),g)try{return Ir(t,e)}catch(t){}if(A(t,e))return w(!$.f.call(t,e),t[e])}},Br=br.KEY,Hr=Rr.f,_r=m.f,kr=Dr.f,Nr=i.Symbol,Or=i.JSON,jr=Or&&Or.stringify,Lr=Jn("_hidden"),Mr=Jn("toPrimitive"),Vr={}.propertyIsEnumerable,Kr=L("symbol-registry"),Ur=L("symbols"),qr=L("op-symbols"),zr=Object.prototype,Yr="function"==typeof Nr,Wr=i.QObject,Gr=!Wr||!Wr.prototype||!Wr.prototype.findChild,Jr=f&&c(function(){return 7!=Gn(_r({},"a",{get:function(){return _r(this,"a",{value:7}).a}})).a})?function(t,e,n){var r=Hr(zr,e);r&&delete zr[e],_r(t,e,n),r&&t!==zr&&_r(zr,e,r)}:_r,Xr=function(t){var e=Ur[t]=Gn(Nr.prototype);return e._k=t,e},$r=Yr&&"symbol"==typeof Nr.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof Nr},Zr=function(t,e,n){return t===zr&&Zr(qr,e,n),u(t),e=y(e,!0),u(n),A(Ur,e)?(n.enumerable?(A(t,Lr)&&t[Lr][e]&&(t[Lr][e]=!1),n=Gn(n,{enumerable:w(0,!1)})):(A(t,Lr)||_r(t,Lr,w(1,{})),t[Lr][e]=!0),Jr(t,e,n)):_r(t,e,n)},Qr=function(t,e){u(t);for(var n,r=function(t){var e=J(t),n=X.f;if(n)for(var r,i=n(t),s=$.f,o=0;i.length>o;)s.call(t,r=i[o++])&&e.push(r);return e}(e=I(e)),i=0,s=r.length;s>i;)Zr(t,n=r[i++],e[n]);return t},ti=function(t){var e=Vr.call(this,t=y(t,!0));return!(this===zr&&A(Ur,t)&&!A(qr,t))&&(!(e||!A(this,t)||!A(Ur,t)||A(this,Lr)&&this[Lr][t])||e)},ei=function(t,e){if(t=I(t),e=y(e,!0),t!==zr||!A(Ur,e)||A(qr,e)){var n=Hr(t,e);return!n||!A(Ur,e)||A(t,Lr)&&t[Lr][e]||(n.enumerable=!0),n}},ni=function(t){for(var e,n=kr(I(t)),r=[],i=0;n.length>i;)A(Ur,e=n[i++])||e==Lr||e==Br||r.push(e);return r},ri=function(t){for(var e,n=t===zr,r=kr(n?qr:I(t)),i=[],s=0;r.length>s;)!A(Ur,e=r[s++])||n&&!A(zr,e)||i.push(Ur[e]);return i};Yr||(Mn((Nr=function(){if(this instanceof Nr)throw TypeError("Symbol is not a constructor!");var t=K(arguments.length>0?arguments[0]:void 0),e=function(n){this===zr&&e.call(qr,n),A(this,Lr)&&A(this[Lr],t)&&(this[Lr][t]=!1),Jr(this,t,w(1,n))};return f&&Gr&&Jr(zr,t,{configurable:!0,set:e}),Xr(t)}).prototype,"toString",function(){return this._k}),Rr.f=ei,m.f=Zr,Ar.f=Dr.f=ni,$.f=ti,X.f=ri,vr.f=function(t){return Xr(Jn(t))}),E(E.G+E.W+E.F*!Yr,{Symbol:Nr});for(var ii="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),si=0;ii.length>si;)Jn(ii[si++]);for(var oi=J(Jn.store),ai=0;oi.length>ai;)xr(oi[ai++]);E(E.S+E.F*!Yr,"Symbol",{for:function(t){return A(Kr,t+="")?Kr[t]:Kr[t]=Nr(t)},keyFor:function(t){if(!$r(t))throw TypeError(t+" is not a symbol!");for(var e in Kr)if(Kr[e]===t)return e},useSetter:function(){Gr=!0},useSimple:function(){Gr=!1}}),E(E.S+E.F*!Yr,"Object",{create:function(t,e){return void 0===e?Gn(t):Qr(Gn(t),e)},defineProperty:Zr,defineProperties:Qr,getOwnPropertyDescriptor:ei,getOwnPropertyNames:ni,getOwnPropertySymbols:ri}),Or&&E(E.S+E.F*(!Yr||c(function(){var t=Nr();return"[null]"!=jr([t])||"{}"!=jr({a:t})||"{}"!=jr(Object(t))})),"JSON",{stringify:function(t){for(var e,n,r=[t],i=1;arguments.length>i;)r.push(arguments[i++]);if(n=e=r[1],(h(e)||void 0!==t)&&!$r(t))return Er(e)||(e=function(t,e){if("function"==typeof n&&(e=n.call(this,t,e)),!$r(e))return e}),r[1]=e,jr.apply(Or,r)}}),Nr.prototype[Mr]||b(Nr.prototype,Mr,Nr.prototype.valueOf),Zn(Nr,"Symbol"),Zn(Math,"Math",!0),Zn(i.JSON,"JSON",!0),xr("asyncIterator"),xr("observable");var hi=s.Symbol,ui=r(function(t){t.exports={default:hi,__esModule:!0}});n(ui);var ci=r(function(t,e){e.__esModule=!0;var n=s(wr),r=s(ui),i="function"==typeof r.default&&"symbol"==typeof n.default?function(t){return typeof t}:function(t){return t&&"function"==typeof r.default&&t.constructor===r.default&&t!==r.default.prototype?"symbol":typeof t};function s(t){return t&&t.__esModule?t:{default:t}}e.default="function"==typeof r.default&&"symbol"===i(n.default)?function(t){return void 0===t?"undefined":i(t)}:function(t){return t&&"function"==typeof r.default&&t.constructor===r.default&&t!==r.default.prototype?"symbol":void 0===t?"undefined":i(t)}}),fi=n(ci),li=n(r(function(t,e){e.__esModule=!0;var n,r=(n=ci)&&n.__esModule?n:{default:n};e.default=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":(0,r.default)(e))&&"function"!=typeof e?t:e}})),di=function(t,e){if(u(t),!h(e)&&null!==e)throw TypeError(e+": can't set as prototype!")},pi={set:Object.setPrototypeOf||("__proto__"in{}?function(t,e,n){try{(n=a(Function.call,Rr.f(Object.prototype,"__proto__").set,2))(t,[]),e=!(t instanceof Array)}catch(t){e=!0}return function(t,r){return di(t,r),e?t.__proto__=r:n(t,r),t}}({},!1):void 0),check:di};E(E.S,"Object",{setPrototypeOf:pi.set});var gi=s.Object.setPrototypeOf,yi=r(function(t){t.exports={default:gi,__esModule:!0}});n(yi),E(E.S,"Object",{create:Gn});var vi=s.Object,mi=function(t,e){return vi.create(t,e)},wi=r(function(t){t.exports={default:mi,__esModule:!0}});n(wi);var bi,Si,xi,Ei=n(r(function(t,e){e.__esModule=!0;var n=s(yi),r=s(wi),i=s(ci);function s(t){return t&&t.__esModule?t:{default:t}}e.default=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":(0,i.default)(e)));t.prototype=(0,r.default)(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(n.default?(0,n.default)(t,e):t.__proto__=e)}})),Fi=Jn("toStringTag"),Ai="Arguments"==T(function(){return arguments}()),Ci=function(t){var e,n,r;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,e){try{return t[e]}catch(t){}}(e=Object(t),Fi))?n:Ai?T(e):"Object"==(r=T(e))&&"function"==typeof e.callee?"Arguments":r},Ti=function(t,e,n,r){try{return r?e(u(n)[0],n[1]):e(n)}catch(e){var i=t.return;throw void 0!==i&&u(i.call(t)),e}},Pi=Jn("iterator"),Di=Array.prototype,Ii=Jn("iterator"),Ri=s.getIteratorMethod=function(t){if(null!=t)return t[Ii]||t["@@iterator"]||Vn[Ci(t)]},Bi=r(function(t){var e={},n={},r=t.exports=function(t,r,i,s,o){var h,c,f,l,d,p=o?function(){return t}:Ri(t),g=a(i,s,r?2:1),y=0;if("function"!=typeof p)throw TypeError(t+" is not iterable!");if(void 0===(d=p)||Vn.Array!==d&&Di[Pi]!==d){for(f=p.call(t);!(c=f.next()).done;)if((l=Ti(f,g,c.value,r))===e||l===n)return l}else for(h=k(t.length);h>y;y++)if((l=r?g(u(c=t[y])[0],c[1]):g(t[y]))===e||l===n)return l};r.BREAK=e,r.RETURN=n}),Hi=Jn("species"),_i=function(t,e){var n,r=u(t).constructor;return void 0===r||null==(n=u(r)[Hi])?e:o(n)},ki=i.process,Ni=i.setImmediate,Oi=i.clearImmediate,ji=i.MessageChannel,Li=i.Dispatch,Mi=0,Vi={},Ki=function(){var t=+this;if(Vi.hasOwnProperty(t)){var e=Vi[t];delete Vi[t],e()}},Ui=function(t){Ki.call(t.data)};Ni&&Oi||(Ni=function(t){for(var e=[],n=1;arguments.length>n;)e.push(arguments[n++]);return Vi[++Mi]=function(){!function(t,e,n){var r=void 0===n;switch(e.length){case 0:return r?t():t.call(n);case 1:return r?t(e[0]):t.call(n,e[0]);case 2:return r?t(e[0],e[1]):t.call(n,e[0],e[1]);case 3:return r?t(e[0],e[1],e[2]):t.call(n,e[0],e[1],e[2]);case 4:return r?t(e[0],e[1],e[2],e[3]):t.call(n,e[0],e[1],e[2],e[3])}t.apply(n,e)}("function"==typeof t?t:Function(t),e)},bi(Mi),Mi},Oi=function(t){delete Vi[t]},"process"==T(ki)?bi=function(t){ki.nextTick(a(Ki,t,1))}:Li&&Li.now?bi=function(t){Li.now(a(Ki,t,1))}:ji?(xi=(Si=new ji).port2,Si.port1.onmessage=Ui,bi=a(xi.postMessage,xi,1)):i.addEventListener&&"function"==typeof postMessage&&!i.importScripts?(bi=function(t){i.postMessage(t+"","*")},i.addEventListener("message",Ui,!1)):bi="onreadystatechange"in p("script")?function(t){qn.appendChild(p("script")).onreadystatechange=function(){qn.removeChild(this),Ki.call(t)}}:function(t){setTimeout(a(Ki,t,1),0)});var qi={set:Ni,clear:Oi},zi=qi.set,Yi=i.MutationObserver||i.WebKitMutationObserver,Wi=i.process,Gi=i.Promise,Ji="process"==T(Wi);function Xi(t){var e,n;this.promise=new t(function(t,r){if(void 0!==e||void 0!==n)throw TypeError("Bad Promise constructor");e=t,n=r}),this.resolve=o(e),this.reject=o(n)}var $i={f:function(t){return new Xi(t)}},Zi=function(t){try{return{e:!1,v:t()}}catch(t){return{e:!0,v:t}}},Qi=function(t,e){if(u(t),h(e)&&e.constructor===t)return e;var n=$i.f(t);return(0,n.resolve)(e),n.promise},ts=Jn("species"),es=Jn("iterator"),ns=!1;try{[7][es]().return=function(){ns=!0}}catch(t){}var rs,is,ss,os,as,hs,us=qi.set,cs=function(){var t,e,n,r=function(){var r,i;for(Ji&&(r=Wi.domain)&&r.exit();t;){i=t.fn,t=t.next;try{i()}catch(r){throw t?n():e=void 0,r}}e=void 0,r&&r.enter()};if(Ji)n=function(){Wi.nextTick(r)};else if(!Yi||i.navigator&&i.navigator.standalone)if(Gi&&Gi.resolve){var s=Gi.resolve();n=function(){s.then(r)}}else n=function(){zi.call(i,r)};else{var o=!0,a=document.createTextNode("");new Yi(r).observe(a,{characterData:!0}),n=function(){a.data=o=!o}}return function(r){var i={fn:r,next:void 0};e&&(e.next=i),t||(t=i,n()),e=i}}(),fs=i.TypeError,ls=i.process,ds=i.Promise,ps="process"==Ci(ls),gs=function(){},ys=is=$i.f,vs=!!function(){try{var t=ds.resolve(1),e=(t.constructor={})[Jn("species")]=function(t){t(gs,gs)};return(ps||"function"==typeof PromiseRejectionEvent)&&t.then(gs)instanceof e}catch(t){}}(),ms=function(t){var e;return!(!h(t)||"function"!=typeof(e=t.then))&&e},ws=function(t,e){if(!t._n){t._n=!0;var n=t._c;cs(function(){for(var r=t._v,i=1==t._s,s=0,o=function(e){var n,s,o=i?e.ok:e.fail,a=e.resolve,h=e.reject,u=e.domain;try{o?(i||(2==t._h&&xs(t),t._h=1),!0===o?n=r:(u&&u.enter(),n=o(r),u&&u.exit()),n===e.promise?h(fs("Promise-chain cycle")):(s=ms(n))?s.call(n,a,h):a(n)):h(r)}catch(t){h(t)}};n.length>s;)o(n[s++]);t._c=[],t._n=!1,e&&!t._h&&bs(t)})}},bs=function(t){us.call(i,function(){var e,n,r,s=t._v,o=Ss(t);if(o&&(e=Zi(function(){ps?ls.emit("unhandledRejection",s,t):(n=i.onunhandledrejection)?n({promise:t,reason:s}):(r=i.console)&&r.error&&r.error("Unhandled promise rejection",s)}),t._h=ps||Ss(t)?2:1),t._a=void 0,o&&e.e)throw e.v})},Ss=function(t){return 1!==t._h&&0===(t._a||t._c).length},xs=function(t){us.call(i,function(){var e;ps?ls.emit("rejectionHandled",t):(e=i.onrejectionhandled)&&e({promise:t,reason:t._v})})},Es=function(t){var e=this;e._d||(e._d=!0,(e=e._w||e)._v=t,e._s=2,e._a||(e._a=e._c.slice()),ws(e,!0))},Fs=function(t){var e,n=this;if(!n._d){n._d=!0,n=n._w||n;try{if(n===t)throw fs("Promise can't be resolved itself");(e=ms(t))?cs(function(){var r={_w:n,_d:!1};try{e.call(t,a(Fs,r,1),a(Es,r,1))}catch(t){Es.call(r,t)}}):(n._v=t,n._s=1,ws(n,!1))}catch(t){Es.call({_w:n,_d:!1},t)}}};vs||(ds=function(t){!function(t,e,n,r){if(!(t instanceof e)||void 0!==r&&r in t)throw TypeError(n+": incorrect invocation!")}(this,ds,"Promise","_h"),o(t),rs.call(this);try{t(a(Fs,this,1),a(Es,this,1))}catch(t){Es.call(this,t)}},(rs=function(t){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=function(t,e,n){for(var r in e)n&&t[r]?t[r]=e[r]:b(t,r,e[r]);return t}(ds.prototype,{then:function(t,e){var n=ys(_i(this,ds));return n.ok="function"!=typeof t||t,n.fail="function"==typeof e&&e,n.domain=ps?ls.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&ws(this,!1),n.promise},catch:function(t){return this.then(void 0,t)}}),ss=function(){var t=new rs;this.promise=t,this.resolve=a(Fs,t,1),this.reject=a(Es,t,1)},$i.f=ys=function(t){return t===ds||t===os?new ss(t):is(t)}),E(E.G+E.W+E.F*!vs,{Promise:ds}),Zn(ds,"Promise"),hs="function"==typeof s[as="Promise"]?s[as]:i[as],f&&hs&&!hs[ts]&&m.f(hs,ts,{configurable:!0,get:function(){return this}}),os=s.Promise,E(E.S+E.F*!vs,"Promise",{reject:function(t){var e=ys(this);return(0,e.reject)(t),e.promise}}),E(E.S+!0*E.F,"Promise",{resolve:function(t){return Qi(this===os?ds:this,t)}}),E(E.S+E.F*!(vs&&function(t,e){if(!e&&!ns)return!1;var n=!1;try{var r=[7],i=r[es]();i.next=function(){return{done:n=!0}},r[es]=function(){return i},t(r)}catch(t){}return n}(function(t){ds.all(t).catch(gs)})),"Promise",{all:function(t){var e=this,n=ys(e),r=n.resolve,i=n.reject,s=Zi(function(){var n=[],s=0,o=1;Bi(t,!1,function(t){var a=s++,h=!1;n.push(void 0),o++,e.resolve(t).then(function(t){h||(h=!0,n[a]=t,--o||r(n))},i)}),--o||r(n)});return s.e&&i(s.v),n.promise},race:function(t){var e=this,n=ys(e),r=n.reject,i=Zi(function(){Bi(t,!1,function(t){e.resolve(t).then(n.resolve,r)})});return i.e&&r(i.v),n.promise}}),E(E.P+E.R,"Promise",{finally:function(t){var e=_i(this,s.Promise||i.Promise),n="function"==typeof t;return this.then(n?function(n){return Qi(e,t()).then(function(){return n})}:t,n?function(n){return Qi(e,t()).then(function(){throw n})}:t)}}),E(E.S,"Promise",{try:function(t){var e=$i.f(this),n=Zi(t);return(n.e?e.reject:e.resolve)(n.v),e.promise}});var As=s.Promise,Cs=r(function(t){t.exports={default:As,__esModule:!0}}),Ts=n(Cs),Ps=void 0,Ds=!1;try{Ds="[object process]"===Object.prototype.toString.call(it.process)}catch(t){}var Is={isNode:Ds,getPubKeyASN1:function(t){"P-256"===t.curveName&&(t.curveName="secp256r1");var e=Rn.getPEM(t);return Bn(e)},generateKeyPair:function(){return Rn.generateKeypair("EC","secp256r1")},jwkToPrvKey:function(t){var e=Rn.getKey(t);return e.pubKeyASN1=this.getPubKeyASN1(e),e.keyID=this.getHash(e.pubKeyASN1),e},generateKey:function(){var t=this.generateKeyPair();return t.prvKeyObj.pubKeyASN1=this.getPubKeyASN1(t.pubKeyObj),t.prvKeyObj.keyID=this.getHash(t.prvKeyObj.pubKeyASN1),t.prvKeyObj},prvKeyToJwk:function(t){return Rn.getJWKFromKey(t)},getHash:function(t){return new mt(new In({alg:"sha256",prov:"cryptojs"}).digestString(t),"hex").toString("base64")},_generateAndSerializeKey:function(){return Ps=this.generateKey(),jn(this.prvKeyToJwk(Ps))},getDefaultKey:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:".";if(Ps)return Ps;if(Ds){var e=require("fs"),n=t+"/private.key";if(e.existsSync(n)){var r=e.readFileSync(n,"utf8"),i=JSON.parse(r);Ps=this.jwkToPrvKey(i)}else e.writeFile(n,this._generateAndSerializeKey()),e.chmodSync(n,400)}else{var s=window.localStorage.getItem("identifi.myKey");s?Ps=this.jwkToPrvKey(JSON.parse(s)):window.localStorage.setItem("identifi.myKey",this._generateAndSerializeKey())}return Ps},timeoutPromise:function(t,e){return Ts.race([t,new Ts(function(t){setTimeout(function(){t()},e)})])}},Rs=r(function(t){!function(e){var n,r=Object.prototype,i=r.hasOwnProperty,s="function"==typeof Symbol?Symbol:{},o=s.iterator||"@@iterator",a=s.asyncIterator||"@@asyncIterator",h=s.toStringTag||"@@toStringTag",u=e.regeneratorRuntime;if(u)t.exports=u;else{(u=e.regeneratorRuntime=t.exports).wrap=w;var c="suspendedStart",f="suspendedYield",l="executing",d="completed",p={},g={};g[o]=function(){return this};var y=Object.getPrototypeOf,v=y&&y(y(I([])));v&&v!==r&&i.call(v,o)&&(g=v);var m=E.prototype=S.prototype=Object.create(g);x.prototype=m.constructor=E,E.constructor=x,E[h]=x.displayName="GeneratorFunction",u.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===x||"GeneratorFunction"===(e.displayName||e.name))},u.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,E):(t.__proto__=E,h in t||(t[h]="GeneratorFunction")),t.prototype=Object.create(m),t},u.awrap=function(t){return{__await:t}},F(A.prototype),A.prototype[a]=function(){return this},u.AsyncIterator=A,u.async=function(t,e,n,r){var i=new A(w(t,e,n,r));return u.isGeneratorFunction(e)?i:i.next().then(function(t){return t.done?t.value:i.next()})},F(m),m[h]="Generator",m[o]=function(){return this},m.toString=function(){return"[object Generator]"},u.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},u.values=I,D.prototype={constructor:D,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(P),!t)for(var e in this)"t"===e.charAt(0)&&i.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=n)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(r,i){return a.type="throw",a.arg=t,e.next=r,i&&(e.method="next",e.arg=n),!!i}for(var s=this.tryEntries.length-1;s>=0;--s){var o=this.tryEntries[s],a=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var h=i.call(o,"catchLoc"),u=i.call(o,"finallyLoc");if(h&&u){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(h){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var s=r;break}}s&&("break"===t||"continue"===t)&&s.tryLoc<=e&&e<=s.finallyLoc&&(s=null);var o=s?s.completion:{};return o.type=t,o.arg=e,s?(this.method="next",this.next=s.finallyLoc,p):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),p},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),P(n),p}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;P(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:I(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=n),p}}}function w(t,e,n,r){var i=e&&e.prototype instanceof S?e:S,s=Object.create(i.prototype),o=new D(r||[]);return s._invoke=function(t,e,n){var r=c;return function(i,s){if(r===l)throw new Error("Generator is already running");if(r===d){if("throw"===i)throw s;return R()}for(n.method=i,n.arg=s;;){var o=n.delegate;if(o){var a=C(o,n);if(a){if(a===p)continue;return a}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===c)throw r=d,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=l;var h=b(t,e,n);if("normal"===h.type){if(r=n.done?d:f,h.arg===p)continue;return{value:h.arg,done:n.done}}"throw"===h.type&&(r=d,n.method="throw",n.arg=h.arg)}}}(t,n,o),s}function b(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}function S(){}function x(){}function E(){}function F(t){["next","throw","return"].forEach(function(e){t[e]=function(t){return this._invoke(e,t)}})}function A(t){var e;this._invoke=function(n,r){function s(){return new Promise(function(e,s){!function e(n,r,s,o){var a=b(t[n],t,r);if("throw"!==a.type){var h=a.arg,u=h.value;return u&&"object"==typeof u&&i.call(u,"__await")?Promise.resolve(u.__await).then(function(t){e("next",t,s,o)},function(t){e("throw",t,s,o)}):Promise.resolve(u).then(function(t){h.value=t,s(h)},o)}o(a.arg)}(n,r,e,s)})}return e=e?e.then(s,s):s()}}function C(t,e){var r=t.iterator[e.method];if(r===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=n,C(t,e),"throw"===e.method))return p;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return p}var i=b(r,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,p;var s=i.arg;return s?s.done?(e[t.resultName]=s.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=n),e.delegate=null,p):s:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,p)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function P(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function D(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function I(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,s=function e(){for(;++r<t.length;)if(i.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=n,e.done=!0,e};return s.next=s}}return{next:R}}function R(){return{value:n,done:!0}}}(function(){return this}()||Function("return this")())}),Bs=function(){return this}()||Function("return this")(),Hs=Bs.regeneratorRuntime&&Object.getOwnPropertyNames(Bs).indexOf("regeneratorRuntime")>=0,_s=Hs&&Bs.regeneratorRuntime;Bs.regeneratorRuntime=void 0;var ks=Rs;if(Hs)Bs.regeneratorRuntime=_s;else try{delete Bs.regeneratorRuntime}catch(t){Bs.regeneratorRuntime=void 0}var Ns=ks,Os=n(r(function(t,e){e.__esModule=!0;var n,r=(n=Cs)&&n.__esModule?n:{default:n};e.default=function(t){return function(){var e=t.apply(this,arguments);return new r.default(function(t,n){return function i(s,o){try{var a=e[s](o),h=a.value}catch(t){return void n(t)}if(!a.done)return r.default.resolve(h).then(function(t){i("next",t)},function(t){i("throw",t)});t(h)}("next")})}}}));!function(t,e){var n=(s.Object||{})[t]||Object[t],r={};r[t]=e(n),E(E.S+E.F*c(function(){n(1)}),"Object",r)}("keys",function(){return function(t){return J(Z(t))}});var js=s.Object.keys,Ls=n(r(function(t){t.exports={default:js,__esModule:!0}}));E(E.S,"Number",{isNaN:function(t){return t!=t}});var Ms=s.Number.isNaN,Vs=n(r(function(t){t.exports={default:Ms,__esModule:!0}})),Ks=r(function(t){!function(){function e(t,e){for(var n=2;n<arguments.length;n++)for(var r=0;r<arguments[n].length;r++)t[e++]=arguments[n].charAt(r)}function n(t){return String.fromCharCode(t>>24&255,t>>16&255,t>>8&255,255&t)}function r(t){return String.fromCharCode(255&t,t>>8&255)}t.exports=function(t,i,s){this.width=t,this.height=i,this.depth=s,this.pix_size=i*(t+1),this.data_size=2+this.pix_size+5*Math.floor((65534+this.pix_size)/65535)+4,this.ihdr_offs=0,this.ihdr_size=25,this.plte_offs=this.ihdr_offs+this.ihdr_size,this.plte_size=8+3*s+4,this.trns_offs=this.plte_offs+this.plte_size,this.trns_size=8+s+4,this.idat_offs=this.trns_offs+this.trns_size,this.idat_size=8+this.data_size+4,this.iend_offs=this.idat_offs+this.idat_size,this.iend_size=12,this.buffer_size=this.iend_offs+this.iend_size,this.buffer=new Array,this.palette=new Object,this.pindex=0;for(var o=new Array,a=0;a<this.buffer_size;a++)this.buffer[a]="\0";e(this.buffer,this.ihdr_offs,n(this.ihdr_size-12),"IHDR",n(t),n(i),"\b"),e(this.buffer,this.plte_offs,n(this.plte_size-12),"PLTE"),e(this.buffer,this.trns_offs,n(this.trns_size-12),"tRNS"),e(this.buffer,this.idat_offs,n(this.idat_size-12),"IDAT"),e(this.buffer,this.iend_offs,n(this.iend_size-12),"IEND");var h,u=30912;u+=31-u%31,e(this.buffer,this.idat_offs+8,(h=u,String.fromCharCode(h>>8&255,255&h)));for(a=0;(a<<16)-1<this.pix_size;a++){var c,f;a+65535<this.pix_size?(c=65535,f="\0"):(c=this.pix_size-(a<<16)-a,f=""),e(this.buffer,this.idat_offs+8+2+(a<<16)+(a<<2),f,r(c),r(~c))}for(a=0;a<256;a++){for(var l=a,d=0;d<8;d++)l=1&l?-306674912^l>>1&2147483647:l>>1&2147483647;o[a]=l}this.index=function(t,e){var n=e*(this.width+1)+t+1;return this.idat_offs+8+2+5*Math.floor(n/65535+1)+n},this.color=function(t,e,n,r){var i=(((r=r>=0?r:255)<<8|t)<<8|e)<<8|n;if(void 0===this.palette[i]){if(this.pindex==this.depth)return"\0";var s=this.plte_offs+8+3*this.pindex;this.buffer[s+0]=String.fromCharCode(t),this.buffer[s+1]=String.fromCharCode(e),this.buffer[s+2]=String.fromCharCode(n),this.buffer[this.trns_offs+8+this.pindex]=String.fromCharCode(r),this.palette[i]=String.fromCharCode(this.pindex++)}return this.palette[i]},this.getBase64=function(){var t,e,n,r,i,s,o,a=this.getDump(),h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",u=a.length,c=0,f="";do{r=(t=a.charCodeAt(c))>>2,i=(3&t)<<4|(e=a.charCodeAt(c+1))>>4,n=a.charCodeAt(c+2),s=u<c+2?64:(15&e)<<2|n>>6,o=u<c+3?64:63&n,f+=h.charAt(r)+h.charAt(i)+h.charAt(s)+h.charAt(o)}while((c+=3)<u);return f},this.getDump=function(){for(var t=1,r=0,i=5552,s=0;s<this.height;s++)for(var a=-1;a<this.width;a++)r+=t+=this.buffer[this.index(a,s)].charCodeAt(0),0==(i-=1)&&(t%=65521,r%=65521,i=5552);function h(t,r,i){for(var s=-1,a=4;a<i-4;a+=1)s=o[255&(s^t[r+a].charCodeAt(0))]^s>>8&16777215;e(t,r+i-4,n(-1^s))}return t%=65521,r%=65521,e(this.buffer,this.idat_offs+this.idat_size-8,n(r<<16|t)),h(this.buffer,this.ihdr_offs,this.ihdr_size),h(this.buffer,this.plte_offs,this.plte_size),h(this.buffer,this.trns_offs,this.trns_size),h(this.buffer,this.idat_offs,this.idat_size),h(this.buffer,this.iend_offs,this.iend_size),"PNG\r\n\n"+this.buffer.join("")}}}()}),Us=r(function(t){!function(){var e;e=Ks;var n=function(t,e){if("string"!=typeof t||t.length<15)throw"A hash of at least 15 characters is required.";this.defaults={background:[240,240,240,255],margin:.08,size:64,saturation:.7,brightness:.5,format:"png"},this.options="object"==typeof e?e:this.defaults,"number"==typeof arguments[1]&&(this.options.size=arguments[1]),arguments[2]&&(this.options.margin=arguments[2]),this.hash=t,this.background=this.options.background||this.defaults.background,this.size=this.options.size||this.defaults.size,this.format=this.options.format||this.defaults.format,this.margin=void 0!==this.options.margin?this.options.margin:this.defaults.margin;var n=parseInt(this.hash.substr(-7),16)/268435455,r=this.options.saturation||this.defaults.saturation,i=this.options.brightness||this.defaults.brightness;this.foreground=this.options.foreground||this.hsl2rgb(n,r,i)};n.prototype={background:null,foreground:null,hash:null,margin:null,size:null,format:null,image:function(){return this.isSvg()?new r(this.size,this.foreground,this.background):new e(this.size,this.size,256)},render:function(){var t,e,n=this.image(),r=this.size,i=Math.floor(r*this.margin),s=Math.floor((r-2*i)/5),o=Math.floor((r-5*s)/2),a=n.color.apply(n,this.background),h=n.color.apply(n,this.foreground);for(t=0;t<15;t++)e=parseInt(this.hash.charAt(t),16)%2?a:h,t<5?this.rectangle(2*s+o,t*s+o,s,s,e,n):t<10?(this.rectangle(1*s+o,(t-5)*s+o,s,s,e,n),this.rectangle(3*s+o,(t-5)*s+o,s,s,e,n)):t<15&&(this.rectangle(0*s+o,(t-10)*s+o,s,s,e,n),this.rectangle(4*s+o,(t-10)*s+o,s,s,e,n));return n},rectangle:function(t,e,n,r,i,s){var o,a;if(this.isSvg())s.rectangles.push({x:t,y:e,w:n,h:r,color:i});else for(o=t;o<t+n;o++)for(a=e;a<e+r;a++)s.buffer[s.index(o,a)]=i},hsl2rgb:function(t,e,n){return[255*(e=[n+=e*=n<.5?n:1-n,n-(t*=6)%1*e*2,n-=e*=2,n,n+t%1*e,n+e])[~~t%6],255*e[(16|t)%6],255*e[(8|t)%6]]},toString:function(t){return t?this.render().getDump():this.render().getBase64()},isSvg:function(){return this.format.match(/svg/i)}};var r=function(t,e,n){this.size=t,this.foreground=this.color.apply(this,e),this.background=this.color.apply(this,n),this.rectangles=[]};r.prototype={size:null,foreground:null,background:null,rectangles:null,color:function(t,e,n,r){var i=[t,e,n].map(Math.round);return i.push(r>=0&&r<=255?r/255:1),"rgba("+i.join(",")+")"},getDump:function(){var t,e,n,r=this.foreground,i=this.background,s=.005*this.size;for(e="<svg xmlns='http://www.w3.org/2000/svg' width='"+this.size+"' height='"+this.size+"' style='background-color:"+i+";'><g style='fill:"+r+"; stroke:"+r+"; stroke-width:"+s+";'>",t=0;t<this.rectangles.length;t++)(n=this.rectangles[t]).color!=i&&(e+="<rect  x='"+n.x+"' y='"+n.y+"' width='"+n.w+"' height='"+n.h+"'/>");return e+="</g></svg>"},getBase64:function(){if(btoa)return btoa(this.getDump());if(mt)return new mt(this.getDump(),"binary").toString("base64");throw"Cannot generate base64 output"}},t.exports=n}()}),qs={email:/^([\w-]+(?:\.[\w-]+)*)@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$/i,bitcoin:/^[13][a-km-zA-HJ-NP-Z0-9]{26,33}$/,bitcoin_address:/^[13][a-km-zA-HJ-NP-Z0-9]{26,33}$/,ip:/^(([1-9]?\d|1\d\d|2[0-5][0-5]|2[0-4]\d)\.){3}([1-9]?\d|1\d\d|2[0-5][0-5]|2[0-4]\d)$/,ipv6:/^(?:[A-F0-9]{1,4}:){7}[A-F0-9]{1,4}$/,gpg_fingerprint:null,gpg_keyid:null,google_oauth2:null,tel:/^\d{7,}$/,phone:/^\d{7,}$/,keyID:null,url:/[-a-zA-Z0-9@:%_\+.~#?&\/\/=]{2,256}\.[a-z]{2,4}\b(\/[-a-zA-Z0-9@:%_\+.~#?&\/\/=]*)?/gi,account:/^([\w-]+(?:\.[\w-]+)*)@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$/i},zs=function(){function t(e){if(Ln(this,t),e.hasOwnProperty("val"))if(this.val=e.val,e.hasOwnProperty("name"))this.name=e.name;else{var n=t.guessTypeOf(this.val);if(!n)throw new Error("Type of attribute was omitted and could not be guessed");this.name=n}else{if(!Array.isArray(e))throw new Error("Invalid attribute data",e);if(2!==e.length)throw new Error("Invalid Attribute");this.name=e[0],this.val=e[1]}}return t.getUniqueIdValidators=function(){return qs},t.isUniqueType=function(t){return Ls(qs).indexOf(t)>-1},t.guessTypeOf=function(t){for(var e in qs)if(t.match(qs[e]))return e},t.equals=function(e,n){return new t(e).equals(new t(n))},t.prototype.toArray=function(){return[this.name,this.val]},t.prototype.equals=function(t){return this.name===t.name&&this.val===t.val},t}(),Ys=function(){function t(e){var n=this;if(Ln(this,t),this.data=e,this.profile={},this.mostVerifiedAttributes={},e.attrs.length){var r=e.attrs[0];void 0!==r.pos&&void 0!==r.neg&&void 0!==r.neut&&(this.data.receivedPositive=r.pos,this.data.receivedNegative=r.neg,this.data.receivedNeutral=r.neut)}this.data.receivedNegative|=0,this.data.receivedPositive|=0,this.data.receivedNeutral|=0,this.data.sentNegative|=0,this.data.sentPositive|=0,this.data.sentNeutral|=0,this.data.trustDistance=this.data.hasOwnProperty("trustDistance")?this.data.trustDistance:99,this.data.attrs.forEach(function(t){switch(!n.linkTo&&zs.isUniqueType(t.name)&&(n.linkTo=t),!Vs(parseInt(t.dist))&&t.dist>=0&&t.dist<n.data.trustDistance&&(n.data.trustDistance=parseInt(t.dist),zs.isUniqueType(t.name)&&(n.linkTo=t)),t.name){case"email":t.iconStyle="glyphicon glyphicon-envelope",t.btnStyle="btn-success",t.link="mailto:"+t.val,t.quickContact=!0;break;case"bitcoin_address":case"bitcoin":t.iconStyle="fa fa-bitcoin",t.btnStyle="btn-primary",t.link="https://blockchain.info/address/"+t.val,t.quickContact=!0;break;case"gpg_fingerprint":case"gpg_keyid":t.iconStyle="fa fa-key",t.btnStyle="btn-default",t.link="https://pgp.mit.edu/pks/lookup?op=get&search=0x"+t.val;break;case"account":t.iconStyle="fa fa-at";break;case"nickname":case"name":t.iconStyle="glyphicon glyphicon-font";break;case"tel":case"phone":t.iconStyle="glyphicon glyphicon-earphone",t.btnStyle="btn-success",t.link="tel:"+t.val,t.quickContact=!0;break;case"keyID":t.iconStyle="fa fa-key";break;case"url":t.link=t.val,t.val.indexOf("facebook.com/")>-1?(t.iconStyle="fa fa-facebook",t.btnStyle="btn-facebook",t.link=t.val,t.linkName=t.val.split("facebook.com/")[1],t.quickContact=!0):t.val.indexOf("twitter.com/")>-1?(t.iconStyle="fa fa-twitter",t.btnStyle="btn-twitter",t.link=t.val,t.linkName=t.val.split("twitter.com/")[1],t.quickContact=!0):t.val.indexOf("plus.google.com/")>-1?(t.iconStyle="fa fa-google-plus",t.btnStyle="btn-google-plus",t.link=t.val,t.linkName=t.val.split("plus.google.com/")[1],t.quickContact=!0):t.val.indexOf("linkedin.com/")>-1?(t.iconStyle="fa fa-linkedin",t.btnStyle="btn-linkedin",t.link=t.val,t.linkName=t.val.split("linkedin.com/")[1],t.quickContact=!0):t.val.indexOf("github.com/")>-1?(t.iconStyle="fa fa-github",t.btnStyle="btn-github",t.link=t.val,t.linkName=t.val.split("github.com/")[1],t.quickContact=!0):(t.iconStyle="glyphicon glyphicon-link",t.btnStyle="btn-default")}var e=Ls(n.mostVerifiedAttributes).indexOf(t.name)>-1;2*t.conf>3*t.ref&&(!e||t.conf-t.ref>n.mostVerifiedAttributes[t.name].verificationScore)&&(n.mostVerifiedAttributes[t.name]={attribute:t,verificationScore:t.conf-t.ref})}),"keyID"!==this.linkTo.name&&this.mostVerifiedAttributes.keyID&&(this.linkTo=this.mostVerifiedAttributes.keyID.attribute),Ls(this.mostVerifiedAttributes).forEach(function(t){["name","nickname","email","url","coverPhoto","profilePhoto"].indexOf(t)>-1&&(n.profile[t]=n.mostVerifiedAttributes[t].attribute.val)})}return t.prototype.verified=function(t){return this.mostVerifiedAttributes.hasOwnProperty(t)?this.mostVerifiedAttributes[t].attribute.val:void 0},t.prototype.profileCard=function(){var t=document.createElement("div");t.className="identifi-card";var e=this.identicon(60);e.style.order=1,e.style.flexShrink=0,e.style.marginRight="15px";var n=document.createElement("div");n.style.padding="5px",n.style.order=2,n.style.flexGrow=1;var r="https://identi.fi/#/identities/"+this.linkTo.name+"/"+this.linkTo.val;n.innerHTML='<a href="'+r+'">'+(this.profile.name||this.profile.nickname||this.linkTo.name+":"+this.linkTo.val)+"</a><br>",n.innerHTML+='<small>Received: <span class="identifi-pos">+'+(this.data.receivedPositive||0)+'</span> / <span class="identifi-neg">-'+(this.data.receivedNegative||0)+"</span></small><br>";var i=document.createElement("small");return this.data.attrs.forEach(function(t){t.link&&(i.innerHTML+=t.name+': <a href="'+t.link+'">'+t.val+"</a> ")}),n.appendChild(i),t.appendChild(e),t.appendChild(n),t},t.appendSearchWidget=function(t,e){var n=this,r=document.createElement("form"),i=document.createElement("input");i.type="text",i.placeholder="Search",i.id="identifiSearchInput",r.innerHTML+='<div id="identifiSearchResults"></div>';var s=document.createElement("div");t.appendChild(r),r.appendChild(i),r.appendChild(s),i.addEventListener("keyup",Os(Ns.mark(function t(){var r;return Ns.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.search(i.value);case 2:r=t.sent,s.innerHTML="",r.sort(function(t,e){return t.trustDistance-e.trustDistance}),r.forEach(function(t){s.appendChild(t.profileCard())});case 6:case"end":return t.stop()}},t,n)})))},t._ordinal=function(t){var e=["th","st","nd","rd"],n=t%100;return t+(e[(n-20)%10]||e[n]||e[0])},t._injectCss=function(){if(!document.getElementById("identifiStyle")){var t=document.createElement("style");t.id="identifiStyle",t.innerHTML="\n      .identifi-identicon * {\n        box-sizing: border-box;\n      }\n\n      .identifi-identicon {\n        vertical-align: middle;\n        margin: auto;\n        border-radius: 50%;\n        text-align: center;\n        display: inline-block;\n        position: relative;\n        margin: auto;\n        max-width: 100%;\n      }\n\n      .identifi-distance {\n        z-index: 2;\n        position: absolute;\n        left:0%;\n        top:2px;\n        width: 100%;\n        text-align: right;\n        color: #fff;\n        text-shadow: 0 0 1px #000;\n        font-size: 75%;\n        line-height: 75%;\n        font-weight: bold;\n      }\n\n      .identifi-pie {\n        border-radius: 50%;\n        position: absolute;\n        top: 0;\n        left: 0;\n        box-shadow: 0px 0px 0px 0px #82FF84;\n        padding-bottom: 100%;\n        max-width: 100%;\n        -webkit-transition: all 0.2s ease-in-out;\n        -moz-transition: all 0.2s ease-in-out;\n        transition: all 0.2s ease-in-out;\n      }\n\n      .identifi-card {\n        padding: 10px;\n        background-color: #f7f7f7;\n        color: #777;\n        border: 1px solid #ddd;\n        display: flex;\n        flex-direction: row;\n        overflow: hidden;\n      }\n\n      .identifi-card a {\n        -webkit-transition: color 150ms;\n        transition: color 150ms;\n        text-decoration: none;\n        color: #337ab7;\n      }\n\n      .identifi-card a:hover, .identifi-card a:active {\n        text-decoration: underline;\n        color: #23527c;\n      }\n\n      .identifi-pos {\n        color: #3c763d;\n      }\n\n      .identifi-neg {\n        color: #a94442;\n      }\n\n      .identifi-identicon img {\n        position: absolute;\n        top: 0;\n        left: 0;\n        max-width: 100%;\n        border-radius: 50%;\n        border-color: transparent;\n        border-style: solid;\n      }",document.body.appendChild(t)}},t.prototype.identicon=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];t._injectCss();var i=document.createElement("div");i.className="identifi-identicon",i.style.width=e+"px",i.style.height=e+"px";var s="rgba(0,0,0,0.2)",o="none",a="",h="0px 0px 0px 0px #82FF84";this.data.receivedPositive>20*this.data.receivedNegative?h="0px 0px "+n*this.data.receivedPositive/50+"px 0px #82FF84":this.data.receivedPositive<3*this.data.receivedNegative&&(h="0px 0px "+n*this.data.receivedNegative/10+"px 0px #BF0400"),this.data.receivedPositive+this.data.receivedNegative>0&&(this.data.receivedPositive>this.data.receivedNegative?(a="rotate("+(-this.data.receivedPositive/(this.data.receivedPositive+this.data.receivedNegative)*360-180)/2+"deg)",s="#A94442",o="linear-gradient("+this.data.receivedPositive/(this.data.receivedPositive+this.data.receivedNegative)*360+"deg, transparent 50%, #3C763D 50%), linear-gradient(0deg, #3C763D 50%, transparent 50%)"):(a="rotate("+((-this.data.receivedNegative/(this.data.receivedPositive+this.data.receivedNegative)*360-180)/2+180)+"deg)",s="#3C763D",o="linear-gradient("+this.data.receivedNegative/(this.data.receivedPositive+this.data.receivedNegative)*360+"deg, transparent 50%, #A94442 50%), linear-gradient(0deg, #A94442 50%, transparent 50%)"));var u=document.createElement("div");u.className="identifi-pie",u.style.backgroundColor=s,u.style.backgroundImage=o,u.style.width=e+"px",u.style.boxShadow=h,u.style.opacity=(this.data.receivedPositive+this.data.receivedNegative)/10*.5+.35,u.style.transform=a;var c=new In({alg:"md5",prov:"cryptojs"}).digestString(jn(this.linkTo)),f=new Us(c,{width:e,format:"svg"}),l=document.createElement("img");if(l.src="data:image/svg+xml;base64,"+f.toString(),l.alt="",l.width=e,l.style.borderWidth=n+"px",r){var d=document.createElement("span");d.textContent=this.data.trustDistance<1e3?t._ordinal(this.data.trustDistance):"",d.className="identifi-distance",d.style.fontSize=e>50?e/4+"px":"10px",i.appendChild(d)}return i.appendChild(u),i.appendChild(l),i},t}(),Ws="Invalid Identifi message:",Gs=function(t){function e(){return Ln(this,e),li(this,t.apply(this,arguments))}return Ei(e,t),e}(Error),Js=function(){function t(e){Ln(this,t),this.signedData=e,this.validate()}return t.prototype.getSignerKeyID=function(){return Is.getHash(this.jwsHeader.key||this.jwsHeader.kid)},t.prototype.validate=function(){if(!this.signedData)throw new Gs(Ws+" Missing signedData");if("object"!=typeof this.signedData)throw new Gs(Ws+" signedData must be an object");var t=this.signedData;if(!t.type)throw new Gs(Ws+" Missing type definition");if(!t.author)throw new Gs(Ws+" Missing author");if(!t.author.length)throw new Gs(Ws+" Author empty");var e=void 0,n=void 0;for(this.jwsHeader&&(this.signerKeyHash=this.getSignerKeyID()),e=0;e<t.author.length;e++){if(2!==t.author[e].length)throw new Gs(Ws+" Invalid author: "+t.author[e].toString());if("keyID"===t.author[e][0]){if(n)throw new Gs(Ws+" Author may have only one keyID");if(n=t.author[e][1],this.signerKeyHash&&n!==this.signerKeyHash)throw new Gs(Ws+" If message has a keyID author, it must be signed by the same key")}}if(!t.recipient)throw new Gs(Ws+" Missing recipient");if(!t.recipient.length)throw new Gs(Ws+" Author empty");for(e=0;e<t.recipient.length;e++)if(2!==t.recipient[e].length)throw new Gs(Ws+" Invalid recipient: "+t.recipient[e].toString());if(!t.timestamp)throw new Gs(Ws+" Missing timestamp");if(!Date.parse(t.timestamp))throw new Gs(Ws+" Invalid timestamp");if("rating"===t.type){if(isNaN(t.rating))throw new Gs(Ws+" Invalid rating");if(isNaN(t.maxRating))throw new Gs(Ws+" Invalid maxRating");if(isNaN(t.minRating))throw new Gs(Ws+" Invalid minRating");if(t.rating>t.maxRating)throw new Gs(Ws+" Rating is above maxRating");if(t.rating<t.minRating)throw new Gs(Ws+" Rating is below minRating");if("string"!=typeof t.context||!t.context.length)throw new Gs(Ws+" Rating messages must have a context field")}if(("verify_identity"===t.type||"unverify_identity"===t.type)&&t.recipient.length<2)throw new Gs(Ws+" At least 2 recipient attributes are needed for a connection / disconnection");return!0},t.prototype.isPositive=function(){return"rating"===this.signedData.type&&this.signedData.rating>(this.signedData.maxRating+this.signedData.minRating)/2},t.prototype.isNegative=function(){return"rating"===this.signedData.type&&this.signedData.rating<(this.signedData.maxRating+this.signedData.minRating)/2},t.prototype.isNeutral=function(){return"rating"===this.signedData.type&&this.signedData.rating===(this.signedData.maxRating+this.signedData.minRating)/2},t.prototype.sign=function(e,n){return this.jwsHeader={alg:"ES256",key:e.pubKeyASN1},this.jws=_n.JWS.sign(this.jwsHeader.alg,jn(this.jwsHeader),jn(this.signedData),e),n||t.validateJws(this.jws),this.getHash(),this},t.create=function(e,n){!e.author&&n&&(e.author=[["keyID",n.keyID]]),e.timestamp=e.timestamp||(new Date).toISOString(),e.context=e.context||"identifi";var r=new t(e);return n&&r.sign(n),r},t.createVerification=function(e,n){return e.type="verification",t.create(e,n)},t.createRating=function(e,n){return e.type="rating",e.maxRating=e.maxRating||10,e.minRating=e.minRating||-10,t.create(e,n)},t.fromJws=function(e){t.validateJws(e);var n=_n.JWS.parse(e),r=new t(n.payloadObj);return r.hash=t.getHash(e),r.jwsHeader=n.headerObj,r.jws=e,r},t.prototype.getAuthor=function(t){if(!t){var e=[];this.signedData.author.forEach(function(t){e.push({name:t[0],val:t[1]})});var n=new Ys({attrs:e});return this.hasOwnProperty("authorPos")&&this.hasOwnProperty("authorNeg")&&(n.data.receivedPositive=this.authorPos,n.data.receivedNegative=this.authorNeg),this.hasOwnProperty("authorTrustDistance")&&(n.data.trustDistance=this.authorTrustDistance),this.authorName&&(n.profile.name=this.authorName),n}},t.prototype.getRecipient=function(t){if(!t){var e=[];this.signedData.recipient.forEach(function(t){e.push({name:t[0],val:t[1]})});var n=new Ys({attrs:e});return this.hasOwnProperty("recipientPos")&&this.hasOwnProperty("recipientNeg")&&(n.data.receivedPositive=this.recipientPos,n.data.receivedNegative=this.recipientNeg),this.hasOwnProperty("recipientTrustDistance")&&(n.data.trustDistance=this.recipientTrustDistance),this.recipientName&&(n.profile.name=this.recipientName),n}},t.prototype.getHash=function(){return this.jws&&!this.hash&&(this.hash=t.getHash(this.jws)),this.hash},t.getHash=function(t){return new mt(new In({alg:"sha256",prov:"cryptojs"}).digestString(t),"hex").toString("base64")},t.prototype.verify=function(){var e=this.jwsHeader.key||this.jwsHeader.kid,n=Hn.ASN1Util.getPEMStringFromHex(e,"PUBLIC KEY"),r=Rn.getKey(n);if(!_n.JWS.verify(this.jws,r,[this.jwsHeader.alg]))throw new Gs(Ws+" Invalid signature");if(this.hash){if(this.hash!==t.getHash(this.jws))throw new Gs(Ws+" Invalid message hash")}else this.getHash();return!0},t.validateJws=function(t){if("string"!=typeof t)throw new Gs(Ws+" Message JWS must be a string");if(t.length>1e4)throw new Gs(Ws+" Message JWS max length is 10000");return!0},t}(),Xs="\t\n\v\f\r \u2028\u2029\ufeff",$s="["+Xs+"]",Zs=RegExp("^"+$s+$s+"*"),Qs=RegExp($s+$s+"*$"),to=function(t,e,n){var r={},i=c(function(){return!!Xs[t]()||""!=""[t]()}),s=r[t]=i?e(eo):Xs[t];n&&(r[n]=s),E(E.P+E.F*i,"String",r)},eo=to.trim=function(t,e){return t=String(D(t)),1&e&&(t=t.replace(Zs,"")),2&e&&(t=t.replace(Qs,"")),t},no=to,ro=i.parseInt,io=no.trim,so=/^[-+]?0[xX]/,oo=8!==ro(Xs+"08")||22!==ro(Xs+"0x16")?function(t,e){var n=io(String(t),3);return ro(n,e>>>0||(so.test(n)?16:10))}:ro;E(E.S+E.F*(Number.parseInt!=oo),"Number",{parseInt:oo});var ao,ho=parseInt,uo=n(r(function(t){t.exports={default:ho,__esModule:!0}})),co=$.f,fo=(ao=!1,function(t){for(var e,n=I(t),r=J(n),i=r.length,s=0,o=[];i>s;)co.call(n,e=r[s++])&&o.push(ao?[e,n[e]]:n[e]);return o});E(E.S,"Object",{values:function(t){return fo(t)}});var lo=s.Object.values,po=n(r(function(t){t.exports={default:lo,__esModule:!0}})),go={},yo=Object.freeze({default:go});function vo(){throw new Error("setTimeout has not been defined")}function mo(){throw new Error("clearTimeout has not been defined")}var wo=vo,bo=mo;function So(t){if(wo===setTimeout)return setTimeout(t,0);if((wo===vo||!wo)&&setTimeout)return wo=setTimeout,setTimeout(t,0);try{return wo(t,0)}catch(e){try{return wo.call(null,t,0)}catch(e){return wo.call(this,t,0)}}}"function"==typeof it.setTimeout&&(wo=setTimeout),"function"==typeof it.clearTimeout&&(bo=clearTimeout);var xo,Eo=[],Fo=!1,Ao=-1;function Co(){Fo&&xo&&(Fo=!1,xo.length?Eo=xo.concat(Eo):Ao=-1,Eo.length&&To())}function To(){if(!Fo){var t=So(Co);Fo=!0;for(var e=Eo.length;e;){for(xo=Eo,Eo=[];++Ao<e;)xo&&xo[Ao].run();Ao=-1,e=Eo.length}xo=null,Fo=!1,function(t){if(bo===clearTimeout)return clearTimeout(t);if((bo===mo||!bo)&&clearTimeout)return bo=clearTimeout,clearTimeout(t);try{bo(t)}catch(e){try{return bo.call(null,t)}catch(e){return bo.call(this,t)}}}(t)}}function Po(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];Eo.push(new Do(t,e)),1!==Eo.length||Fo||So(To)}function Do(t,e){this.fun=t,this.array=e}Do.prototype.run=function(){this.fun.apply(null,this.array)};function Io(){}var Ro=Io,Bo=Io,Ho=Io,_o=Io,ko=Io,No=Io,Oo=Io;var jo=it.performance||{},Lo=jo.now||jo.mozNow||jo.msNow||jo.oNow||jo.webkitNow||function(){return(new Date).getTime()};var Mo=new Date;var Vo,Ko,Uo={nextTick:Po,title:"browser",browser:!0,env:{},argv:[],version:"",versions:{},on:Ro,addListener:Bo,once:Ho,off:_o,removeListener:ko,removeAllListeners:No,emit:Oo,binding:function(t){throw new Error("process.binding is not supported")},cwd:function(){return"/"},chdir:function(t){throw new Error("process.chdir is not supported")},umask:function(){return 0},hrtime:function(t){var e=.001*Lo.call(jo),n=Math.floor(e),r=Math.floor(e%1*1e9);return t&&(n-=t[0],(r-=t[1])<0&&(n--,r+=1e9)),[n,r]},platform:"browser",release:{},config:{},uptime:function(){return(new Date-Mo)/1e3}},qo=Qo(it.fetch)&&Qo(it.ReadableStream);function zo(t){Ko||(Ko=new it.XMLHttpRequest).open("GET",it.location.host?"/":"https://example.com");try{return Ko.responseType=t,Ko.responseType===t}catch(t){return!1}}var Yo=void 0!==it.ArrayBuffer,Wo=Yo&&Qo(it.ArrayBuffer.prototype.slice),Go=Yo&&zo("arraybuffer"),Jo=!qo&&Wo&&zo("ms-stream"),Xo=!qo&&Yo&&zo("moz-chunked-arraybuffer"),$o=Qo(Ko.overrideMimeType),Zo=Qo(it.VBArray);function Qo(t){return"function"==typeof t}Ko=null;var ta="function"==typeof Object.create?function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:function(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t},ea=/%[sdj%]/g;var na,ra={};function ia(t,e){var n={seen:[],stylize:oa};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),ca(e)?n.showHidden=e:e&&function(t,e){if(!e||!ga(e))return t;var n=Object.keys(e),r=n.length;for(;r--;)t[n[r]]=e[n[r]]}(n,e),da(n.showHidden)&&(n.showHidden=!1),da(n.depth)&&(n.depth=2),da(n.colors)&&(n.colors=!1),da(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=sa),aa(n,t,n.depth)}function sa(t,e){var n=ia.styles[e];return n?"["+ia.colors[n][0]+"m"+t+"["+ia.colors[n][1]+"m":t}function oa(t,e){return t}function aa(t,e,n){if(t.customInspect&&e&&ma(e.inspect)&&e.inspect!==ia&&(!e.constructor||e.constructor.prototype!==e)){var r=e.inspect(n,t);return la(r)||(r=aa(t,r,n)),r}var i=function(t,e){if(da(e))return t.stylize("undefined","undefined");if(la(e)){var n="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(n,"string")}if(r=e,"number"==typeof r)return t.stylize(""+e,"number");var r;if(ca(e))return t.stylize(""+e,"boolean");if(fa(e))return t.stylize("null","null")}(t,e);if(i)return i;var s=Object.keys(e),o=function(t){var e={};return t.forEach(function(t,n){e[t]=!0}),e}(s);if(t.showHidden&&(s=Object.getOwnPropertyNames(e)),va(e)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return ha(e);if(0===s.length){if(ma(e)){var a=e.name?": "+e.name:"";return t.stylize("[Function"+a+"]","special")}if(pa(e))return t.stylize(RegExp.prototype.toString.call(e),"regexp");if(ya(e))return t.stylize(Date.prototype.toString.call(e),"date");if(va(e))return ha(e)}var h,u,c="",f=!1,l=["{","}"];(h=e,Array.isArray(h)&&(f=!0,l=["[","]"]),ma(e))&&(c=" [Function"+(e.name?": "+e.name:"")+"]");return pa(e)&&(c=" "+RegExp.prototype.toString.call(e)),ya(e)&&(c=" "+Date.prototype.toUTCString.call(e)),va(e)&&(c=" "+ha(e)),0!==s.length||f&&0!=e.length?n<0?pa(e)?t.stylize(RegExp.prototype.toString.call(e),"regexp"):t.stylize("[Object]","special"):(t.seen.push(e),u=f?function(t,e,n,r,i){for(var s=[],o=0,a=e.length;o<a;++o)ba(e,String(o))?s.push(ua(t,e,n,r,String(o),!0)):s.push("");return i.forEach(function(i){i.match(/^\d+$/)||s.push(ua(t,e,n,r,i,!0))}),s}(t,e,n,o,s):s.map(function(r){return ua(t,e,n,o,r,f)}),t.seen.pop(),function(t,e,n){if(t.reduce(function(t,e){return e.indexOf("\n"),t+e.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60)return n[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+n[1];return n[0]+e+" "+t.join(", ")+" "+n[1]}(u,c,l)):l[0]+c+l[1]}function ha(t){return"["+Error.prototype.toString.call(t)+"]"}function ua(t,e,n,r,i,s){var o,a,h;if((h=Object.getOwnPropertyDescriptor(e,i)||{value:e[i]}).get?a=h.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):h.set&&(a=t.stylize("[Setter]","special")),ba(r,i)||(o="["+i+"]"),a||(t.seen.indexOf(h.value)<0?(a=fa(n)?aa(t,h.value,null):aa(t,h.value,n-1)).indexOf("\n")>-1&&(a=s?a.split("\n").map(function(t){return"  "+t}).join("\n").substr(2):"\n"+a.split("\n").map(function(t){return"   "+t}).join("\n")):a=t.stylize("[Circular]","special")),da(o)){if(s&&i.match(/^\d+$/))return a;(o=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(o=o.substr(1,o.length-2),o=t.stylize(o,"name")):(o=o.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),o=t.stylize(o,"string"))}return o+": "+a}function ca(t){return"boolean"==typeof t}function fa(t){return null===t}function la(t){return"string"==typeof t}function da(t){return void 0===t}function pa(t){return ga(t)&&"[object RegExp]"===wa(t)}function ga(t){return"object"==typeof t&&null!==t}function ya(t){return ga(t)&&"[object Date]"===wa(t)}function va(t){return ga(t)&&("[object Error]"===wa(t)||t instanceof Error)}function ma(t){return"function"==typeof t}function wa(t){return Object.prototype.toString.call(t)}function ba(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Sa(){}function xa(){xa.init.call(this)}function Ea(t){return void 0===t._maxListeners?xa.defaultMaxListeners:t._maxListeners}function Fa(t,e,n,r){var i,s,o,a;if("function"!=typeof n)throw new TypeError('"listener" argument must be a function');if((s=t._events)?(s.newListener&&(t.emit("newListener",e,n.listener?n.listener:n),s=t._events),o=s[e]):(s=t._events=new Sa,t._eventsCount=0),o){if("function"==typeof o?o=s[e]=r?[n,o]:[o,n]:r?o.unshift(n):o.push(n),!o.warned&&(i=Ea(t))&&i>0&&o.length>i){o.warned=!0;var h=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+e+" listeners added. Use emitter.setMaxListeners() to increase limit");h.name="MaxListenersExceededWarning",h.emitter=t,h.type=e,h.count=o.length,a=h,"function"==typeof console.warn?console.warn(a):console.log(a)}}else o=s[e]=n,++t._eventsCount;return t}function Aa(t,e,n){var r=!1;function i(){t.removeListener(e,i),r||(r=!0,n.apply(t,arguments))}return i.listener=n,i}function Ca(t){var e=this._events;if(e){var n=e[t];if("function"==typeof n)return 1;if(n)return n.length}return 0}function Ta(t,e){for(var n=new Array(e);e--;)n[e]=t[e];return n}function Pa(){this.head=null,this.tail=null,this.length=0}ia.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},ia.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},Sa.prototype=Object.create(null),xa.EventEmitter=xa,xa.usingDomains=!1,xa.prototype.domain=void 0,xa.prototype._events=void 0,xa.prototype._maxListeners=void 0,xa.defaultMaxListeners=10,xa.init=function(){this.domain=null,xa.usingDomains&&(void 0).active,this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=new Sa,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},xa.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||isNaN(t))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=t,this},xa.prototype.getMaxListeners=function(){return Ea(this)},xa.prototype.emit=function(t){var e,n,r,i,s,o,a,h="error"===t;if(o=this._events)h=h&&null==o.error;else if(!h)return!1;if(a=this.domain,h){if(e=arguments[1],!a){if(e instanceof Error)throw e;var u=new Error('Uncaught, unspecified "error" event. ('+e+")");throw u.context=e,u}return e||(e=new Error('Uncaught, unspecified "error" event')),e.domainEmitter=this,e.domain=a,e.domainThrown=!1,a.emit("error",e),!1}if(!(n=o[t]))return!1;var c="function"==typeof n;switch(r=arguments.length){case 1:!function(t,e,n){if(e)t.call(n);else for(var r=t.length,i=Ta(t,r),s=0;s<r;++s)i[s].call(n)}(n,c,this);break;case 2:!function(t,e,n,r){if(e)t.call(n,r);else for(var i=t.length,s=Ta(t,i),o=0;o<i;++o)s[o].call(n,r)}(n,c,this,arguments[1]);break;case 3:!function(t,e,n,r,i){if(e)t.call(n,r,i);else for(var s=t.length,o=Ta(t,s),a=0;a<s;++a)o[a].call(n,r,i)}(n,c,this,arguments[1],arguments[2]);break;case 4:!function(t,e,n,r,i,s){if(e)t.call(n,r,i,s);else for(var o=t.length,a=Ta(t,o),h=0;h<o;++h)a[h].call(n,r,i,s)}(n,c,this,arguments[1],arguments[2],arguments[3]);break;default:for(i=new Array(r-1),s=1;s<r;s++)i[s-1]=arguments[s];!function(t,e,n,r){if(e)t.apply(n,r);else for(var i=t.length,s=Ta(t,i),o=0;o<i;++o)s[o].apply(n,r)}(n,c,this,i)}return!0},xa.prototype.addListener=function(t,e){return Fa(this,t,e,!1)},xa.prototype.on=xa.prototype.addListener,xa.prototype.prependListener=function(t,e){return Fa(this,t,e,!0)},xa.prototype.once=function(t,e){if("function"!=typeof e)throw new TypeError('"listener" argument must be a function');return this.on(t,Aa(this,t,e)),this},xa.prototype.prependOnceListener=function(t,e){if("function"!=typeof e)throw new TypeError('"listener" argument must be a function');return this.prependListener(t,Aa(this,t,e)),this},xa.prototype.removeListener=function(t,e){var n,r,i,s,o;if("function"!=typeof e)throw new TypeError('"listener" argument must be a function');if(!(r=this._events))return this;if(!(n=r[t]))return this;if(n===e||n.listener&&n.listener===e)0==--this._eventsCount?this._events=new Sa:(delete r[t],r.removeListener&&this.emit("removeListener",t,n.listener||e));else if("function"!=typeof n){for(i=-1,s=n.length;s-- >0;)if(n[s]===e||n[s].listener&&n[s].listener===e){o=n[s].listener,i=s;break}if(i<0)return this;if(1===n.length){if(n[0]=void 0,0==--this._eventsCount)return this._events=new Sa,this;delete r[t]}else!function(t,e){for(var n=e,r=n+1,i=t.length;r<i;n+=1,r+=1)t[n]=t[r];t.pop()}(n,i);r.removeListener&&this.emit("removeListener",t,o||e)}return this},xa.prototype.removeAllListeners=function(t){var e,n;if(!(n=this._events))return this;if(!n.removeListener)return 0===arguments.length?(this._events=new Sa,this._eventsCount=0):n[t]&&(0==--this._eventsCount?this._events=new Sa:delete n[t]),this;if(0===arguments.length){for(var r,i=Object.keys(n),s=0;s<i.length;++s)"removeListener"!==(r=i[s])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=new Sa,this._eventsCount=0,this}if("function"==typeof(e=n[t]))this.removeListener(t,e);else if(e)do{this.removeListener(t,e[e.length-1])}while(e[0]);return this},xa.prototype.listeners=function(t){var e,n=this._events;return n&&(e=n[t])?"function"==typeof e?[e.listener||e]:function(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}(e):[]},xa.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):Ca.call(t,e)},xa.prototype.listenerCount=Ca,xa.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]},Pa.prototype.push=function(t){var e={data:t,next:null};this.length>0?this.tail.next=e:this.head=e,this.tail=e,++this.length},Pa.prototype.unshift=function(t){var e={data:t,next:this.head};0===this.length&&(this.tail=e),this.head=e,++this.length},Pa.prototype.shift=function(){if(0!==this.length){var t=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,t}},Pa.prototype.clear=function(){this.head=this.tail=null,this.length=0},Pa.prototype.join=function(t){if(0===this.length)return"";for(var e=this.head,n=""+e.data;e=e.next;)n+=t+e.data;return n},Pa.prototype.concat=function(t){if(0===this.length)return mt.alloc(0);if(1===this.length)return this.head.data;for(var e=mt.allocUnsafe(t>>>0),n=this.head,r=0;n;)n.data.copy(e,r),r+=n.data.length,n=n.next;return e};var Da=mt.isEncoding||function(t){switch(t&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function Ia(t){switch(this.encoding=(t||"utf8").toLowerCase().replace(/[-_]/,""),function(t){if(t&&!Da(t))throw new Error("Unknown encoding: "+t)}(t),this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2,this.detectIncompleteChar=Ba;break;case"base64":this.surrogateSize=3,this.detectIncompleteChar=Ha;break;default:return void(this.write=Ra)}this.charBuffer=new mt(6),this.charReceived=0,this.charLength=0}function Ra(t){return t.toString(this.encoding)}function Ba(t){this.charReceived=t.length%2,this.charLength=this.charReceived?2:0}function Ha(t){this.charReceived=t.length%3,this.charLength=this.charReceived?3:0}Ia.prototype.write=function(t){for(var e="";this.charLength;){var n=t.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:t.length;if(t.copy(this.charBuffer,this.charReceived,0,n),this.charReceived+=n,this.charReceived<this.charLength)return"";if(t=t.slice(n,t.length),!((i=(e=this.charBuffer.slice(0,this.charLength).toString(this.encoding)).charCodeAt(e.length-1))>=55296&&i<=56319)){if(this.charReceived=this.charLength=0,0===t.length)return e;break}this.charLength+=this.surrogateSize,e=""}this.detectIncompleteChar(t);var r=t.length;this.charLength&&(t.copy(this.charBuffer,0,t.length-this.charReceived,r),r-=this.charReceived);var i;r=(e+=t.toString(this.encoding,0,r)).length-1;if((i=e.charCodeAt(r))>=55296&&i<=56319){var s=this.surrogateSize;return this.charLength+=s,this.charReceived+=s,this.charBuffer.copy(this.charBuffer,s,0,s),t.copy(this.charBuffer,0,0,s),e.substring(0,r)}return e},Ia.prototype.detectIncompleteChar=function(t){for(var e=t.length>=3?3:t.length;e>0;e--){var n=t[t.length-e];if(1==e&&n>>5==6){this.charLength=2;break}if(e<=2&&n>>4==14){this.charLength=3;break}if(e<=3&&n>>3==30){this.charLength=4;break}}this.charReceived=e},Ia.prototype.end=function(t){var e="";if(t&&t.length&&(e=this.write(t)),this.charReceived){var n=this.charReceived,r=this.charBuffer,i=this.encoding;e+=r.slice(0,n).toString(i)}return e},Na.ReadableState=ka;var _a=function(t){da(na)&&(na=Uo.env.NODE_DEBUG||""),t=t.toUpperCase(),ra[t]||(new RegExp("\\b"+t+"\\b","i").test(na)?ra[t]=function(){var e=function(t){if(!la(t)){for(var e=[],n=0;n<arguments.length;n++)e.push(ia(arguments[n]));return e.join(" ")}n=1;for(var r=arguments,i=r.length,s=String(t).replace(ea,function(t){if("%%"===t)return"%";if(n>=i)return t;switch(t){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(t){return"[Circular]"}default:return t}}),o=r[n];n<i;o=r[++n])fa(o)||!ga(o)?s+=" "+o:s+=" "+ia(o);return s}.apply(null,arguments);console.error("%s %d: %s",t,0,e)}:ra[t]=function(){});return ra[t]}("stream");function ka(t,e){t=t||{},this.objectMode=!!t.objectMode,e instanceof ch&&(this.objectMode=this.objectMode||!!t.readableObjectMode);var n=t.highWaterMark,r=this.objectMode?16:16384;this.highWaterMark=n||0===n?n:r,this.highWaterMark=~~this.highWaterMark,this.buffer=new Pa,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.defaultEncoding=t.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(this.decoder=new Ia(t.encoding),this.encoding=t.encoding)}function Na(t){if(!(this instanceof Na))return new Na(t);this._readableState=new ka(t,this),this.readable=!0,t&&"function"==typeof t.read&&(this._read=t.read),xa.call(this)}function Oa(t,e,n,r,i){var s=function(t,e){var n=null;te(e)||"string"==typeof e||null==e||t.objectMode||(n=new TypeError("Invalid non-string/buffer chunk"));return n}(e,n);if(s)t.emit("error",s);else if(null===n)e.reading=!1,function(t,e){if(e.ended)return;if(e.decoder){var n=e.decoder.end();n&&n.length&&(e.buffer.push(n),e.length+=e.objectMode?1:n.length)}e.ended=!0,Ma(t)}(t,e);else if(e.objectMode||n&&n.length>0)if(e.ended&&!i){var o=new Error("stream.push() after EOF");t.emit("error",o)}else if(e.endEmitted&&i){var a=new Error("stream.unshift() after end event");t.emit("error",a)}else{var h;!e.decoder||i||r||(n=e.decoder.write(n),h=!e.objectMode&&0===n.length),i||(e.reading=!1),h||(e.flowing&&0===e.length&&!e.sync?(t.emit("data",n),t.read(0)):(e.length+=e.objectMode?1:n.length,i?e.buffer.unshift(n):e.buffer.push(n),e.needReadable&&Ma(t))),function(t,e){e.readingMore||(e.readingMore=!0,Po(Ka,t,e))}(t,e)}else i||(e.reading=!1);return function(t){return!t.ended&&(t.needReadable||t.length<t.highWaterMark||0===t.length)}(e)}ta(Na,xa),Na.prototype.push=function(t,e){var n=this._readableState;return n.objectMode||"string"!=typeof t||(e=e||n.defaultEncoding)!==n.encoding&&(t=mt.from(t,e),e=""),Oa(this,n,t,e,!1)},Na.prototype.unshift=function(t){return Oa(this,this._readableState,t,"",!0)},Na.prototype.isPaused=function(){return!1===this._readableState.flowing},Na.prototype.setEncoding=function(t){return this._readableState.decoder=new Ia(t),this._readableState.encoding=t,this};var ja=8388608;function La(t,e){return t<=0||0===e.length&&e.ended?0:e.objectMode?1:t!=t?e.flowing&&e.length?e.buffer.head.data.length:e.length:(t>e.highWaterMark&&(e.highWaterMark=function(t){return t>=ja?t=ja:(t--,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t++),t}(t)),t<=e.length?t:e.ended?e.length:(e.needReadable=!0,0))}function Ma(t){var e=t._readableState;e.needReadable=!1,e.emittedReadable||(_a("emitReadable",e.flowing),e.emittedReadable=!0,e.sync?Po(Va,t):Va(t))}function Va(t){_a("emit readable"),t.emit("readable"),za(t)}function Ka(t,e){for(var n=e.length;!e.reading&&!e.flowing&&!e.ended&&e.length<e.highWaterMark&&(_a("maybeReadMore read 0"),t.read(0),n!==e.length);)n=e.length;e.readingMore=!1}function Ua(t){_a("readable nexttick read 0"),t.read(0)}function qa(t,e){e.reading||(_a("resume read 0"),t.read(0)),e.resumeScheduled=!1,e.awaitDrain=0,t.emit("resume"),za(t),e.flowing&&!e.reading&&t.read(0)}function za(t){var e=t._readableState;for(_a("flow",e.flowing);e.flowing&&null!==t.read(););}function Ya(t,e){return 0===e.length?null:(e.objectMode?n=e.buffer.shift():!t||t>=e.length?(n=e.decoder?e.buffer.join(""):1===e.buffer.length?e.buffer.head.data:e.buffer.concat(e.length),e.buffer.clear()):n=function(t,e,n){var r;t<e.head.data.length?(r=e.head.data.slice(0,t),e.head.data=e.head.data.slice(t)):r=t===e.head.data.length?e.shift():n?function(t,e){var n=e.head,r=1,i=n.data;t-=i.length;for(;n=n.next;){var s=n.data,o=t>s.length?s.length:t;if(o===s.length?i+=s:i+=s.slice(0,t),0===(t-=o)){o===s.length?(++r,n.next?e.head=n.next:e.head=e.tail=null):(e.head=n,n.data=s.slice(o));break}++r}return e.length-=r,i}(t,e):function(t,e){var n=mt.allocUnsafe(t),r=e.head,i=1;r.data.copy(n),t-=r.data.length;for(;r=r.next;){var s=r.data,o=t>s.length?s.length:t;if(s.copy(n,n.length-t,0,o),0===(t-=o)){o===s.length?(++i,r.next?e.head=r.next:e.head=e.tail=null):(e.head=r,r.data=s.slice(o));break}++i}return e.length-=i,n}(t,e);return r}(t,e.buffer,e.decoder),n);var n}function Wa(t){var e=t._readableState;if(e.length>0)throw new Error('"endReadable()" called on non-empty stream');e.endEmitted||(e.ended=!0,Po(Ga,e,t))}function Ga(t,e){t.endEmitted||0!==t.length||(t.endEmitted=!0,e.readable=!1,e.emit("end"))}function Ja(t,e){for(var n=0,r=t.length;n<r;n++)if(t[n]===e)return n;return-1}function Xa(){}function $a(t,e,n){this.chunk=t,this.encoding=e,this.callback=n,this.next=null}function Za(t,e){Object.defineProperty(this,"buffer",{get:function t(e,n){if(da(it.process))return function(){return t(e,n).apply(this,arguments)};var r=!1;return function(){return r||(console.error(n),r=!0),e.apply(this,arguments)}}(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.")}),t=t||{},this.objectMode=!!t.objectMode,e instanceof ch&&(this.objectMode=this.objectMode||!!t.writableObjectMode);var n=t.highWaterMark,r=this.objectMode?16:16384;this.highWaterMark=n||0===n?n:r,this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var i=!1===t.decodeStrings;this.decodeStrings=!i,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(t){!function(t,e){var n=t._writableState,r=n.sync,i=n.writecb;if(function(t){t.writing=!1,t.writecb=null,t.length-=t.writelen,t.writelen=0}(n),e)!function(t,e,n,r,i){--e.pendingcb,n?Po(i,r):i(r);t._writableState.errorEmitted=!0,t.emit("error",r)}(t,n,r,e,i);else{var s=rh(n);s||n.corked||n.bufferProcessing||!n.bufferedRequest||nh(t,n),r?Po(eh,t,n,s,i):eh(t,n,s,i)}}(e,t)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new oh(this)}function Qa(t){if(!(this instanceof Qa||this instanceof ch))return new Qa(t);this._writableState=new Za(t,this),this.writable=!0,t&&("function"==typeof t.write&&(this._write=t.write),"function"==typeof t.writev&&(this._writev=t.writev)),xa.call(this)}function th(t,e,n,r,i,s,o){e.writelen=r,e.writecb=o,e.writing=!0,e.sync=!0,n?t._writev(i,e.onwrite):t._write(i,s,e.onwrite),e.sync=!1}function eh(t,e,n,r){n||function(t,e){0===e.length&&e.needDrain&&(e.needDrain=!1,t.emit("drain"))}(t,e),e.pendingcb--,r(),sh(t,e)}function nh(t,e){e.bufferProcessing=!0;var n=e.bufferedRequest;if(t._writev&&n&&n.next){var r=e.bufferedRequestCount,i=new Array(r),s=e.corkedRequestsFree;s.entry=n;for(var o=0;n;)i[o]=n,n=n.next,o+=1;th(t,e,!0,e.length,i,"",s.finish),e.pendingcb++,e.lastBufferedRequest=null,s.next?(e.corkedRequestsFree=s.next,s.next=null):e.corkedRequestsFree=new oh(e)}else{for(;n;){var a=n.chunk,h=n.encoding,u=n.callback;if(th(t,e,!1,e.objectMode?1:a.length,a,h,u),n=n.next,e.writing)break}null===n&&(e.lastBufferedRequest=null)}e.bufferedRequestCount=0,e.bufferedRequest=n,e.bufferProcessing=!1}function rh(t){return t.ending&&0===t.length&&null===t.bufferedRequest&&!t.finished&&!t.writing}function ih(t,e){e.prefinished||(e.prefinished=!0,t.emit("prefinish"))}function sh(t,e){var n=rh(e);return n&&(0===e.pendingcb?(ih(t,e),e.finished=!0,t.emit("finish")):ih(t,e)),n}function oh(t){var e=this;this.next=null,this.entry=null,this.finish=function(n){var r=e.entry;for(e.entry=null;r;){var i=r.callback;t.pendingcb--,i(n),r=r.next}t.corkedRequestsFree?t.corkedRequestsFree.next=e:t.corkedRequestsFree=e}}Na.prototype.read=function(t){_a("read",t),t=parseInt(t,10);var e=this._readableState,n=t;if(0!==t&&(e.emittedReadable=!1),0===t&&e.needReadable&&(e.length>=e.highWaterMark||e.ended))return _a("read: emitReadable",e.length,e.ended),0===e.length&&e.ended?Wa(this):Ma(this),null;if(0===(t=La(t,e))&&e.ended)return 0===e.length&&Wa(this),null;var r,i=e.needReadable;return _a("need readable",i),(0===e.length||e.length-t<e.highWaterMark)&&_a("length less than watermark",i=!0),e.ended||e.reading?_a("reading or ended",i=!1):i&&(_a("do read"),e.reading=!0,e.sync=!0,0===e.length&&(e.needReadable=!0),this._read(e.highWaterMark),e.sync=!1,e.reading||(t=La(n,e))),null===(r=t>0?Ya(t,e):null)?(e.needReadable=!0,t=0):e.length-=t,0===e.length&&(e.ended||(e.needReadable=!0),n!==t&&e.ended&&Wa(this)),null!==r&&this.emit("data",r),r},Na.prototype._read=function(t){this.emit("error",new Error("not implemented"))},Na.prototype.pipe=function(t,e){var n=this,r=this._readableState;switch(r.pipesCount){case 0:r.pipes=t;break;case 1:r.pipes=[r.pipes,t];break;default:r.pipes.push(t)}r.pipesCount+=1,_a("pipe count=%d opts=%j",r.pipesCount,e);var i=!e||!1!==e.end?o:u;function s(t){_a("onunpipe"),t===n&&u()}function o(){_a("onend"),t.end()}r.endEmitted?Po(i):n.once("end",i),t.on("unpipe",s);var a=function(t){return function(){var e=t._readableState;_a("pipeOnDrain",e.awaitDrain),e.awaitDrain&&e.awaitDrain--,0===e.awaitDrain&&t.listeners("data").length&&(e.flowing=!0,za(t))}}(n);t.on("drain",a);var h=!1;function u(){_a("cleanup"),t.removeListener("close",d),t.removeListener("finish",p),t.removeListener("drain",a),t.removeListener("error",l),t.removeListener("unpipe",s),n.removeListener("end",o),n.removeListener("end",u),n.removeListener("data",f),h=!0,!r.awaitDrain||t._writableState&&!t._writableState.needDrain||a()}var c=!1;function f(e){_a("ondata"),c=!1,!1!==t.write(e)||c||((1===r.pipesCount&&r.pipes===t||r.pipesCount>1&&-1!==Ja(r.pipes,t))&&!h&&(_a("false write response, pause",n._readableState.awaitDrain),n._readableState.awaitDrain++,c=!0),n.pause())}function l(e){var n;_a("onerror",e),g(),t.removeListener("error",l),0===(n="error",t.listeners(n).length)&&t.emit("error",e)}function d(){t.removeListener("finish",p),g()}function p(){_a("onfinish"),t.removeListener("close",d),g()}function g(){_a("unpipe"),n.unpipe(t)}return n.on("data",f),function(t,e,n){if("function"==typeof t.prependListener)return t.prependListener(e,n);t._events&&t._events[e]?Array.isArray(t._events[e])?t._events[e].unshift(n):t._events[e]=[n,t._events[e]]:t.on(e,n)}(t,"error",l),t.once("close",d),t.once("finish",p),t.emit("pipe",n),r.flowing||(_a("pipe resume"),n.resume()),t},Na.prototype.unpipe=function(t){var e=this._readableState;if(0===e.pipesCount)return this;if(1===e.pipesCount)return t&&t!==e.pipes?this:(t||(t=e.pipes),e.pipes=null,e.pipesCount=0,e.flowing=!1,t&&t.emit("unpipe",this),this);if(!t){var n=e.pipes,r=e.pipesCount;e.pipes=null,e.pipesCount=0,e.flowing=!1;for(var i=0;i<r;i++)n[i].emit("unpipe",this);return this}var s=Ja(e.pipes,t);return-1===s?this:(e.pipes.splice(s,1),e.pipesCount-=1,1===e.pipesCount&&(e.pipes=e.pipes[0]),t.emit("unpipe",this),this)},Na.prototype.on=function(t,e){var n=xa.prototype.on.call(this,t,e);if("data"===t)!1!==this._readableState.flowing&&this.resume();else if("readable"===t){var r=this._readableState;r.endEmitted||r.readableListening||(r.readableListening=r.needReadable=!0,r.emittedReadable=!1,r.reading?r.length&&Ma(this):Po(Ua,this))}return n},Na.prototype.addListener=Na.prototype.on,Na.prototype.resume=function(){var t=this._readableState;return t.flowing||(_a("resume"),t.flowing=!0,function(t,e){e.resumeScheduled||(e.resumeScheduled=!0,Po(qa,t,e))}(this,t)),this},Na.prototype.pause=function(){return _a("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(_a("pause"),this._readableState.flowing=!1,this.emit("pause")),this},Na.prototype.wrap=function(t){var e=this._readableState,n=!1,r=this;for(var i in t.on("end",function(){if(_a("wrapped end"),e.decoder&&!e.ended){var t=e.decoder.end();t&&t.length&&r.push(t)}r.push(null)}),t.on("data",function(i){(_a("wrapped data"),e.decoder&&(i=e.decoder.write(i)),e.objectMode&&null==i)||(e.objectMode||i&&i.length)&&(r.push(i)||(n=!0,t.pause()))}),t)void 0===this[i]&&"function"==typeof t[i]&&(this[i]=function(e){return function(){return t[e].apply(t,arguments)}}(i));return function(t,e){for(var n=0,r=t.length;n<r;n++)e(t[n],n)}(["error","close","destroy","pause","resume"],function(e){t.on(e,r.emit.bind(r,e))}),r._read=function(e){_a("wrapped _read",e),n&&(n=!1,t.resume())},r},Na._fromList=Ya,Qa.WritableState=Za,ta(Qa,xa),Za.prototype.getBuffer=function(){for(var t=this.bufferedRequest,e=[];t;)e.push(t),t=t.next;return e},Qa.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},Qa.prototype.write=function(t,e,n){var r=this._writableState,i=!1;return"function"==typeof e&&(n=e,e=null),mt.isBuffer(t)?e="buffer":e||(e=r.defaultEncoding),"function"!=typeof n&&(n=Xa),r.ended?function(t,e){var n=new Error("write after end");t.emit("error",n),Po(e,n)}(this,n):function(t,e,n,r){var i=!0,s=!1;return null===n?s=new TypeError("May not write null values to stream"):mt.isBuffer(n)||"string"==typeof n||void 0===n||e.objectMode||(s=new TypeError("Invalid non-string/buffer chunk")),s&&(t.emit("error",s),Po(r,s),i=!1),i}(this,r,t,n)&&(r.pendingcb++,i=function(t,e,n,r,i){n=function(t,e,n){return t.objectMode||!1===t.decodeStrings||"string"!=typeof e||(e=mt.from(e,n)),e}(e,n,r),mt.isBuffer(n)&&(r="buffer");var s=e.objectMode?1:n.length;e.length+=s;var o=e.length<e.highWaterMark;o||(e.needDrain=!0);if(e.writing||e.corked){var a=e.lastBufferedRequest;e.lastBufferedRequest=new $a(n,r,i),a?a.next=e.lastBufferedRequest:e.bufferedRequest=e.lastBufferedRequest,e.bufferedRequestCount+=1}else th(t,e,!1,s,n,r,i);return o}(this,r,t,e,n)),i},Qa.prototype.cork=function(){this._writableState.corked++},Qa.prototype.uncork=function(){var t=this._writableState;t.corked&&(t.corked--,t.writing||t.corked||t.finished||t.bufferProcessing||!t.bufferedRequest||nh(this,t))},Qa.prototype.setDefaultEncoding=function(t){if("string"==typeof t&&(t=t.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((t+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+t);return this._writableState.defaultEncoding=t,this},Qa.prototype._write=function(t,e,n){n(new Error("not implemented"))},Qa.prototype._writev=null,Qa.prototype.end=function(t,e,n){var r=this._writableState;"function"==typeof t?(n=t,t=null,e=null):"function"==typeof e&&(n=e,e=null),null!=t&&this.write(t,e),r.corked&&(r.corked=1,this.uncork()),r.ending||r.finished||function(t,e,n){e.ending=!0,sh(t,e),n&&(e.finished?Po(n):t.once("finish",n));e.ended=!0,t.writable=!1}(this,r,n)},ta(ch,Na);for(var ah=Object.keys(Qa.prototype),hh=0;hh<ah.length;hh++){var uh=ah[hh];ch.prototype[uh]||(ch.prototype[uh]=Qa.prototype[uh])}function ch(t){if(!(this instanceof ch))return new ch(t);Na.call(this,t),Qa.call(this,t),t&&!1===t.readable&&(this.readable=!1),t&&!1===t.writable&&(this.writable=!1),this.allowHalfOpen=!0,t&&!1===t.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",fh)}function fh(){this.allowHalfOpen||this._writableState.ended||Po(lh,this)}function lh(t){t.end()}function dh(t){this.afterTransform=function(e,n){return function(t,e,n){var r=t._transformState;r.transforming=!1;var i=r.writecb;if(!i)return t.emit("error",new Error("no writecb in Transform class"));r.writechunk=null,r.writecb=null,null!=n&&t.push(n);i(e);var s=t._readableState;s.reading=!1,(s.needReadable||s.length<s.highWaterMark)&&t._read(s.highWaterMark)}(t,e,n)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null,this.writeencoding=null}function ph(t){if(!(this instanceof ph))return new ph(t);ch.call(this,t),this._transformState=new dh(this);var e=this;this._readableState.needReadable=!0,this._readableState.sync=!1,t&&("function"==typeof t.transform&&(this._transform=t.transform),"function"==typeof t.flush&&(this._flush=t.flush)),this.once("prefinish",function(){"function"==typeof this._flush?this._flush(function(t){gh(e,t)}):gh(e)})}function gh(t,e){if(e)return t.emit("error",e);var n=t._writableState,r=t._transformState;if(n.length)throw new Error("Calling transform done when ws.length != 0");if(r.transforming)throw new Error("Calling transform done when still transforming");return t.push(null)}function yh(t){if(!(this instanceof yh))return new yh(t);ph.call(this,t)}function vh(){xa.call(this)}ta(ph,ch),ph.prototype.push=function(t,e){return this._transformState.needTransform=!1,ch.prototype.push.call(this,t,e)},ph.prototype._transform=function(t,e,n){throw new Error("Not implemented")},ph.prototype._write=function(t,e,n){var r=this._transformState;if(r.writecb=n,r.writechunk=t,r.writeencoding=e,!r.transforming){var i=this._readableState;(r.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},ph.prototype._read=function(t){var e=this._transformState;null!==e.writechunk&&e.writecb&&!e.transforming?(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform)):e.needTransform=!0},ta(yh,ph),yh.prototype._transform=function(t,e,n){n(null,t)},ta(vh,xa),vh.Readable=Na,vh.Writable=Qa,vh.Duplex=ch,vh.Transform=ph,vh.PassThrough=yh,vh.Stream=vh,vh.prototype.pipe=function(t,e){var n=this;function r(e){t.writable&&!1===t.write(e)&&n.pause&&n.pause()}function i(){n.readable&&n.resume&&n.resume()}n.on("data",r),t.on("drain",i),t._isStdio||e&&!1===e.end||(n.on("end",o),n.on("close",a));var s=!1;function o(){s||(s=!0,t.end())}function a(){s||(s=!0,"function"==typeof t.destroy&&t.destroy())}function h(t){if(u(),0===xa.listenerCount(this,"error"))throw t}function u(){n.removeListener("data",r),t.removeListener("drain",i),n.removeListener("end",o),n.removeListener("close",a),n.removeListener("error",h),t.removeListener("error",h),n.removeListener("end",u),n.removeListener("close",u),t.removeListener("close",u)}return n.on("error",h),t.on("error",h),n.on("end",u),n.on("close",u),t.on("close",u),t.emit("pipe",n),t};var mh=3,wh=4;function bh(t,e,n){var r,i=this;if(Na.call(i),i._mode=n,i.headers={},i.rawHeaders=[],i.trailers={},i.rawTrailers=[],i.on("end",function(){Po(function(){i.emit("close")})}),"fetch"===n){i._fetchResponse=e,i.url=e.url,i.statusCode=e.status,i.statusMessage=e.statusText;for(var s,o,a=e.headers[Symbol.iterator]();s=(o=a.next()).value,!o.done;)i.headers[s[0].toLowerCase()]=s[1],i.rawHeaders.push(s[0],s[1]);var h=e.body.getReader();(r=function(){h.read().then(function(t){i._destroyed||(t.done?i.push(null):(i.push(new mt(t.value)),r()))})})()}else{if(i._xhr=t,i._pos=0,i.url=t.responseURL,i.statusCode=t.status,i.statusMessage=t.statusText,t.getAllResponseHeaders().split(/\r?\n/).forEach(function(t){var e=t.match(/^([^:]+):\s*(.*)/);if(e){var n=e[1].toLowerCase();"set-cookie"===n?(void 0===i.headers[n]&&(i.headers[n]=[]),i.headers[n].push(e[2])):void 0!==i.headers[n]?i.headers[n]+=", "+e[2]:i.headers[n]=e[2],i.rawHeaders.push(e[1],e[2])}}),i._charset="x-user-defined",!$o){var u=i.rawHeaders["mime-type"];if(u){var c=u.match(/;\s*charset=([^;])(;|$)/);c&&(i._charset=c[1].toLowerCase())}i._charset||(i._charset="utf-8")}}}function Sh(t){var e,n=this;Qa.call(n),n._opts=t,n._body=[],n._headers={},t.auth&&n.setHeader("Authorization","Basic "+new mt(t.auth).toString("base64")),Object.keys(t.headers).forEach(function(e){n.setHeader(e,t.headers[e])});var r=!0;if("disable-fetch"===t.mode)r=!1,e=!0;else if("prefer-streaming"===t.mode)e=!1;else if("allow-wrong-content-type"===t.mode)e=!$o;else{if(t.mode&&"default"!==t.mode&&"prefer-fast"!==t.mode)throw new Error("Invalid value for opts.mode");e=!0}n._mode=function(t,e){return qo&&e?"fetch":Xo?"moz-chunked-arraybuffer":Jo?"ms-stream":Go&&t?"arraybuffer":Zo&&t?"text:vbarray":"text"}(e,r),n.on("finish",function(){n._onFinish()})}ta(bh,Na),bh.prototype._read=function(){},bh.prototype._onXHRProgress=function(){var t=this,e=t._xhr,n=null;switch(t._mode){case"text:vbarray":if(e.readyState!==wh)break;try{n=new it.VBArray(e.responseBody).toArray()}catch(t){}if(null!==n){t.push(new mt(n));break}case"text":try{n=e.responseText}catch(e){t._mode="text:vbarray";break}if(n.length>t._pos){var r=n.substr(t._pos);if("x-user-defined"===t._charset){for(var i=new mt(r.length),s=0;s<r.length;s++)i[s]=255&r.charCodeAt(s);t.push(i)}else t.push(r,t._charset);t._pos=n.length}break;case"arraybuffer":if(e.readyState!==wh||!e.response)break;n=e.response,t.push(new mt(new Uint8Array(n)));break;case"moz-chunked-arraybuffer":if(n=e.response,e.readyState!==mh||!n)break;t.push(new mt(new Uint8Array(n)));break;case"ms-stream":if(n=e.response,e.readyState!==mh)break;var o=new it.MSStreamReader;o.onprogress=function(){o.result.byteLength>t._pos&&(t.push(new mt(new Uint8Array(o.result.slice(t._pos)))),t._pos=o.result.byteLength)},o.onload=function(){t.push(null)},o.readAsArrayBuffer(n)}t._xhr.readyState===wh&&"ms-stream"!==t._mode&&t.push(null)},ta(Sh,Qa);var xh=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","cookie","cookie2","date","dnt","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","user-agent","via"];Sh.prototype.setHeader=function(t,e){var n=t.toLowerCase();-1===xh.indexOf(n)&&(this._headers[n]={name:t,value:e})},Sh.prototype.getHeader=function(t){return this._headers[t.toLowerCase()].value},Sh.prototype.removeHeader=function(t){delete this._headers[t.toLowerCase()]},Sh.prototype._onFinish=function(){var t=this;if(!t._destroyed){var e,n=t._opts,r=t._headers;if("POST"!==n.method&&"PUT"!==n.method&&"PATCH"!==n.method||(e=function(){if(void 0!==Vo)return Vo;try{new it.Blob([new ArrayBuffer(1)]),Vo=!0}catch(t){Vo=!1}return Vo}()?new it.Blob(t._body.map(function(t){return function(t){if(t instanceof Uint8Array){if(0===t.byteOffset&&t.byteLength===t.buffer.byteLength)return t.buffer;if("function"==typeof t.buffer.slice)return t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength)}if(te(t)){for(var e=new Uint8Array(t.length),n=t.length,r=0;r<n;r++)e[r]=t[r];return e.buffer}throw new Error("Argument must be a Buffer")}(t)}),{type:(r["content-type"]||{}).value||""}):mt.concat(t._body).toString()),"fetch"===t._mode){var i=Object.keys(r).map(function(t){return[r[t].name,r[t].value]});it.fetch(t._opts.url,{method:t._opts.method,headers:i,body:e,mode:"cors",credentials:n.withCredentials?"include":"same-origin"}).then(function(e){t._fetchResponse=e,t._connect()},function(e){t.emit("error",e)})}else{var s=t._xhr=new it.XMLHttpRequest;try{s.open(t._opts.method,t._opts.url,!0)}catch(e){return void Po(function(){t.emit("error",e)})}"responseType"in s&&(s.responseType=t._mode.split(":")[0]),"withCredentials"in s&&(s.withCredentials=!!n.withCredentials),"text"===t._mode&&"overrideMimeType"in s&&s.overrideMimeType("text/plain; charset=x-user-defined"),Object.keys(r).forEach(function(t){s.setRequestHeader(r[t].name,r[t].value)}),t._response=null,s.onreadystatechange=function(){switch(s.readyState){case mh:case wh:t._onXHRProgress()}},"moz-chunked-arraybuffer"===t._mode&&(s.onprogress=function(){t._onXHRProgress()}),s.onerror=function(){t._destroyed||t.emit("error",new Error("XHR error"))};try{s.send(e)}catch(e){return void Po(function(){t.emit("error",e)})}}}},Sh.prototype._onXHRProgress=function(){(function(t){try{var e=t.status;return null!==e&&0!==e}catch(t){return!1}})(this._xhr)&&!this._destroyed&&(this._response||this._connect(),this._response._onXHRProgress())},Sh.prototype._connect=function(){this._destroyed||(this._response=new bh(this._xhr,this._fetchResponse,this._mode),this.emit("response",this._response))},Sh.prototype._write=function(t,e,n){this._body.push(t),n()},Sh.prototype.abort=Sh.prototype.destroy=function(){this._destroyed=!0,this._response&&(this._response._destroyed=!0),this._xhr&&this._xhr.abort()},Sh.prototype.end=function(t,e,n){"function"==typeof t&&(n=t,t=void 0),Qa.prototype.end.call(this,t,e,n)},Sh.prototype.flushHeaders=function(){},Sh.prototype.setTimeout=function(){},Sh.prototype.setNoDelay=function(){},Sh.prototype.setSocketKeepAlive=function(){};var Eh=2147483647,Fh=36,Ah=1,Ch=26,Th=38,Ph=700,Dh=72,Ih=128,Rh="-",Bh=/[^\x20-\x7E]/,Hh=/[\x2E\u3002\uFF0E\uFF61]/g,_h={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},kh=Fh-Ah,Nh=Math.floor,Oh=String.fromCharCode;function jh(t){throw new RangeError(_h[t])}function Lh(t,e){return t+22+75*(t<26)-((0!=e)<<5)}function Mh(t,e,n){var r=0;for(t=n?Nh(t/Ph):t>>1,t+=Nh(t/e);t>kh*Ch>>1;r+=Fh)t=Nh(t/kh);return Nh(r+(kh+1)*t/(t+Th))}function Vh(t){return function(t,e){var n=t.split("@"),r="";n.length>1&&(r=n[0]+"@",t=n[1]);var i=function(t,e){for(var n=t.length,r=[];n--;)r[n]=e(t[n]);return r}((t=t.replace(Hh,".")).split("."),e).join(".");return r+i}(t,function(t){return Bh.test(t)?"xn--"+function(t){var e,n,r,i,s,o,a,h,u,c,f,l,d,p,g,y=[];for(l=(t=function(t){for(var e,n,r=[],i=0,s=t.length;i<s;)(e=t.charCodeAt(i++))>=55296&&e<=56319&&i<s?56320==(64512&(n=t.charCodeAt(i++)))?r.push(((1023&e)<<10)+(1023&n)+65536):(r.push(e),i--):r.push(e);return r}(t)).length,e=Ih,n=0,s=Dh,o=0;o<l;++o)(f=t[o])<128&&y.push(Oh(f));for(r=i=y.length,i&&y.push(Rh);r<l;){for(a=Eh,o=0;o<l;++o)(f=t[o])>=e&&f<a&&(a=f);for(a-e>Nh((Eh-n)/(d=r+1))&&jh("overflow"),n+=(a-e)*d,e=a,o=0;o<l;++o)if((f=t[o])<e&&++n>Eh&&jh("overflow"),f==e){for(h=n,u=Fh;!(h<(c=u<=s?Ah:u>=s+Ch?Ch:u-s));u+=Fh)g=h-c,p=Fh-c,y.push(Oh(Lh(c+g%p,0))),h=Nh(g/p);y.push(Oh(Lh(h,0))),s=Mh(n,d,r==i),n=0,++r}++n,++e}return y.join("")}(t):t})}function Kh(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var Uh=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};function qh(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}}function zh(t,e){if(t.map)return t.map(e);for(var n=[],r=0;r<t.length;r++)n.push(e(t[r],r));return n}var Yh=Object.keys||function(t){var e=[];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.push(n);return e};function Wh(t,e,n,r){e=e||"&",n=n||"=";var i={};if("string"!=typeof t||0===t.length)return i;var s=/\+/g;t=t.split(e);var o=1e3;r&&"number"==typeof r.maxKeys&&(o=r.maxKeys);var a=t.length;o>0&&a>o&&(a=o);for(var h=0;h<a;++h){var u,c,f,l,d=t[h].replace(s,"%20"),p=d.indexOf(n);p>=0?(u=d.substr(0,p),c=d.substr(p+1)):(u=d,c=""),f=decodeURIComponent(u),l=decodeURIComponent(c),Kh(i,f)?Uh(i[f])?i[f].push(l):i[f]=[i[f],l]:i[f]=l}return i}function Gh(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var Jh=/^([a-z0-9.+-]+:)/i,Xh=/:[0-9]*$/,$h=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,Zh=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),Qh=["'"].concat(Zh),tu=["%","/","?",";","#"].concat(Qh),eu=["/","?","#"],nu=255,ru=/^[+a-z0-9A-Z_-]{0,63}$/,iu=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,su={javascript:!0,"javascript:":!0},ou={javascript:!0,"javascript:":!0},au={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0};function hu(t,e,n){if(t&&ga(t)&&t instanceof Gh)return t;var r=new Gh;return r.parse(t,e,n),r}function uu(t){var e=t.auth||"";e&&(e=(e=encodeURIComponent(e)).replace(/%3A/i,":"),e+="@");var n,r,i,s,o=t.protocol||"",a=t.pathname||"",h=t.hash||"",u=!1,c="";t.host?u=e+t.host:t.hostname&&(u=e+(-1===t.hostname.indexOf(":")?t.hostname:"["+this.hostname+"]"),t.port&&(u+=":"+t.port)),t.query&&ga(t.query)&&Object.keys(t.query).length&&(n=t.query,r=r||"&",i=i||"=",null===n&&(n=void 0),c="object"==typeof n?zh(Yh(n),function(t){var e=encodeURIComponent(qh(t))+i;return Uh(n[t])?zh(n[t],function(t){return e+encodeURIComponent(qh(t))}).join(r):e+encodeURIComponent(qh(n[t]))}).join(r):s?encodeURIComponent(qh(s))+i+encodeURIComponent(qh(n)):"");var f=t.search||c&&"?"+c||"";return o&&":"!==o.substr(-1)&&(o+=":"),t.slashes||(!o||au[o])&&!1!==u?(u="//"+(u||""),a&&"/"!==a.charAt(0)&&(a="/"+a)):u||(u=""),h&&"#"!==h.charAt(0)&&(h="#"+h),f&&"?"!==f.charAt(0)&&(f="?"+f),o+u+(a=a.replace(/[?#]/g,function(t){return encodeURIComponent(t)}))+(f=f.replace("#","%23"))+h}function cu(t){var e=t.host,n=Xh.exec(e);n&&(":"!==(n=n[0])&&(t.port=n.substr(1)),e=e.substr(0,e.length-n.length)),e&&(t.hostname=e)}function fu(t,e){"string"==typeof t&&(t=hu(t));var n=-1===it.location.protocol.search(/^https?:$/)?"http:":"",r=t.protocol||n,i=t.hostname||t.host,s=t.port,o=t.path||"/";i&&-1!==i.indexOf(":")&&(i="["+i+"]"),t.url=(i?r+"//"+i:"")+(s?":"+s:"")+o,t.method=(t.method||"GET").toUpperCase(),t.headers=t.headers||{};var a=new Sh(t);return e&&a.on("response",e),a}function lu(t,e){var n=fu(t,e);return n.end(),n}function du(){}Gh.prototype.parse=function(t,e,n){return function(t,e,n,r){if(!la(e))throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var i=e.indexOf("?"),s=-1!==i&&i<e.indexOf("#")?"?":"#",o=e.split(s);o[0]=o[0].replace(/\\/g,"/");var a=e=o.join(s);if(a=a.trim(),!r&&1===e.split("#").length){var h=$h.exec(a);if(h)return t.path=a,t.href=a,t.pathname=h[1],h[2]?(t.search=h[2],t.query=n?Wh(t.search.substr(1)):t.search.substr(1)):n&&(t.search="",t.query={}),t}var u,c,f,l,d=Jh.exec(a);if(d){var p=(d=d[0]).toLowerCase();t.protocol=p,a=a.substr(d.length)}if(r||d||a.match(/^\/\/[^@\/]+@[^@\/]+/)){var g="//"===a.substr(0,2);!g||d&&ou[d]||(a=a.substr(2),t.slashes=!0)}if(!ou[d]&&(g||d&&!au[d])){var y,v,m=-1;for(u=0;u<eu.length;u++)-1!==(c=a.indexOf(eu[u]))&&(-1===m||c<m)&&(m=c);for(-1!==(v=-1===m?a.lastIndexOf("@"):a.lastIndexOf("@",m))&&(y=a.slice(0,v),a=a.slice(v+1),t.auth=decodeURIComponent(y)),m=-1,u=0;u<tu.length;u++)-1!==(c=a.indexOf(tu[u]))&&(-1===m||c<m)&&(m=c);-1===m&&(m=a.length),t.host=a.slice(0,m),a=a.slice(m),cu(t),t.hostname=t.hostname||"";var w="["===t.hostname[0]&&"]"===t.hostname[t.hostname.length-1];if(!w){var b=t.hostname.split(/\./);for(u=0,f=b.length;u<f;u++){var S=b[u];if(S&&!S.match(ru)){for(var x="",E=0,F=S.length;E<F;E++)S.charCodeAt(E)>127?x+="x":x+=S[E];if(!x.match(ru)){var A=b.slice(0,u),C=b.slice(u+1),T=S.match(iu);T&&(A.push(T[1]),C.unshift(T[2])),C.length&&(a="/"+C.join(".")+a),t.hostname=A.join(".");break}}}}t.hostname.length>nu?t.hostname="":t.hostname=t.hostname.toLowerCase(),w||(t.hostname=Vh(t.hostname)),l=t.port?":"+t.port:"";var P=t.hostname||"";t.host=P+l,t.href+=t.host,w&&(t.hostname=t.hostname.substr(1,t.hostname.length-2),"/"!==a[0]&&(a="/"+a))}if(!su[p])for(u=0,f=Qh.length;u<f;u++){var D=Qh[u];if(-1!==a.indexOf(D)){var I=encodeURIComponent(D);I===D&&(I=escape(D)),a=a.split(D).join(I)}}var R=a.indexOf("#");-1!==R&&(t.hash=a.substr(R),a=a.slice(0,R));var B=a.indexOf("?");-1!==B?(t.search=a.substr(B),t.query=a.substr(B+1),n&&(t.query=Wh(t.query)),a=a.slice(0,B)):n&&(t.search="",t.query={});a&&(t.pathname=a);au[p]&&t.hostname&&!t.pathname&&(t.pathname="/");if(t.pathname||t.search){l=t.pathname||"";var H=t.search||"";t.path=l+H}return t.href=uu(t),t}(this,t,e,n)},Gh.prototype.format=function(){return uu(this)},Gh.prototype.resolve=function(t){return this.resolveObject(hu(t,!1,!0)).format()},Gh.prototype.resolveObject=function(t){if(la(t)){var e=new Gh;e.parse(t,!1,!0),t=e}for(var n,r=new Gh,i=Object.keys(this),s=0;s<i.length;s++){var o=i[s];r[o]=this[o]}if(r.hash=t.hash,""===t.href)return r.href=r.format(),r;if(t.slashes&&!t.protocol){for(var a=Object.keys(t),h=0;h<a.length;h++){var u=a[h];"protocol"!==u&&(r[u]=t[u])}return au[r.protocol]&&r.hostname&&!r.pathname&&(r.path=r.pathname="/"),r.href=r.format(),r}if(t.protocol&&t.protocol!==r.protocol){if(!au[t.protocol]){for(var c=Object.keys(t),f=0;f<c.length;f++){var l=c[f];r[l]=t[l]}return r.href=r.format(),r}if(r.protocol=t.protocol,t.host||ou[t.protocol])r.pathname=t.pathname;else{for(n=(t.pathname||"").split("/");n.length&&!(t.host=n.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),""!==n[0]&&n.unshift(""),n.length<2&&n.unshift(""),r.pathname=n.join("/")}if(r.search=t.search,r.query=t.query,r.host=t.host||"",r.auth=t.auth,r.hostname=t.hostname||t.host,r.port=t.port,r.pathname||r.search){var d=r.pathname||"",p=r.search||"";r.path=d+p}return r.slashes=r.slashes||t.slashes,r.href=r.format(),r}var g,y=r.pathname&&"/"===r.pathname.charAt(0),v=t.host||t.pathname&&"/"===t.pathname.charAt(0),m=v||y||r.host&&t.pathname,w=m,b=r.pathname&&r.pathname.split("/")||[],S=r.protocol&&!au[r.protocol];if(n=t.pathname&&t.pathname.split("/")||[],S&&(r.hostname="",r.port=null,r.host&&(""===b[0]?b[0]=r.host:b.unshift(r.host)),r.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(""===n[0]?n[0]=t.host:n.unshift(t.host)),t.host=null),m=m&&(""===n[0]||""===b[0])),v)r.host=t.host||""===t.host?t.host:r.host,r.hostname=t.hostname||""===t.hostname?t.hostname:r.hostname,r.search=t.search,r.query=t.query,b=n;else if(n.length)b||(b=[]),b.pop(),b=b.concat(n),r.search=t.search,r.query=t.query;else if(null!=t.search)return S&&(r.hostname=r.host=b.shift(),(g=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@"))&&(r.auth=g.shift(),r.host=r.hostname=g.shift())),r.search=t.search,r.query=t.query,fa(r.pathname)&&fa(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.href=r.format(),r;if(!b.length)return r.pathname=null,r.search?r.path="/"+r.search:r.path=null,r.href=r.format(),r;for(var x=b.slice(-1)[0],E=(r.host||t.host||b.length>1)&&("."===x||".."===x)||""===x,F=0,A=b.length;A>=0;A--)"."===(x=b[A])?b.splice(A,1):".."===x?(b.splice(A,1),F++):F&&(b.splice(A,1),F--);if(!m&&!w)for(;F--;F)b.unshift("..");!m||""===b[0]||b[0]&&"/"===b[0].charAt(0)||b.unshift(""),E&&"/"!==b.join("/").substr(-1)&&b.push("");var C=""===b[0]||b[0]&&"/"===b[0].charAt(0);return S&&(r.hostname=r.host=C?"":b.length?b.shift():"",(g=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@"))&&(r.auth=g.shift(),r.host=r.hostname=g.shift())),(m=m||r.host&&b.length)&&!C&&b.unshift(""),b.length?r.pathname=b.join("/"):(r.pathname=null,r.path=null),fa(r.pathname)&&fa(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.auth=t.auth||r.auth,r.slashes=r.slashes||t.slashes,r.href=r.format(),r},Gh.prototype.parseHost=function(){return cu(this)},du.defaultMaxSockets=4;var pu=["CHECKOUT","CONNECT","COPY","DELETE","GET","HEAD","LOCK","M-SEARCH","MERGE","MKACTIVITY","MKCOL","MOVE","NOTIFY","OPTIONS","PATCH","POST","PROPFIND","PROPPATCH","PURGE","PUT","REPORT","SEARCH","SUBSCRIBE","TRACE","UNLOCK","UNSUBSCRIBE"],gu={100:"Continue",101:"Switching Protocols",102:"Processing",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",300:"Multiple Choices",301:"Moved Permanently",302:"Moved Temporarily",303:"See Other",304:"Not Modified",305:"Use Proxy",307:"Temporary Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Time-out",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Request Entity Too Large",414:"Request-URI Too Large",415:"Unsupported Media Type",416:"Requested Range Not Satisfiable",417:"Expectation Failed",418:"I'm a teapot",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",425:"Unordered Collection",426:"Upgrade Required",428:"Precondition Required",429:"Too Many Requests",431:"Request Header Fields Too Large",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Time-out",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",509:"Bandwidth Limit Exceeded",510:"Not Extended",511:"Network Authentication Required"},yu={request:fu,get:lu,Agent:du,METHODS:pu,STATUS_CODES:gu},vu=Object.freeze({request:fu,get:lu,Agent:du,METHODS:pu,STATUS_CODES:gu,default:yu}),mu=yo&&go||yo,wu=vu&&yu||vu,bu=r(function(n,r){n.exports=function(n){function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){return t<e}function s(t,e){return t<=e}function o(t,e){return t>e}function a(t,e){return t>=e}function h(){return!0}function u(t,e){return t.substring(0,e.length)===e}var c=function t(e,n,i){r(this,t),this.key=e,this.value=n,this.targetHash=i},f=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments[2];r(this,t),this.hash=i,this.leftChildHash=e,this.keys=n;var s=new c("",null,e);this.keys.length&&!this.keys[0].key.length||this.keys.unshift(s)}return t.prototype.get=function(e,n){for(var r=this.keys[0],i=this.keys,s=Array.isArray(i),o=0,i=s?i:i[Symbol.iterator]();;){var a;if(s){if(o>=i.length)break;a=i[o++]}else{if((o=i.next()).done)break;a=o.value}var h=a;if(e<h.key)break;r=h}return r.targetHash?n.get(r.targetHash).then(function(i){return t.deserialize(i,r.targetHash).get(e,n)}):r.key===e?Promise.resolve(r.value):Promise.resolve(null)},t.prototype.searchText=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,n=arguments[2],r=arguments[3],i=arguments[4],s=n||t,o=void 0,a=!n,h=!0;return r&&(s=t,o=n||void 0,a=!0,h=!n),this.searchRange(s,o,t,e,a,h,r,i)},t.prototype.searchRange=function(e,n,r,c){var f=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],l=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],d=arguments[6],p=arguments[7],g=[],y=this,v=void 0,m=void 0;return v=e?f?a:o:h,m=n?l?s:i:h,function i(s){if(s<0||s>=y.keys.length)return Promise.resolve(g);if(c&&g.length>=c)return g=g.slice(0,c+1),Promise.resolve(g);var o=d?s-1:s+1,a=y.keys[s];if(o>=0&&o<y.keys.length){if(!d&&e>=y.keys[o].key)return i(o);if(d&&n<y.keys[o].key)return i(o)}if(d&&s+1<y.keys.length&&!v(y.keys[s+1].key,e))return Promise.resolve(g);if(!d&&!m(a.key,n))return Promise.resolve(g);if(a.targetHash)return p.get(a.targetHash).then(function(i){var s=c?c-g.length:void 0;return t.deserialize(i,a.targetHash).searchRange(e,n,r,s,f,l,d,p)}).then(function(t){if(t){if(g.length&&!t.length)return Promise.resolve(g);if(r&&!t.length)return Promise.resolve(g);Array.prototype.push.apply(g,t)}return i(o)});if(a.key.length&&a.value){if(r&&g.length&&!u(a.key,r))return Promise.resolve(g);v(a.key,e)&&m(a.key,n)&&(r&&!u(a.key,r)||g.push({key:a.key,value:a.value}))}return i(o)}(d?this.keys.length-1:0)},t.prototype._getLeafInsertIndex=function(t){var e=this._getNextSmallestIndex(t),n=e.index,r=e.exists,i=n+1;return t>this.keys[this.keys.length-1].key&&(i=this.keys.length),{leafInsertIndex:i,exists:r}},t.prototype._getNextSmallestIndex=function(t){for(var e=0,n=void 0,r=1;r<this.keys.length;r++){if(t===this.keys[r].key){n=!0;break}if(t<this.keys[r].key)break;e=r}return{index:e,exists:n}},t.prototype._splitNode=function(e){var n=Math.floor(this.keys.length/2),r=this.keys[n],i=new t(null,this.keys.slice(0,n)),s=e.put(i.serialize()),o=this.keys.slice(n,this.keys.length);this.keys[0].targetHash&&o.shift();var a=new t(this.keys[n].targetHash,o),h=e.put(a.serialize()),u=e.remove(this.hash);return Promise.all([s,h,u]).then(function(e){var n=e[0],i=e[1],s=new c(r.key,null,i);return new t(n,[s])})},t.prototype._saveToLeafNode=function(e,n,r,i){var s=this,o=new c(e,n,null),a=this._getLeafInsertIndex(e),h=a.leafInsertIndex,u=a.exists;return u?(this.keys[h]=o,r.remove(this.hash).then(function(){return r.put(s.serialize())}).then(function(e){return new t(s.leftChildHash,s.keys,e)})):(this.keys.splice(h,0,o),this.keys.length<i?r.remove(this.hash).then(function(){return r.put(s.serialize())}).then(function(e){return new t(s.leftChildHash,s.keys,e)}):this._splitNode(r))},t.prototype._saveToBranchNode=function(e,n,r,i){var s=this,o=this._getNextSmallestIndex(e),a=o.index,h=this.keys[a];return r.get(h.targetHash).then(function(s){return t.deserialize(s,h.targetHash).put(e,n,r,i)}).then(function(e){return e.hash?(s.keys[a]=new c(s.keys[a].key,null,e.hash),r.remove(s.hash),r.put(s.serialize()).then(function(e){return new t(s.leftChildHash,s.keys,e)})):(s.keys[a]=new c(h.key,null,e.keys[0].targetHash),s.keys.splice(a+1,0,e.keys[e.keys.length-1]),s.keys.length<i?(r.remove(s.hash),r.put(s.serialize()).then(function(e){return new t(s.leftChildHash,s.keys,e)})):s._splitNode(r))})},t.prototype.put=function(t,e,n,r){return this.keys[0].targetHash?this._saveToBranchNode(t,e,n,r):this._saveToLeafNode(t,e,n,r)},t.prototype.delete=function(e,n){var r=this,i=this.keys[0],s=void 0;for(s=0;s<this.keys.length;s++){if(e<this.keys[s].key){s=Math.max(s-1,0);break}i=this.keys[s]}var o=Promise.resolve();return i.targetHash?o=o.then(function(){return n.get(i.targetHash).then(function(r){return t.deserialize(r,i.targetHash).delete(e,n)}).then(function(t){var e=i.targetHash;return i.targetHash=t.hash,n.remove(e)})}):i.key===e&&this.keys.splice(s,1),o.then(function(){return n.put(r.serialize())}).then(function(e){return new t(r.leftChildHash,r.keys,e)})},t.prototype.size=function(e){return this.keys.reduce(function(n,r){return n.then(function(n){return r.targetHash?e.get(r.targetHash).then(function(n){return t.deserialize(n).size(e)}).then(function(t){return t+n}):n})},Promise.resolve(this.keys.length))},t.prototype.smallestKey=function(){return this.keys.length?this.keys[0]:null},t.prototype.smallestNonZeroKey=function(){return this.keys.length>1?this.keys[1]:null},t.prototype.rebalance=function(){},t.prototype.print=function(e){for(var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r="node: "+this.hash+"\n",i="",s=0;s<=n;s++)i+="- ";return this.keys.forEach(function(t){r+=i,r+="key: "+t.key,t.targetHash&&(r+=" link: "+t.targetHash),t.value&&(r+="\n"+i+"   value: "+JSON.stringify(t.value)),r+="\n"}),this.keys.forEach(function(s){s.targetHash&&e.get(s.targetHash).then(function(o){var a=t.deserialize(o,s.targetHash);r+="\n",r+=i,r+=a.print(e,n+1)})}),r},t.prototype.serialize=function(){return JSON.stringify({leftChildHash:this.leftChildHash,keys:this.keys})},t.deserialize=function(e,n){return new t((e=JSON.parse(e)).leftChildHash,e.keys,n)},t.fromSortedList=function(e,n,r){if(e.length>n)return function i(s){if(e.length){var o=e.splice(0,n);return r.put(new t(o[0].targetHash,o).serialize()).then(function(t){return s.push({key:o[1].key,targetHash:t,value:null}),i(s)})}return s.length&&s[0].targetHash&&(s[0].key=""),t.fromSortedList(s,n,r)}([]);var i=e.length?e[0].targetHash:null,s=new t(i,e);return r.put(s.serialize()).then(function(t){return s.hash=t,s})},t}(),l=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new f;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.rootNode=r,this.storage=e,this.maxChildren=Math.max(n,2)}return t.prototype.get=function(t){return this.rootNode.get(t,this.storage)},t.prototype.searchText=function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return this.rootNode.searchText(t,e,n,r,this.storage)},t.prototype.searchRange=function(t,e,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],s=arguments.length>5&&void 0!==arguments[5]&&arguments[5];return this.rootNode.searchRange(t,e,!1,n,r,i,s,this.storage)},t.prototype.put=function(t,e){var n=this;return this.rootNode.put(t,e,this.storage,this.maxChildren).then(function(t){return n.rootNode=t,n.rootNode.hash})},t.prototype.delete=function(t){var e=this;return this.rootNode.delete(t,this.storage,this.maxChildren).then(function(t){return e.rootNode=t,e.rootNode.hash})},t.prototype.print=function(){return this.rootNode.print(this.storage)},t.prototype.size=function(){return this.rootNode.size(this.storage)},t.getByHash=function(e,n,r){return n.get(e).then(function(e){var i=f.deserialize(e);return new t(n,r,i)})},t.fromSortedList=function(e,n,r){return f.fromSortedList(e,n,r).then(function(e){return new t(r,n,e)})},t}(),d=void 0!==t?t:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},p=[],g=[],y="undefined"!=typeof Uint8Array?Uint8Array:Array,v=!1;function m(){v=!0;for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",e=0,n=t.length;e<n;++e)p[e]=t[e],g[t.charCodeAt(e)]=e;g["-".charCodeAt(0)]=62,g["_".charCodeAt(0)]=63}function w(t,e,n){for(var r,i,s=[],o=e;o<n;o+=3)r=(t[o]<<16)+(t[o+1]<<8)+t[o+2],s.push(p[(i=r)>>18&63]+p[i>>12&63]+p[i>>6&63]+p[63&i]);return s.join("")}function b(t){var e;v||m();for(var n=t.length,r=n%3,i="",s=[],o=0,a=n-r;o<a;o+=16383)s.push(w(t,o,o+16383>a?a:o+16383));return 1===r?(e=t[n-1],i+=p[e>>2],i+=p[e<<4&63],i+="=="):2===r&&(e=(t[n-2]<<8)+t[n-1],i+=p[e>>10],i+=p[e>>4&63],i+=p[e<<2&63],i+="="),s.push(i),s.join("")}function S(t,e,n,r,i){var s,o,a=8*i-r-1,h=(1<<a)-1,u=h>>1,c=-7,f=n?i-1:0,l=n?-1:1,d=t[e+f];for(f+=l,s=d&(1<<-c)-1,d>>=-c,c+=a;c>0;s=256*s+t[e+f],f+=l,c-=8);for(o=s&(1<<-c)-1,s>>=-c,c+=r;c>0;o=256*o+t[e+f],f+=l,c-=8);if(0===s)s=1-u;else{if(s===h)return o?NaN:1/0*(d?-1:1);o+=Math.pow(2,r),s-=u}return(d?-1:1)*o*Math.pow(2,s-r)}function x(t,e,n,r,i,s){var o,a,h,u=8*s-i-1,c=(1<<u)-1,f=c>>1,l=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,d=r?0:s-1,p=r?1:-1,g=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,o=c):(o=Math.floor(Math.log(e)/Math.LN2),e*(h=Math.pow(2,-o))<1&&(o--,h*=2),(e+=o+f>=1?l/h:l*Math.pow(2,1-f))*h>=2&&(o++,h/=2),o+f>=c?(a=0,o=c):o+f>=1?(a=(e*h-1)*Math.pow(2,i),o+=f):(a=e*Math.pow(2,f-1)*Math.pow(2,i),o=0));i>=8;t[n+d]=255&a,d+=p,a/=256,i-=8);for(o=o<<i|a,u+=i;u>0;t[n+d]=255&o,d+=p,o/=256,u-=8);t[n+d-p]|=128*g}var E={}.toString,F=Array.isArray||function(t){return"[object Array]"==E.call(t)};function A(){return T.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function C(t,e){if(A()<e)throw new RangeError("Invalid typed array length");return T.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=T.prototype:(null===t&&(t=new T(e)),t.length=e),t}function T(t,e,n){if(!(T.TYPED_ARRAY_SUPPORT||this instanceof T))return new T(t,e,n);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return I(this,t)}return P(this,t,e,n)}function P(t,e,n,r){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?function(t,e,n,r){if(e.byteLength,n<0||e.byteLength<n)throw new RangeError("'offset' is out of bounds");if(e.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");return e=void 0===n&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,n):new Uint8Array(e,n,r),T.TYPED_ARRAY_SUPPORT?(t=e).__proto__=T.prototype:t=R(t,e),t}(t,e,n,r):"string"==typeof e?function(t,e,n){if("string"==typeof n&&""!==n||(n="utf8"),!T.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|_(e,n),i=(t=C(t,r)).write(e,n);return i!==r&&(t=t.slice(0,i)),t}(t,e,n):function(t,e){if(H(e)){var n=0|B(e.length);return 0===(t=C(t,n)).length?t:(e.copy(t,0,0,n),t)}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||(r=e.length)!=r?C(t,0):R(t,e);if("Buffer"===e.type&&F(e.data))return R(t,e.data)}var r;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e)}function D(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function I(t,e){if(D(e),t=C(t,e<0?0:0|B(e)),!T.TYPED_ARRAY_SUPPORT)for(var n=0;n<e;++n)t[n]=0;return t}function R(t,e){var n=e.length<0?0:0|B(e.length);t=C(t,n);for(var r=0;r<n;r+=1)t[r]=255&e[r];return t}function B(t){if(t>=A())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+A().toString(16)+" bytes");return 0|t}function H(t){return!(null==t||!t._isBuffer)}function _(t,e){if(H(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var n=t.length;if(0===n)return 0;for(var r=!1;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return st(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return ot(t).length;default:if(r)return st(t).length;e=(""+e).toLowerCase(),r=!0}}function k(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function N(t,e,n,r,i){if(0===t.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=i?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(i)return-1;n=t.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof e&&(e=T.from(e,r)),H(e))return 0===e.length?-1:O(t,e,n,r,i);if("number"==typeof e)return e&=255,T.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):O(t,[e],n,r,i);throw new TypeError("val must be string, number or Buffer")}function O(t,e,n,r,i){var s,o=1,a=t.length,h=e.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(t.length<2||e.length<2)return-1;o=2,a/=2,h/=2,n/=2}function u(t,e){return 1===o?t[e]:t.readUInt16BE(e*o)}if(i){var c=-1;for(s=n;s<a;s++)if(u(t,s)===u(e,-1===c?0:s-c)){if(-1===c&&(c=s),s-c+1===h)return c*o}else-1!==c&&(s-=s-c),c=-1}else for(n+h>a&&(n=a-h),s=n;s>=0;s--){for(var f=!0,l=0;l<h;l++)if(u(t,s+l)!==u(e,l)){f=!1;break}if(f)return s}return-1}function j(t,e,n,r){n=Number(n)||0;var i=t.length-n;r?(r=Number(r))>i&&(r=i):r=i;var s=e.length;if(s%2!=0)throw new TypeError("Invalid hex string");r>s/2&&(r=s/2);for(var o=0;o<r;++o){var a=parseInt(e.substr(2*o,2),16);if(isNaN(a))return o;t[n+o]=a}return o}function L(t,e,n,r){return at(st(e,t.length-n),t,n,r)}function M(t,e,n,r){return at(function(t){for(var e=[],n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}(e),t,n,r)}function V(t,e,n,r){return M(t,e,n,r)}function K(t,e,n,r){return at(ot(e),t,n,r)}function U(t,e,n,r){return at(function(t,e){for(var n,r,i,s=[],o=0;o<t.length&&!((e-=2)<0);++o)n=t.charCodeAt(o),r=n>>8,i=n%256,s.push(i),s.push(r);return s}(e,t.length-n),t,n,r)}function q(t,e,n){return 0===e&&n===t.length?b(t):b(t.slice(e,n))}function z(t,e,n){n=Math.min(t.length,n);for(var r=[],i=e;i<n;){var s,o,a,h,u=t[i],c=null,f=u>239?4:u>223?3:u>191?2:1;if(i+f<=n)switch(f){case 1:u<128&&(c=u);break;case 2:128==(192&(s=t[i+1]))&&(h=(31&u)<<6|63&s)>127&&(c=h);break;case 3:s=t[i+1],o=t[i+2],128==(192&s)&&128==(192&o)&&(h=(15&u)<<12|(63&s)<<6|63&o)>2047&&(h<55296||h>57343)&&(c=h);break;case 4:s=t[i+1],o=t[i+2],a=t[i+3],128==(192&s)&&128==(192&o)&&128==(192&a)&&(h=(15&u)<<18|(63&s)<<12|(63&o)<<6|63&a)>65535&&h<1114112&&(c=h)}null===c?(c=65533,f=1):c>65535&&(c-=65536,r.push(c>>>10&1023|55296),c=56320|1023&c),r.push(c),i+=f}return function(t){var e=t.length;if(e<=Y)return String.fromCharCode.apply(String,t);for(var n="",r=0;r<e;)n+=String.fromCharCode.apply(String,t.slice(r,r+=Y));return n}(r)}T.TYPED_ARRAY_SUPPORT=void 0===d.TYPED_ARRAY_SUPPORT||d.TYPED_ARRAY_SUPPORT,T.poolSize=8192,T._augment=function(t){return t.__proto__=T.prototype,t},T.from=function(t,e,n){return P(null,t,e,n)},T.TYPED_ARRAY_SUPPORT&&(T.prototype.__proto__=Uint8Array.prototype,T.__proto__=Uint8Array),T.alloc=function(t,e,n){return function(t,e,n,r){return D(e),e<=0?C(t,e):void 0!==n?"string"==typeof r?C(t,e).fill(n,r):C(t,e).fill(n):C(t,e)}(null,t,e,n)},T.allocUnsafe=function(t){return I(null,t)},T.allocUnsafeSlow=function(t){return I(null,t)},T.isBuffer=function(t){return null!=t&&(!!t._isBuffer||ht(t)||function(t){return"function"==typeof t.readFloatLE&&"function"==typeof t.slice&&ht(t.slice(0,0))}(t))},T.compare=function(t,e){if(!H(t)||!H(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var n=t.length,r=e.length,i=0,s=Math.min(n,r);i<s;++i)if(t[i]!==e[i]){n=t[i],r=e[i];break}return n<r?-1:r<n?1:0},T.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},T.concat=function(t,e){if(!F(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return T.alloc(0);var n;if(void 0===e)for(e=0,n=0;n<t.length;++n)e+=t[n].length;var r=T.allocUnsafe(e),i=0;for(n=0;n<t.length;++n){var s=t[n];if(!H(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(r,i),i+=s.length}return r},T.byteLength=_,T.prototype._isBuffer=!0,T.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)k(this,e,e+1);return this},T.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)k(this,e,e+3),k(this,e+1,e+2);return this},T.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)k(this,e,e+7),k(this,e+1,e+6),k(this,e+2,e+5),k(this,e+3,e+4);return this},T.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?z(this,0,t):function(t,e,n){var r=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return J(this,e,n);case"utf8":case"utf-8":return z(this,e,n);case"ascii":return W(this,e,n);case"latin1":case"binary":return G(this,e,n);case"base64":return q(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return X(this,e,n);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}}.apply(this,arguments)},T.prototype.equals=function(t){if(!H(t))throw new TypeError("Argument must be a Buffer");return this===t||0===T.compare(this,t)},T.prototype.inspect=function(){var t="";return this.length>0&&(t=this.toString("hex",0,50).match(/.{2}/g).join(" "),this.length>50&&(t+=" ... ")),"<Buffer "+t+">"},T.prototype.compare=function(t,e,n,r,i){if(!H(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),e<0||n>t.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&e>=n)return 0;if(r>=i)return-1;if(e>=n)return 1;if(e>>>=0,n>>>=0,r>>>=0,i>>>=0,this===t)return 0;for(var s=i-r,o=n-e,a=Math.min(s,o),h=this.slice(r,i),u=t.slice(e,n),c=0;c<a;++c)if(h[c]!==u[c]){s=h[c],o=u[c];break}return s<o?-1:o<s?1:0},T.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},T.prototype.indexOf=function(t,e,n){return N(this,t,e,n,!0)},T.prototype.lastIndexOf=function(t,e,n){return N(this,t,e,n,!1)},T.prototype.write=function(t,e,n,r){if(void 0===e)r="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)r=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-e;if((void 0===n||n>i)&&(n=i),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var s=!1;;)switch(r){case"hex":return j(this,t,e,n);case"utf8":case"utf-8":return L(this,t,e,n);case"ascii":return M(this,t,e,n);case"latin1":case"binary":return V(this,t,e,n);case"base64":return K(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return U(this,t,e,n);default:if(s)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),s=!0}},T.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var Y=4096;function W(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(127&t[i]);return r}function G(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(t[i]);return r}function J(t,e,n){var r,i=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>i)&&(n=i);for(var s="",o=e;o<n;++o)s+=(r=t[o])<16?"0"+r.toString(16):r.toString(16);return s}function X(t,e,n){for(var r=t.slice(e,n),i="",s=0;s<r.length;s+=2)i+=String.fromCharCode(r[s]+256*r[s+1]);return i}function $(t,e,n){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function Z(t,e,n,r,i,s){if(!H(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<s)throw new RangeError('"value" argument is out of bounds');if(n+r>t.length)throw new RangeError("Index out of range")}function Q(t,e,n,r){e<0&&(e=65535+e+1);for(var i=0,s=Math.min(t.length-n,2);i<s;++i)t[n+i]=(e&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function tt(t,e,n,r){e<0&&(e=4294967295+e+1);for(var i=0,s=Math.min(t.length-n,4);i<s;++i)t[n+i]=e>>>8*(r?i:3-i)&255}function et(t,e,n,r,i,s){if(n+r>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function nt(t,e,n,r,i){return i||et(t,0,n,4),x(t,e,n,r,23,4),n+4}function rt(t,e,n,r,i){return i||et(t,0,n,8),x(t,e,n,r,52,8),n+8}T.prototype.slice=function(t,e){var n,r=this.length;if((t=~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),(e=void 0===e?r:~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),e<t&&(e=t),T.TYPED_ARRAY_SUPPORT)(n=this.subarray(t,e)).__proto__=T.prototype;else{var i=e-t;n=new T(i,void 0);for(var s=0;s<i;++s)n[s]=this[s+t]}return n},T.prototype.readUIntLE=function(t,e,n){t|=0,e|=0,n||$(t,e,this.length);for(var r=this[t],i=1,s=0;++s<e&&(i*=256);)r+=this[t+s]*i;return r},T.prototype.readUIntBE=function(t,e,n){t|=0,e|=0,n||$(t,e,this.length);for(var r=this[t+--e],i=1;e>0&&(i*=256);)r+=this[t+--e]*i;return r},T.prototype.readUInt8=function(t,e){return e||$(t,1,this.length),this[t]},T.prototype.readUInt16LE=function(t,e){return e||$(t,2,this.length),this[t]|this[t+1]<<8},T.prototype.readUInt16BE=function(t,e){return e||$(t,2,this.length),this[t]<<8|this[t+1]},T.prototype.readUInt32LE=function(t,e){return e||$(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},T.prototype.readUInt32BE=function(t,e){return e||$(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},T.prototype.readIntLE=function(t,e,n){t|=0,e|=0,n||$(t,e,this.length);for(var r=this[t],i=1,s=0;++s<e&&(i*=256);)r+=this[t+s]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*e)),r},T.prototype.readIntBE=function(t,e,n){t|=0,e|=0,n||$(t,e,this.length);for(var r=e,i=1,s=this[t+--r];r>0&&(i*=256);)s+=this[t+--r]*i;return s>=(i*=128)&&(s-=Math.pow(2,8*e)),s},T.prototype.readInt8=function(t,e){return e||$(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},T.prototype.readInt16LE=function(t,e){e||$(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},T.prototype.readInt16BE=function(t,e){e||$(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},T.prototype.readInt32LE=function(t,e){return e||$(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},T.prototype.readInt32BE=function(t,e){return e||$(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},T.prototype.readFloatLE=function(t,e){return e||$(t,4,this.length),S(this,t,!0,23,4)},T.prototype.readFloatBE=function(t,e){return e||$(t,4,this.length),S(this,t,!1,23,4)},T.prototype.readDoubleLE=function(t,e){return e||$(t,8,this.length),S(this,t,!0,52,8)},T.prototype.readDoubleBE=function(t,e){return e||$(t,8,this.length),S(this,t,!1,52,8)},T.prototype.writeUIntLE=function(t,e,n,r){if(t=+t,e|=0,n|=0,!r){var i=Math.pow(2,8*n)-1;Z(this,t,e,n,i,0)}var s=1,o=0;for(this[e]=255&t;++o<n&&(s*=256);)this[e+o]=t/s&255;return e+n},T.prototype.writeUIntBE=function(t,e,n,r){if(t=+t,e|=0,n|=0,!r){var i=Math.pow(2,8*n)-1;Z(this,t,e,n,i,0)}var s=n-1,o=1;for(this[e+s]=255&t;--s>=0&&(o*=256);)this[e+s]=t/o&255;return e+n},T.prototype.writeUInt8=function(t,e,n){return t=+t,e|=0,n||Z(this,t,e,1,255,0),T.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},T.prototype.writeUInt16LE=function(t,e,n){return t=+t,e|=0,n||Z(this,t,e,2,65535,0),T.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):Q(this,t,e,!0),e+2},T.prototype.writeUInt16BE=function(t,e,n){return t=+t,e|=0,n||Z(this,t,e,2,65535,0),T.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):Q(this,t,e,!1),e+2},T.prototype.writeUInt32LE=function(t,e,n){return t=+t,e|=0,n||Z(this,t,e,4,4294967295,0),T.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):tt(this,t,e,!0),e+4},T.prototype.writeUInt32BE=function(t,e,n){return t=+t,e|=0,n||Z(this,t,e,4,4294967295,0),T.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):tt(this,t,e,!1),e+4},T.prototype.writeIntLE=function(t,e,n,r){if(t=+t,e|=0,!r){var i=Math.pow(2,8*n-1);Z(this,t,e,n,i-1,-i)}var s=0,o=1,a=0;for(this[e]=255&t;++s<n&&(o*=256);)t<0&&0===a&&0!==this[e+s-1]&&(a=1),this[e+s]=(t/o>>0)-a&255;return e+n},T.prototype.writeIntBE=function(t,e,n,r){if(t=+t,e|=0,!r){var i=Math.pow(2,8*n-1);Z(this,t,e,n,i-1,-i)}var s=n-1,o=1,a=0;for(this[e+s]=255&t;--s>=0&&(o*=256);)t<0&&0===a&&0!==this[e+s+1]&&(a=1),this[e+s]=(t/o>>0)-a&255;return e+n},T.prototype.writeInt8=function(t,e,n){return t=+t,e|=0,n||Z(this,t,e,1,127,-128),T.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},T.prototype.writeInt16LE=function(t,e,n){return t=+t,e|=0,n||Z(this,t,e,2,32767,-32768),T.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):Q(this,t,e,!0),e+2},T.prototype.writeInt16BE=function(t,e,n){return t=+t,e|=0,n||Z(this,t,e,2,32767,-32768),T.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):Q(this,t,e,!1),e+2},T.prototype.writeInt32LE=function(t,e,n){return t=+t,e|=0,n||Z(this,t,e,4,2147483647,-2147483648),T.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):tt(this,t,e,!0),e+4},T.prototype.writeInt32BE=function(t,e,n){return t=+t,e|=0,n||Z(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),T.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):tt(this,t,e,!1),e+4},T.prototype.writeFloatLE=function(t,e,n){return nt(this,t,e,!0,n)},T.prototype.writeFloatBE=function(t,e,n){return nt(this,t,e,!1,n)},T.prototype.writeDoubleLE=function(t,e,n){return rt(this,t,e,!0,n)},T.prototype.writeDoubleBE=function(t,e,n){return rt(this,t,e,!1,n)},T.prototype.copy=function(t,e,n,r){if(n||(n=0),r||0===r||(r=this.length),e>=t.length&&(e=t.length),e||(e=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-e<r-n&&(r=t.length-e+n);var i,s=r-n;if(this===t&&n<e&&e<r)for(i=s-1;i>=0;--i)t[i+e]=this[i+n];else if(s<1e3||!T.TYPED_ARRAY_SUPPORT)for(i=0;i<s;++i)t[i+e]=this[i+n];else Uint8Array.prototype.set.call(t,this.subarray(n,n+s),e);return s},T.prototype.fill=function(t,e,n,r){if("string"==typeof t){if("string"==typeof e?(r=e,e=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===t.length){var i=t.charCodeAt(0);i<256&&(t=i)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!T.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;var s;if(e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"==typeof t)for(s=e;s<n;++s)this[s]=t;else{var o=H(t)?t:st(new T(t,r).toString()),a=o.length;for(s=0;s<n-e;++s)this[s+e]=o[s%a]}return this};var it=/[^+\/0-9A-Za-z-_]/g;function st(t,e){var n;e=e||1/0;for(var r=t.length,i=null,s=[],o=0;o<r;++o){if((n=t.charCodeAt(o))>55295&&n<57344){if(!i){if(n>56319){(e-=3)>-1&&s.push(239,191,189);continue}if(o+1===r){(e-=3)>-1&&s.push(239,191,189);continue}i=n;continue}if(n<56320){(e-=3)>-1&&s.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(e-=3)>-1&&s.push(239,191,189);if(i=null,n<128){if((e-=1)<0)break;s.push(n)}else if(n<2048){if((e-=2)<0)break;s.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;s.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;s.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return s}function ot(t){return function(t){v||m();var e,n,r,i,s,o,a=t.length;if(a%4>0)throw new Error("Invalid string. Length must be a multiple of 4");s="="===t[a-2]?2:"="===t[a-1]?1:0,o=new y(3*a/4-s),r=s>0?a-4:a;var h=0;for(e=0,n=0;e<r;e+=4,n+=3)i=g[t.charCodeAt(e)]<<18|g[t.charCodeAt(e+1)]<<12|g[t.charCodeAt(e+2)]<<6|g[t.charCodeAt(e+3)],o[h++]=i>>16&255,o[h++]=i>>8&255,o[h++]=255&i;return 2===s?(i=g[t.charCodeAt(e)]<<2|g[t.charCodeAt(e+1)]>>4,o[h++]=255&i):1===s&&(i=g[t.charCodeAt(e)]<<10|g[t.charCodeAt(e+1)]<<4|g[t.charCodeAt(e+2)]>>2,o[h++]=i>>8&255,o[h++]=255&i),o}(function(t){if((t=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}(t).replace(it,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function at(t,e,n,r){for(var i=0;i<r&&!(i+n>=e.length||i>=t.length);++i)e[i+n]=t[i];return i}function ht(t){return!!t.constructor&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)}var ut=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.ipfs=e}return t.prototype.put=function(t){return this.ipfs.files.add(new T(t,"utf8")).then(function(t){return t[0].hash})},t.prototype.get=function(t){return this.ipfs.files.cat(t).then(function(t){return t.toString("utf8")})},t.prototype.remove=function(t){return Promise.resolve(t)},t.prototype.clear=function(){return Promise.resolve()},t}(),ct=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.storage={}}return t.prototype.put=function(t){var e=this;return new Promise(function(r){var i=n.createHash("sha256");i.update(t);var s=i.digest("base64");e.storage[s]=t,r(s)})},t.prototype.get=function(t){var e=this;return new Promise(function(n){n(e.storage[t])})},t.prototype.remove=function(t){var e=this;return new Promise(function(n){delete e.storage[t],n()})},t.prototype.clear=function(){var t=this;return new Promise(function(e){t.storage={},e()})},t}(),ft=!1;try{ft="[object process]"===Object.prototype.toString.call(d.process)}catch(t){}function lt(t){return ft&&e.resolve("http")&&e.resolve("https")?function(t){return new Promise(function(e,n){var r=(t.startsWith("https"),wu),i=r.get(t,function(t){(t.statusCode<200||t.statusCode>299)&&n(new Error("Failed to load page, status code: "+t.statusCode));var r=[];t.on("data",function(t){return r.push(t)}),t.on("end",function(){return e(r.join(""))})});i.on("error",function(t){return n(t)})})}(t):function(t){return new Promise(function(e,n){var r=new XMLHttpRequest;r.onreadystatechange=function(){4===r.readyState&&(r.status>=200&&r.status<300?e(r.responseText):n(r.responseText))},r.open("GET",t,!0),r.send(null)})}(t)}var dt=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.apiRoot=e}return t.prototype.get=function(t){return t.match(/^\/ip(fs|ns)\//)||(t="/ipfs/"+t),lt(this.apiRoot+t)},t.prototype.remove=function(){return Promise.resolve()},t.prototype.put=function(){return Promise.resolve()},t}();return{MerkleBTree:l,TreeNode:f,RAMStorage:ct,IPFSStorage:ut,IPFSGatewayStorage:dt}}(mu)}),Su=["https://identi.fi","https://ipfs.io","https://ipfs.infura.io","https://www.eternum.io"],xu=200,Eu=function(){function t(e,n){var r,i=this;if(Ln(this,t),e){this.ipfs=e,this.storage=new bu.IPFSStorage(e),this.identitiesBySearchKey=new bu.MerkleBTree(this.storage,xu),this.identitiesByTrustDistance=new bu.MerkleBTree(this.storage,xu),this.messagesByTimestamp=new bu.MerkleBTree(this.storage,xu),this.messagesByDistance=new bu.MerkleBTree(this.storage,xu),this.viewpoint=n?new zs(n):{name:"keyID",val:Is.getDefaultKey().keyID,conf:1,ref:0};var s=new Ys({attrs:[this.viewpoint],trustDistance:0});this.ready=new Ts((r=Os(Ns.mark(function t(e,n){return Ns.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,i._setSentRcvdIndexes(s);case 3:return t.next=5,i._addIdentityToIndexes(s);case 5:e(),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),n(t.t0);case 11:case"end":return t.stop()}},t,i,[[0,8]])})),function(t,e){return r.apply(this,arguments)}))}}return t.create=function(){var e=Os(Ns.mark(function e(n,r){var i;return Ns.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=new t(n,r),e.next=3,i.ready;case 3:return e.abrupt("return",i);case 4:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}(),t.getMsgIndexKey=function(t){var e=parseInt(t.distance);return(e=("00"+(e=Vs(e)?99:e)).substring(e.toString().length))+":"+Math.floor(Date.parse(t.timestamp||t.signedData.timestamp)/1e3)+":"+(t.ipfs_hash||t.hash).substr(0,9)},t.getIdentityIndexKeys=function(t,e){for(var n=[],r=t.data.attrs,i=0;i<r.length;i+=1){var s=t.data.hasOwnProperty("trustDistance")?t.data.trustDistance:parseInt(r[i].dist);s=("00"+(s=Vs(s)?99:s)).substring(s.toString().length);var o=r[i].val||r[i][1],a=r[i].name||r[i][0],h=encodeURIComponent(o),u=encodeURIComponent(o.toLowerCase()),c=encodeURIComponent(a),f=s+":"+h+":"+c,l=s+":"+u+":"+c;if(zs.isUniqueType(a)||(f=f+":"+e.substr(0,9),l=l+":"+e.substr(0,9)),n.push(f),f!==l&&n.push(l),o.indexOf(" ")>-1)for(var d=o.toLowerCase().split(" "),p=0;p<d.length;p+=1){var g=s+":"+encodeURIComponent(d[p])+":"+c;zs.isUniqueType(a)||(g=g+":"+e.substr(0,9)),n.push(g)}if(f.match(/^http(s)?:\/\/.+\/[a-zA-Z0-9_]+$/)){var y=f.split("/");n.push(y[y.length-1])}}return n},t.load=function(){var e=Os(Ns.mark(function e(n,r){var i;return Ns.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=new t,e.next=3,i.init(n,r);case 3:return e.abrupt("return",i);case 4:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}(),t.prototype.init=function(){var t=Os(Ns.mark(function t(e){var n,r,i,s,o,a,h,u,c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Su,f=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e4;return Ns.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=!1,void 0===e&&(n=!0,e="/ipns/Qmbb1DRwd75rZk5TotTXJYzDSJL6BaNT1DAQ6VbKcKLhbs"),"string"!=typeof c){t.next=6;break}this.storage=new bu.IPFSGatewayStorage(c),t.next=53;break;case 6:if(!Array.isArray(c)){t.next=47;break}r=void 0,i=0;case 9:if(!(i<c.length)){t.next=40;break}return s=void 0,o=""+c[i]+e,t.prev=12,t.next=15,Is.timeoutPromise(rt(o,{timeout:f}).catch(function(){}),f);case 15:(s=t.sent)||console.log("fetching "+o+" timed out"),t.next=22;break;case 19:t.prev=19,t.t0=t.catch(12),console.log("fetching "+o+" failed:",t.t0);case 22:if(s&&s.ok&&200===s.status||!n){t.next=34;break}return o=c[i]+"/ipfs/QmPxLM631zJQ12tUDWs55LkGqqroFZKHeLjAZ2XwL9Miu3",t.prev=24,t.next=27,Is.timeoutPromise(rt(o,{timeout:f}).catch(function(){}),f);case 27:(s=t.sent)?e="/ipfs/QmPxLM631zJQ12tUDWs55LkGqqroFZKHeLjAZ2XwL9Miu3":console.log("fetching "+o+" timed out"),t.next=34;break;case 31:t.prev=31,t.t1=t.catch(24),console.log("fetching "+o+" failed:",t.t1);case 34:if(!s||!s.ok||200!==s.status){t.next=37;break}return r=c[i],t.abrupt("break",40);case 37:i++,t.next=9;break;case 40:if(!r){t.next=44;break}this.storage=new bu.IPFSGatewayStorage(r),t.next=45;break;case 44:throw"Could not load index via given ipfs gateways";case 45:t.next=53;break;case 47:if("object"!==(void 0===c?"undefined":fi(c))){t.next=52;break}this.storage=new bu.IPFSStorage(c),this.ipfs=c,t.next=53;break;case 52:throw"ipfs param must be a gateway url, array of urls or a js-ipfs object";case 53:return t.next=55,this.storage.get(e);case 55:a=t.sent,h=void 0;try{h=JSON.parse(a)}catch(t){console.log("Old format index root")}if(!h){t.next=74;break}return t.next=61,bu.MerkleBTree.getByHash(h.identitiesByTrustDistance,this.storage,xu);case 61:return this.identitiesByTrustDistance=t.sent,t.next=64,bu.MerkleBTree.getByHash(h.identitiesBySearchKey,this.storage,xu);case 64:return this.identitiesBySearchKey=t.sent,t.next=67,bu.MerkleBTree.getByHash(h.messagesByTimestamp,this.storage,xu);case 67:return this.messagesByTimestamp=t.sent,t.next=70,bu.MerkleBTree.getByHash(h.messagesByDistance,this.storage,xu);case 70:this.messagesByDistance=t.sent,this.viewpoint=h.viewpoint,t.next=86;break;case 74:return t.next=76,bu.MerkleBTree.getByHash(e+"/identities_by_distance",this.storage,xu);case 76:return this.identitiesByTrustDistance=t.sent,t.next=79,bu.MerkleBTree.getByHash(e+"/identities_by_searchkey",this.storage,xu);case 79:return this.identitiesBySearchKey=t.sent,t.next=82,bu.MerkleBTree.getByHash(e+"/messages_by_timestamp",this.storage,xu);case 82:return this.messagesByTimestamp=t.sent,t.next=85,bu.MerkleBTree.getByHash(e+"/messages_by_distance",this.storage,xu);case 85:this.messagesByDistance=t.sent;case 86:if(this.viewpoint){t.next=91;break}return t.next=89,this.getViewpoint();case 89:u=t.sent,this.viewpoint=u.mostVerifiedAttributes.keyID.attribute.val;case 91:return t.abrupt("return",!0);case 92:case"end":return t.stop()}},t,this,[[12,19],[24,31]])}));return function(e){return t.apply(this,arguments)}}(),t.prototype.save=function(){var t=Os(Ns.mark(function t(){var e,n,r,i,s;return Ns.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.ipfs.files.add([{path:"messagesByDistance",content:new mt(this.messagesByDistance.rootNode.serialize(),"utf8")},{path:"messagesByTimestamp",content:new mt(this.messagesByTimestamp.rootNode.serialize(),"utf8")},{path:"identitiesBySearchKey",content:new mt(this.identitiesBySearchKey.rootNode.serialize(),"utf8")},{path:"identitiesByTrustDistance",content:new mt(this.identitiesByTrustDistance.rootNode.serialize(),"utf8")}]);case 3:for(e=t.sent,n={viewpoint:this.viewpoint},r=0;r<e.length;r+=1)n[e[r].path]=e[r].hash;return t.next=8,this.ipfs.files.add(new mt(jn(n),"utf8"));case 8:if(e=t.sent,i=e[0].hash,!this.ipfs.name){t.next=16;break}return console.log("publishing index",i),t.next=14,this.ipfs.name.publish(i,{});case 14:s=t.sent,console.log("published index",s);case 16:return t.abrupt("return",i);case 19:t.prev=19,t.t0=t.catch(0),console.log("error publishing index",t.t0);case 22:case"end":return t.stop()}},t,this,[[0,19]])}));return function(){return t.apply(this,arguments)}}(),t.prototype._setSentRcvdIndexes=function(){var t=Os(Ns.mark(function t(e){return Ns.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.sentIndex){t.next=8;break}if(!e.data.sent){t.next=7;break}return t.next=4,bu.MerkleBTree.getByHash(e.data.sent,this.storage,xu);case 4:e.sentIndex=t.sent,t.next=8;break;case 7:e.sentIndex=new bu.MerkleBTree(this.storage,xu);case 8:if(e.receivedIndex){t.next=16;break}if(!e.data.received){t.next=15;break}return t.next=12,bu.MerkleBTree.getByHash(e.data.received,this.storage,xu);case 12:e.receivedIndex=t.sent,t.next=16;break;case 15:e.receivedIndex=new bu.MerkleBTree(this.storage,xu);case 16:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),t.prototype.getViewpoint=function(){var t=Os(Ns.mark(function t(){var e,n,r;return Ns.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.identitiesByTrustDistance.searchText("00",1);case 2:if(!(e=t.sent).length){t.next=11;break}return t.next=6,this.storage.get(e[0].value);case 6:return n=t.sent,r=new Ys(JSON.parse(n)),t.next=10,this._setSentRcvdIndexes(r);case 10:return t.abrupt("return",r);case 11:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),t.prototype.get=function(){var t=Os(Ns.mark(function t(e,n){var r,i,s;return Ns.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0!==e){t.next=2;break}throw"Value is undefined";case 2:return void 0===n&&(n=zs.guessTypeOf(e)),t.next=5,this.identitiesBySearchKey.get(encodeURIComponent(e)+":"+encodeURIComponent(n));case 5:if(!(r=t.sent)){t.next=15;break}return t.next=9,this.storage.get(r);case 9:return i=t.sent,(s=new Ys(JSON.parse(i))).ipfsHash=r,t.next=14,this._setSentRcvdIndexes(s);case 14:return t.abrupt("return",s);case 15:case"end":return t.stop()}},t,this)}));return function(e,n){return t.apply(this,arguments)}}(),t.prototype._getMsgs=function(){var t=Os(Ns.mark(function t(e,n,r){var i,s;return Ns.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.searchText("",n,r,!0);case 2:return i=t.sent,s=[],i.forEach(function(t){var e=Js.fromJws(t.value.jws);e.cursor=t.key,e.authorPos=t.value.author_pos,e.authorNeg=t.value.author_neg,e.recipientPos=t.value.recipient_pos,e.recipientNeg=t.value.recipient_neg,e.authorTrustDistance=t.value.distance,e.authorName=t.value.author_name,e.recipientName=t.value.recipient_name,s.push(e)}),t.abrupt("return",s);case 6:case"end":return t.stop()}},t,this)}));return function(e,n,r){return t.apply(this,arguments)}}(),t.prototype._saveIdentityToIpfs=function(){var t=Os(Ns.mark(function t(e){var n,r,i;return Ns.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=new this.ipfs.types.Buffer(jn(e.data)),t.next=3,this.ipfs.files.add(n);case 3:return r=t.sent,i=r.length?r[0].hash:"",e.ipfsHash=i,t.abrupt("return",i);case 7:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),t.prototype._removeIdentityFromIndexes=function(){var e=Os(Ns.mark(function e(n){var r,i,s,o;return Ns.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.ipfsHash){e.next=5;break}return e.next=4,this._saveIdentityToIpfs(n);case 4:r=e.sent;case 5:i=t.getIdentityIndexKeys(n,r.substr(2)),s=0;case 7:if(!(s<i.length)){e.next=17;break}return o=i[s],console.log("deleting key "+o),e.next=12,this.identitiesByTrustDistance.delete(o);case 12:return e.next=14,this.identitiesBySearchKey.delete(o.substr(o.indexOf(":")+1));case 14:s++,e.next=7;break;case 17:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),t.prototype._addIdentityToIndexes=function(){var e=Os(Ns.mark(function e(n){var r,i,s,o,a,h;return Ns.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.sentIndex||!n.receivedIndex){e.next=14;break}if(!n.sentIndex.rootNode.hash||!n.receivedIndex.rootNode.hash){e.next=6;break}n.data.sent=n.sentIndex.rootNode.hash,n.data.received=n.receivedIndex.rootNode.hash,e.next=14;break;case 6:return e.next=8,this.ipfs.files.add(new mt(n.sentIndex.rootNode.serialize(),"utf8"));case 8:return r=e.sent,n.data.sent=r[0].hash,e.next=12,this.ipfs.files.add(new mt(n.receivedIndex.rootNode.serialize(),"utf8"));case 12:i=e.sent,n.data.received=i[0].hash;case 14:return e.next=16,this._saveIdentityToIpfs(n);case 16:s=e.sent,o=t.getIdentityIndexKeys(n,s.substr(2)),a=0;case 19:if(!(a<o.length)){e.next=29;break}return h=o[a],console.log("adding key "+h),e.next=24,this.identitiesByTrustDistance.put(h,s);case 24:return e.next=26,this.identitiesBySearchKey.put(h.substr(h.indexOf(":")+1),s);case 26:a++,e.next=19;break;case 29:return e.abrupt("return",{hash:s});case 30:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),t.prototype.getSentMsgs=function(){var t=Os(Ns.mark(function t(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return Ns.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.sentIndex){t.next=4;break}return t.next=3,bu.MerkleBTree.getByHash(e.data.sent,this.storage,xu);case 3:e.sentIndex=t.sent;case 4:return t.abrupt("return",this._getMsgs(e.sentIndex,n,r));case 5:case"end":return t.stop()}},t,this)}));return function(e,n){return t.apply(this,arguments)}}(),t.prototype.getReceivedMsgs=function(){var t=Os(Ns.mark(function t(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return Ns.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.receivedIndex){t.next=4;break}return t.next=3,bu.MerkleBTree.getByHash(e.data.received,this.storage,xu);case 3:e.receivedIndex=t.sent;case 4:return t.abrupt("return",this._getMsgs(e.receivedIndex,n,r));case 5:case"end":return t.stop()}},t,this)}));return function(e,n){return t.apply(this,arguments)}}(),t.prototype.getAttributeTrustDistance=function(){var t=Os(Ns.mark(function t(e){var n;return Ns.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(zs.isUniqueType(e.name)){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,this.get(e.val,e.name);case 4:return n=t.sent,t.abrupt("return",n&&n.data&&n.data.trustDistance);case 6:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),t.prototype.getMsgTrustDistance=function(){var t=Os(Ns.mark(function t(e){var n,r,i,s;return Ns.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=1e3,t.next=3,this.get(e.getSignerKeyID(),"keyID");case 3:if(t.sent){t.next=6;break}return t.abrupt("return");case 6:r=0;case 7:if(!(r<e.signedData.author.length)){t.next=20;break}if(i=new zs(e.signedData.author[r]),!zs.equals(i,this.viewpoint)){t.next=13;break}return t.abrupt("return",0);case 13:return t.next=15,this.getAttributeTrustDistance(i);case 15:(s=t.sent)<n&&(n=s);case 17:r++,t.next=7;break;case 20:return t.abrupt("return",n<1e3?n:void 0);case 21:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),t.prototype._updateIdentityIndexesByMsg=function(){var e=Os(Ns.mark(function e(n){var r,i,s,o,a,h,u,c,f,l,d,p,g,y,v=this;return Ns.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r={},i={},s=0;case 3:if(!(s<n.signedData.author.length)){e.next=12;break}return o=n.signedData.author[s],e.next=7,this.get(o[1],o[0]);case 7:(a=e.sent)&&(i[a.ipfsHash]=a);case 9:s++,e.next=3;break;case 12:if(Ls(i).length){e.next=14;break}return e.abrupt("return");case 14:h=0;case 15:if(!(h<n.signedData.recipient.length)){e.next=24;break}return u=n.signedData.recipient[h],e.next=19,this.get(u[1],u[0]);case 19:(c=e.sent)&&(r[c.ipfsHash]=c);case 21:h++,e.next=15;break;case 24:if(Ls(r).length){e.next=33;break}return f=[],n.signedData.recipient.forEach(function(t){f.push({name:t[0],val:t[1],conf:1,ref:0})}),(l=new Ys({attrs:f})).sentIndex=new bu.MerkleBTree(this.storage,xu),l.receivedIndex=new bu.MerkleBTree(this.storage,xu),e.next=32,this._saveIdentityToIpfs(l);case 32:r[l.ipfsHash]=l;case 33:d=(d=t.getMsgIndexKey(n)).substr(d.indexOf(":")+1),p=po(nt({},i,r)),g=Ns.mark(function t(e){var s;return Ns.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return s=p[e],t.next=3,v._removeIdentityFromIndexes(s);case 3:if(!r.hasOwnProperty(s.ipfsHash)){t.next=8;break}return n.signedData.recipient.forEach(function(t){for(var e=!1,n=0;n<s.data.attrs.length;n++)if(zs.equals(t,s.data.attrs[n])){s.data.attrs[n].conf|=0,s.data.attrs[n].conf+=1,e=!0;break}e||s.data.attrs.push({name:t[0],val:t[1],conf:1,ref:0})}),"rating"===n.signedData.type&&(n.isPositive()?(n.distance+1<s.data.trustDistance&&(s.data.trustDistance=n.distance+1),s.data.receivedPositive++):n.isNegative()?s.data.receivedNegative++:s.data.receivedNeutral++),t.next=8,s.receivedIndex.put(d,n);case 8:if(!i.hasOwnProperty(s.ipfsHash)){t.next=12;break}return"rating"===n.signedData.type&&(n.isPositive()?s.data.sentPositive++:n.isNegative()?s.data.sentNegative++:s.data.sentNeutral++),t.next=12,s.sentIndex.put(d,n);case 12:return t.next=14,v._addIdentityToIndexes(s);case 14:case"end":return t.stop()}},t,v)}),y=0;case 38:if(!(y<p.length)){e.next=43;break}return e.delegateYield(g(y),"t0",40);case 40:y++,e.next=38;break;case 43:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),t.prototype.addMessage=function(){var e=Os(Ns.mark(function e(n){var r,i,s=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return Ns.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.ipfs){e.next=17;break}return e.next=3,this.getMsgTrustDistance(n);case 3:if(n.distance=e.sent,void 0!==n.distance){e.next=6;break}return e.abrupt("return");case 6:return r=t.getMsgIndexKey(n),e.next=9,this.messagesByDistance.put(r,n);case 9:return r=r.substr(r.indexOf(":")+1),e.next=12,this.messagesByTimestamp.put(r,n);case 12:if(i=e.sent,!s){e.next=16;break}return e.next=16,this._updateIdentityIndexesByMsg(n);case 16:return e.abrupt("return",i);case 17:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),t.prototype.publishMessage=function(){var t=Os(Ns.mark(function t(e){var n,r,i,s,o,a=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return Ns.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n={},!this.ipfs){t.next=14;break}return t.next=4,this.ipfs.files.add(new mt(e.jws,"utf8"));case 4:return r=t.sent,n.hash=r,t.next=8,this.ipfs.pubsub.publish("identifi",new mt(r,"utf8"));case 8:if(!a){t.next=12;break}return t.next=11,this.addMessage(e);case 11:n.indexUri=t.sent;case 12:t.next=25;break;case 14:return i=jn({jws:e.jws,hash:e.getHash()}),t.next=17,rt("https://identi.fi/api/messages",{method:"POST",headers:{"Content-Type":"application/json"},body:i});case 17:if(!(s=t.sent).status||201!==s.status){t.next=25;break}return t.t0=JSON,t.next=22,s.text();case 22:t.t1=t.sent,o=t.t0.parse.call(t.t0,t.t1),n.hash=o.ipfs_hash;case 25:return t.abrupt("return",n);case 26:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),t.prototype.search=function(){var t=Os(Ns.mark(function t(e,n){var r,i,s,o,a,h,u,c,f,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5,d=arguments[3],p=arguments.length>4&&void 0!==arguments[4]?arguments[4]:20;return Ns.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:r={},i=d?uo(d.substring(0,d.indexOf(":"))):0,s=i;case 3:if(!(s<=p)){t.next=39;break}return o=s===i,a=("00"+s).substring(s.toString().length),t.next=8,this.identitiesByTrustDistance.searchText(a+":"+encodeURIComponent(e),l,o?d:void 0);case 8:h=t.sent;case 9:if(!(h&&h.length&&Ls(r).length<l)){t.next=36;break}u=0;case 11:if(!(u<h.length&&Ls(r).length<l)){t.next=31;break}if(!h[u].value||r.hasOwnProperty(h[u].value)){t.next=28;break}return t.prev=13,t.t0=JSON,t.next=17,this.storage.get("/ipfs/"+h[u].value);case 17:t.t1=t.sent,c=t.t0.parse.call(t.t0,t.t1),(f=new Ys(c)).ipfsHash=h[u].value,f.cursor=h[u].key,r[h[u].value]=f,t.next=28;break;case 25:t.prev=25,t.t2=t.catch(13),console.error(t.t2);case 28:u++,t.next=11;break;case 31:return t.next=33,this.identitiesBySearchKey.searchText(a+":"+encodeURIComponent(e),l,h[h.length-1].key);case 33:h=t.sent,t.next=9;break;case 36:s++,t.next=3;break;case 39:return t.abrupt("return",po(r));case 40:case"end":return t.stop()}},t,this,[[13,25]])}));return function(e,n){return t.apply(this,arguments)}}(),t}();return{VERSION:"0.0.59",APIClient:kn,Message:Js,Identity:Ys,Attribute:zs,Index:Eu,util:Is}});
