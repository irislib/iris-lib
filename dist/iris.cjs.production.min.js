"use strict";function e(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(exports,"__esModule",{value:!0});var t=e(require("quick-lru")),n=e(require("dexie")),r=e(require("fuse.js"));function i(){i=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},a=r.iterator||"@@iterator",s=r.asyncIterator||"@@asyncIterator",o=r.toStringTag||"@@toStringTag";function u(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,n){return e[t]=n}}function c(e,t,n,r){var i=Object.create((t&&t.prototype instanceof f?t:f).prototype),a=new O(r||[]);return i._invoke=function(e,t,n){var r="suspendedStart";return function(i,a){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw a;return{value:void 0,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var o=k(s,n);if(o){if(o===p)continue;return o}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=l(e,t,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===p)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}(e,n,a),i}function l(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var p={};function f(){}function h(){}function d(){}var g={};u(g,a,(function(){return this}));var v=Object.getPrototypeOf,y=v&&v(v(T([])));y&&y!==t&&n.call(y,a)&&(g=y);var m=d.prototype=f.prototype=Object.create(g);function b(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){var r;this._invoke=function(i,a){function s(){return new t((function(r,s){!function r(i,a,s,o){var u=l(e[i],e,a);if("throw"!==u.type){var c=u.arg,p=c.value;return p&&"object"==typeof p&&n.call(p,"__await")?t.resolve(p.__await).then((function(e){r("next",e,s,o)}),(function(e){r("throw",e,s,o)})):t.resolve(p).then((function(e){c.value=e,s(c)}),(function(e){return r("throw",e,s,o)}))}o(u.arg)}(i,a,r,s)}))}return r=r?r.then(s,s):s()}}function k(e,t){var n=e.iterator[t.method];if(void 0===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,k(e,t),"throw"===t.method))return p;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return p}var r=l(n,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,p;var i=r.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,p):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,p)}function x(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function S(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function O(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(x,this),this.reset(!0)}function T(e){if(e){var t=e[a];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,i=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:M}}function M(){return{value:void 0,done:!0}}return h.prototype=d,u(m,"constructor",d),u(d,"constructor",h),h.displayName=u(d,o,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,u(e,o,"GeneratorFunction")),e.prototype=Object.create(m),e},e.awrap=function(e){return{__await:e}},b(w.prototype),u(w.prototype,s,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,r,i,a){void 0===a&&(a=Promise);var s=new w(c(t,n,r,i),a);return e.isGeneratorFunction(n)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},b(m),u(m,o,"Generator"),u(m,a,(function(){return this})),u(m,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=T,O.prototype={constructor:O,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return s.type="throw",s.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var o=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(o&&u){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(o){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var a=i;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var s=a?a.completion:{};return s.type=e,s.arg=t,a?(this.method="next",this.next=a.finallyLoc,p):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),S(n),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;S(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:T(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),p}},e}function a(e,t,n,r,i,a,s){try{var o=e[a](s),u=o.value}catch(e){return void n(e)}o.done?t(u):Promise.resolve(u).then(r,i)}function s(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var s=e.apply(t,n);function o(e){a(s,r,i,o,u,"next",e)}function u(e){a(s,r,i,o,u,"throw",e)}o(void 0)}))}}function o(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,c(e,t)}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function c(e,t){return(c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function l(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function p(e,t,n){return(p=l()?Reflect.construct.bind():function(e,t,n){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(e,r));return n&&c(i,n.prototype),i}).apply(null,arguments)}function f(e){var t="function"==typeof Map?new Map:void 0;return(f=function(e){if(null===e||-1===Function.toString.call(e).indexOf("[native code]"))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return p(e,arguments,u(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),c(n,e)})(e)}function h(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function g(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return d(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?d(e,void 0):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var v={throttle:function(e,t){var n;return function(){var r=arguments,i=this;n||(e.apply(i,r),n=!0,setTimeout((function(){return n=!1}),t))}},debounce:function(e,t){var n;return function(){var r=arguments,i=this;clearTimeout(n),n=setTimeout((function(){return e.apply(i,r)}),t)}},sample:function(e){return e[Math.floor(Math.random()*e.length)]},sampleSize:function(e,t){for(var n,r,i=e.slice(0),a=e.length,s=a-t;a-- >s;)n=i[r=Math.floor((a+1)*Math.random())],i[r]=i[a],i[a]=n;return i.slice(s)},defer:function(e){return setTimeout(e,0)},once:function(e){var t=!1;return function(){t||(t=!0,e.apply(this,arguments))}},omit:function(e,t){var n={};return Object.keys(e).forEach((function(r){t.includes(r)||(n[r]=e[r])})),n},defaults:function(e,t){return Object.keys(t).forEach((function(n){void 0===e[n]&&(e[n]=t[n])})),e},pickBy:function(e,t){var n={};return Object.keys(e).forEach((function(r){t(e[r])&&(n[r]=e[r])})),n},isEqual:function(e,t){if(e===t)return!0;if(e instanceof Date&&t instanceof Date)return e.getTime()===t.getTime();if(!e||!t||"object"!=typeof e&&"object"!=typeof t)return e!=e&&t!=t;if(e.prototype!==t.prototype)return!1;var n=Object.keys(e);return n.length===Object.keys(t).length&&n.every((function(n){return v.isEqual(e[n],t[n])}))},uniq:function(e){var t=new Set(e);return Array.from(t)}},y=!1;try{y="[object process]"===Object.prototype.toString.call(global.process)}catch(e){}var m,b=!y&&navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase(),w=b&&b.indexOf(" electron/")>-1,k=["canidae","felidae","cat","cattle","dog","donkey","goat","horse","pig","rabbit","aardvark","aardwolf","albatross","alligator","alpaca","amphibian","anaconda","angelfish","anglerfish","ant","anteater","antelope","antlion","ape","aphid","armadillo","asp","baboon","badger","bandicoot","barnacle","barracuda","basilisk","bass","bat","bear","beaver","bedbug","bee","beetle","bird","bison","blackbird","boa","boar","bobcat","bobolink","bonobo","booby","bovid","bug","butterfly","buzzard","camel","canid","capybara","cardinal","caribou","carp","cat","catshark","caterpillar","catfish","cattle","centipede","cephalopod","chameleon","cheetah","chickadee","chicken","chimpanzee","chinchilla","chipmunk","clam","clownfish","cobra","cockroach","cod","condor","constrictor","coral","cougar","cow","coyote","crab","crane","crawdad","crayfish","cricket","crocodile","crow","cuckoo","cicada","damselfly","deer","dingo","dinosaur","dog","dolphin","donkey","dormouse","dove","dragonfly","dragon","duck","eagle","earthworm","earwig","echidna","eel","egret","elephant","elk","emu","ermine","falcon","ferret","finch","firefly","fish","flamingo","flea","fly","flyingfish","fowl","fox","frog","gamefowl","galliform","gazelle","gecko","gerbil","gibbon","giraffe","goat","goldfish","goose","gopher","gorilla","grasshopper","grouse","guan","guanaco","guineafowl","gull","guppy","haddock","halibut","hamster","hare","harrier","hawk","hedgehog","heron","herring","hippopotamus","hookworm","hornet","horse","hoverfly","hummingbird","hyena","iguana","impala","jackal","jaguar","jay","jellyfish","junglefowl","kangaroo","kingfisher","kite","kiwi","koala","koi","krill","ladybug","lamprey","landfowl","lark","leech","lemming","lemur","leopard","leopon","limpet","lion","lizard","llama","lobster","locust","loon","louse","lungfish","lynx","macaw","mackerel","magpie","mammal","manatee","mandrill","marlin","marmoset","marmot","marsupial","marten","mastodon","meadowlark","meerkat","mink","minnow","mite","mockingbird","mole","mollusk","mongoose","monkey","moose","mosquito","moth","mouse","mule","muskox","narwhal","newt","nightingale","ocelot","octopus","opossum","orangutan","orca","ostrich","otter","owl","ox","panda","panther","parakeet","parrot","parrotfish","partridge","peacock","peafowl","pelican","penguin","perch","pheasant","pig","pigeon","pike","pinniped","piranha","planarian","platypus","pony","porcupine","porpoise","possum","prawn","primate","ptarmigan","puffin","puma","python","quail","quelea","quokka","rabbit","raccoon","rat","rattlesnake","raven","reindeer","reptile","rhinoceros","roadrunner","rodent","rook","rooster","roundworm","sailfish","salamander","salmon","sawfish","scallop","scorpion","seahorse","shark","sheep","shrew","shrimp","silkworm","silverfish","skink","skunk","sloth","slug","smelt","snail","snake","snipe","sole","sparrow","spider","spoonbill","squid","squirrel","starfish","stingray","stoat","stork","sturgeon","swallow","swan","swift","swordfish","swordtail","tahr","takin","tapir","tarantula","tarsier","termite","tern","thrush","tick","tiger","tiglon","toad","tortoise","toucan","trout","tuna","turkey","turtle","tyrannosaurus","urial","vicuna","viper","vole","vulture","wallaby","walrus","wasp","warbler","weasel","whale","whippet","whitefish","wildcat","wildebeest","wildfowl","wolf","wolverine","wombat","woodpecker","worm","wren","xerinae","yak","zebra","alpaca","cat","cattle","chicken","dog","donkey","ferret","gayal","goldfish","guppy","horse","koi","llama","sheep","yak","unicorn"],x=["average","big","colossal","fat","giant","gigantic","great","huge","immense","large","little","long","mammoth","massive","miniature","petite","puny","short","small","tall","tiny","boiling","breezy","broken","bumpy","chilly","cold","cool","creepy","crooked","cuddly","curly","damaged","damp","dirty","dry","dusty","filthy","flaky","fluffy","wet","broad","chubby","crooked","curved","deep","flat","high","hollow","low","narrow","round","shallow","skinny","square","steep","straight","wide","ancient","brief","early","fast","late","long","modern","old","quick","rapid","short","slow","swift","young","abundant","empty","few","heavy","light","many","numerous","Sound","cooing","deafening","faint","harsh","hissing","hushed","husky","loud","melodic","moaning","mute","noisy","purring","quiet","raspy","resonant","screeching","shrill","silent","soft","squealing","thundering","voiceless","whispering","bitter","delicious","fresh","juicy","ripe","rotten","salty","sour","spicy","stale","sticky","strong","sweet","tasteless","tasty","thirsty","fluttering","fuzzy","greasy","grubby","hard","hot","icy","loose","melted","plastic","prickly","rainy","rough","scattered","shaggy","shaky","sharp","shivering","silky","slimy","slippery","smooth","soft","solid","steady","sticky","tender","tight","uneven","weak","wet","wooden","afraid","angry","annoyed","anxious","arrogant","ashamed","awful","bad","bewildered","bored","combative","condemned","confused","creepy","cruel","dangerous","defeated","defiant","depressed","disgusted","disturbed","eerie","embarrassed","envious","evil","fierce","foolish","frantic","frightened","grieving","helpless","homeless","hungry","hurt","ill","jealous","lonely","mysterious","naughty","nervous","obnoxious","outrageous","panicky","repulsive","scary","scornful","selfish","sore","tense","terrible","thoughtless","tired","troubled","upset","uptight","weary","wicked","worried","agreeable","amused","brave","calm","charming","cheerful","comfortable","cooperative","courageous","delightful","determined","eager","elated","enchanting","encouraging","energetic","enthusiastic","excited","exuberant","fair","faithful","fantastic","fine","friendly","funny","gentle","glorious","good","happy","healthy","helpful","hilarious","jolly","joyous","kind","lively","lovely","lucky","obedient","perfect","pleasant","proud","relieved","silly","smiling","splendid","successful","thoughtful","victorious","vivacious","witty","wonderful","zealous","zany","other","good","new","old","great","high","small","different","large","local","social","important","long","young","national","british","right","early","possible","big","little","political","able","late","general","full","far","low","public","available","bad","main","sure","clear","major","economic","only","likely","real","black","particular","international","special","difficult","certain","open","whole","white","free","short","easy","strong","european","central","similar","human","common","necessary","single","personal","hard","private","poor","financial","wide","foreign","simple","recent","concerned","american","various","close","fine","english","wrong","present","royal","natural","individual","nice","french","nihilist","solipsist","materialist","surrealist","heroic","awesome","hedonist","absurd","current","modern","labour","legal","happy","final","red","normal","serious","previous","total","prime","significant","industrial","sorry","dead","specific","appropriate","top","soviet","basic","military","original","successful","aware","hon","popular","heavy","professional","direct","dark","cold","ready","green","useful","effective","western","traditional","scottish","german","independent","deep","interesting","considerable","involved","physical","hot","existing","responsible","complete","medical","blue","extra","past","male","interested","fair","essential","beautiful","civil","primary","obvious","future","environmental","positive","senior","nuclear","annual","relevant","huge","rich","commercial","safe","regional","practical","official","separate","key","chief","regular","due","additional","active","powerful","complex","standard","impossible","light","warm","middle","fresh","sexual","front","domestic","actual","united","technical","ordinary","cheap","strange","internal","excellent","quiet","soft","potential","northern","religious","quick","very","famous","cultural","proper","broad","joint","formal","limited","conservative","lovely","usual","ltd","unable","rural","initial","substantial","bright","average","leading","reasonable","immediate","suitable","equal","detailed","working","overall","female","afraid","democratic","growing","sufficient","scientific","eastern","correct","inc","irish","expensive","educational","mental","dangerous","critical","increased","familiar","unlikely","double","perfect","slow","tiny","dry","historical","thin","daily","southern","increasing","wild","alone","urban","empty","married","narrow","liberal","supposed","upper","apparent","tall","busy","bloody","prepared","russian","moral","careful","clean","attractive","japanese","vital","thick","alternative","fast","ancient","elderly","rare","external","capable","brief","wonderful","grand","typical","entire","grey","constant","vast","surprised","ideal","terrible","academic","funny","minor","pleased","severe","ill","corporate","negative","permanent","weak","brown","fundamental","odd","crucial","inner","used","criminal","contemporary","sharp","sick","near","roman","massive","unique","secondary","parliamentary","african","unknown","subsequent","angry","alive","guilty","lucky","enormous","well","yellow","unusual","net","tough","dear","extensive","glad","remaining","agricultural","alright","healthy","italian","principal","tired","efficient","comfortable","chinese","relative","friendly","conventional","willing","sudden","proposed","voluntary","slight","valuable","dramatic","golden","temporary","federal","keen","flat","silent","indian","worried","pale","statutory","welsh","dependent","firm","wet","competitive","armed","radical","outside","acceptable","sensitive","living","pure","global","emotional","sad","secret","rapid","adequate","fixed","sweet","administrative","wooden","remarkable","comprehensive","surprising","solid","rough","mere","mass","brilliant","maximum","absolute","electronic","visual","electric","cool","spanish","literary","continuing","supreme","chemical","genuine","exciting","written","advanced","extreme","classical","fit","favourite","widespread","confident","straight","proud","numerous","opposite","distinct","mad","helpful","given","disabled","consistent","anxious","nervous","awful","stable","constitutional","satisfied","conscious","developing","strategic","holy","smooth","dominant","remote","theoretical","outstanding","pink","pretty","clinical","minimum","honest","impressive","related","residential","extraordinary","plain","visible","accurate","distant","still","greek","complicated","musical","precise","gentle","broken","live","silly","fat","tight","monetary","round","psychological","violent","unemployed","inevitable","junior","sensible","grateful","pleasant","dirty","structural","welcome","deaf","above","continuous","blind","overseas","mean","entitled","delighted","loose","occasional","evident","desperate","fellow","universal","square","steady","classic","equivalent","intellectual","victorian","level","ultimate","creative","lost","medieval","clever","linguistic","convinced","judicial","raw","sophisticated","asleep","vulnerable","illegal","outer","revolutionary","bitter","changing","australian","native","imperial","strict","wise","informal","flexible","collective","frequent","experimental","spiritual","intense","rational","generous","inadequate","prominent","logical","bare","historic","modest","dutch","acute","electrical","valid","weekly","gross","automatic","loud","reliable","mutual","liable","multiple","ruling","curious","sole","managing","pregnant","latin","nearby","exact","underlying","identical","satisfactory","marginal","distinctive","electoral","urgent","presidential","controversial","everyday","encouraging","organic","continued","expected","statistical","desirable","innocent","improved","exclusive","marked","experienced","unexpected","superb","sheer","disappointed","frightened","gastric","romantic","naked","reluctant","magnificent","convenient","established","closed","uncertain","artificial","diplomatic","tremendous","marine","mechanical","retail","institutional","mixed","required","biological","known","functional","straightforward","superior","digital","spectacular","unhappy","confused","unfair","aggressive","spare","painful","abstract","asian","associated","legislative","monthly","intelligent","hungry","explicit","nasty","just","faint","coloured","ridiculous","amazing","comparable","successive","realistic","back","decent","decentralized","bitcoin","cypherpunk","unnecessary","flying","random","influential","dull","genetic","neat","marvellous","crazy","damp","giant","secure","bottom","skilled","subtle","elegant","brave","lesser","parallel","steep","intensive","casual","tropical","lonely","partial","preliminary","concrete","alleged","assistant","vertical","upset","delicate","mild","occupational","excessive","progressive","exceptional","integrated","striking","continental","okay","harsh","combined","fierce","handsome","characteristic","chronic","compulsory","interim","objective","splendid","magic","systematic","obliged","payable","fun","horrible","primitive","fascinating","ideological","metropolitan","surrounding","estimated","peaceful","premier","operational","technological","kind","advisory","hostile","precious","accessible","determined","excited","impressed","provincial","smart","endless","isolated","drunk","geographical","like","dynamic","boring","forthcoming","unfortunate","definite","super","notable","indirect","stiff","wealthy","awkward","lively","neutral","artistic","content","mature","colonial","ambitious","evil","magnetic","verbal","legitimate","sympathetic","empirical","head","shallow","vague","naval","depressed","shared","added","shocked","mid","worthwhile","qualified","missing","blank","absent","favourable","polish","israeli","developed","profound","representative","enthusiastic","dreadful","rigid","reduced","cruel","coastal","peculiar","swiss","crude","extended","selected","eager","canadian","bold","relaxed","corresponding","running","planned","applicable","immense","allied","comparative","uncomfortable","conservation","productive","beneficial","bored","charming","minimal","mobile","turkish","orange","rear","passive","suspicious","overwhelming","fatal","resulting","symbolic","registered","neighbouring","calm","irrelevant","patient","compact","profitable","rival","loyal","moderate","distinguished","interior","noble","insufficient","eligible","mysterious","varying","managerial","molecular","olympic","linear","prospective","printed","parental","diverse","elaborate","furious","fiscal","burning","useless","semantic","embarrassed","inherent","philosophical","deliberate","awake","variable","promising","unpleasant","varied","sacred","selective","inclined","tender","hidden","worthy","intermediate","sound","protective","fortunate","slim","defensive","divine","stuck","driving","invisible","misleading","circular","mathematical","inappropriate","liquid","persistent","solar","doubtful","manual","architectural","intact","incredible","devoted","prior","tragic","respectable","optimistic","convincing","unacceptable","decisive","competent","spatial","respective","binding","relieved","nursing","toxic","select","redundant","integral","then","probable","amateur","fond","passing","specified","territorial","horizontal","inland","cognitive","regulatory","miserable","resident","polite","scared","gothic","civilian","instant","lengthy","adverse","korean","unconscious","anonymous","aesthetic","orthodox","static","unaware","costly","fantastic","foolish","fashionable","causal","compatible","wee","implicit","dual","ok","cheerful","subjective","forward","surviving","exotic","purple","cautious","visiting","aggregate","ethical","teenage","dying","disastrous","delicious","confidential","underground","thorough","grim","autonomous","atomic","frozen","colourful","injured","uniform","ashamed","glorious","wicked","coherent","rising","shy","novel","balanced","delightful","arbitrary","adjacent","worrying","weird","unchanged","rolling","evolutionary","intimate","sporting","disciplinary","formidable","lexical","noisy","gradual","accused","homeless","supporting","coming","renewed","excess","retired","rubber","chosen","outdoor","embarrassing","preferred","bizarre","appalling","agreed","imaginative","governing","accepted","vocational","mighty","puzzled","worldwide","organisational","sunny","eldest","eventual","spontaneous","vivid","rude","faithful","ministerial","innovative","controlled","conceptual","unwilling","civic","meaningful","alive","brainy","breakable","busy","careful","cautious","clever","concerned","crazy","curious","dead","different","difficult","doubtful","easy","famous","fragile","helpful","helpless","important","impossible","innocent","inquisitive","modern","open","outstanding","poor","powerful","puzzled","real","rich","shy","sleepy","super","tame","uninterested","wandering","wild","wrong","adorable","alert","average","beautiful","blonde","bloody","blushing","bright","clean","clear","cloudy","colorful","crowded","cute","dark","drab","distinct","dull","elegant","fancy","filthy","glamorous","gleaming","graceful","grotesque","homely","light","misty","motionless","muddy","plain","poised","quaint","shiny","smoggy","sparkling","spotless","stormy","strange","ugly","unsightly","unusual","bad","better","beautiful","big","black","blue","bright","clumsy","crazy","dizzy","dull","fat","frail","friendly","funny","great","green","gigantic","gorgeous","grumpy","handsome","happy","horrible","itchy","jittery","jolly","kind","long","lazy","magnificent","magenta","many","mighty","mushy","nasty","new","nice","nosy","nutty","nutritious","odd","orange","ordinary","pretty","precious","prickly","purple","quaint","quiet","quick","quickest","rainy","rare","ratty","red","roasted","robust","round","sad","scary","scrawny","short","silly","stingy","strange","striped","spotty","tart","tall","tame","tan","tender","testy","tricky","tough","ugly","ugliest","vast","watery","wasteful","wonderful","yellow","yummy","zany"],S={gunOnceDefined:function(e){return new Promise((function(t){e.on((function(e,n,r,i){void 0!==e&&(i.off(),t(e))}))}))},getHash:function(e,t){var n=this;return s(i().mark((function r(){var a,s,o;return i().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(void 0===t&&(t="base64"),void 0!==e){r.next=3;break}throw new Error("getHash data was undefined");case 3:return"string"!=typeof e&&(e=JSON.stringify(e)),a=new TextEncoder,e=a.encode(e),r.next=8,crypto.subtle.digest("SHA-256",e);case 8:if(s=r.sent,"buffer"!==t){r.next=11;break}return r.abrupt("return",s);case 11:if(o=n.arrayBufferToBase64(s),"hex"!==t){r.next=14;break}return r.abrupt("return",n.base64ToHex(o));case 14:return r.abrupt("return",o);case 15:case"end":return r.stop()}}),r)})))()},capitalize:function(e){return e.charAt(0).toUpperCase()+e.slice(1)},generateName:function(){return this.capitalize(v.sample(x))+" "+this.capitalize(v.sample(k))},base64ToHex:function(e){for(var t=atob(e),n="",r=0;r<t.length;r++){var i=t.charCodeAt(r).toString(16);n+=2===i.length?i:"0"+i}return n},arrayBufferToBase64:function(e){for(var t="",n=new Uint8Array(e),r=n.byteLength,i=0;i<r;i++)t+=String.fromCharCode(n[i]);return window.btoa(t)},getCaret:function(e){if(e.selectionStart)return e.selectionStart;if(document.selection){e.focus();var t=document.selection.createRange();if(null===t)return 0;var n=e.createTextRange(),r=n.duplicate();return n.moveToBookmark(t.getBookmark()),r.setEndPoint("EndToStart",n),r.text.length}return 0},getUrlParameter:function(e,t){var n,r,i=(t||window.location.search.substring(1)).split("&");for(r=0;r<i.length;r++)if((n=i[r].split("="))[0]===e)return void 0===n[1]||decodeURIComponent(n[1])},formatTime:function(e){var t=e.toLocaleTimeString(void 0,{timeStyle:"short"}),n=t.split(":");return 3===n.length?n[0]+":"+n[1]+n[2].slice(2):t},formatDate:function(e){var t=e.toLocaleString(void 0,{dateStyle:"short",timeStyle:"short"}),n=t.split(":");return 3===n.length?n[0]+":"+n[1]+n[2].slice(2):t},getDaySeparatorText:function(e,t,n,r){if(n||(r=(n=new Date).toLocaleDateString({dateStyle:"short"})),t===r)return"today";var i=Math.round((n-e)/864e5);return 0===i?"today":1===i?"yesterday":i<=5?e.toLocaleDateString(void 0,{weekday:"long"}):t},getProfileLink:function(e){return window.location.origin+"/#/profile/"+encodeURIComponent(e)},truncateString:function(e,t){return void 0===t&&(t=30),e.length>t?e.slice(0,t)+"...":e},createElement:function(e,t,n){var r=document.createElement(e);return t&&r.setAttribute("class",t),n&&n.appendChild(r),r},isNode:y,isElectron:w,isMobile:!y&&function(){if(w)return!1;var e,t=!1;return e=navigator.userAgent||navigator.vendor||"",(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4)))&&(t=!0),t}(),throttle:function(e,t){var n;return function(){var r=arguments,i=this;n||(e.apply(i,r),n=!0,setTimeout((function(){return n=!1}),t))}},debounce:function(e,t){var n;return function(){var r=this,i=arguments;clearTimeout(n),n=setTimeout((function(){return e.apply(r,i)}),t)}},sample:function(e){return e[Math.floor(Math.random()*e.length)]},sampleSize:function(e,t){for(var n,r,i=e.slice(0),a=e.length,s=a-t;a-- >s;)n=i[r=Math.floor((a+1)*Math.random())],i[r]=i[a],i[a]=n;return i.slice(s)},defer:function(e){return setTimeout(e,0)},once:function(e){var t=!1;return function(){t||(t=!0,e.apply(this,arguments))}},omit:function(e,t){var n={};return Object.keys(e).forEach((function(r){t.includes(r)||(n[r]=e[r])})),n}},O={getActiveKey:function(e,t,n){var r=this;return s(i().mark((function a(){var s,o,u,c,l;return i().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(void 0===e&&(e="."),void 0===t&&(t="iris.key"),!m){i.next=4;break}return i.abrupt("return",m);case 4:if(!n){i.next=21;break}if(!n.existsSync(s=e+"/"+t)){i.next=11;break}o=n.readFileSync(s,"utf8"),m=r.fromString(o),i.next=17;break;case 11:return i.next=13,r.generate();case 13:u=i.sent,n.writeFileSync(s,r.toString(m=m||u)),n.chmodSync(s,400);case 17:if(m){i.next=19;break}throw new Error("loading default key failed - check "+e+"/"+t);case 19:i.next=33;break;case 21:if(!(c=window.localStorage.getItem("iris.myKey"))){i.next=26;break}m=r.fromString(c),i.next=31;break;case 26:return i.next=28,r.generate();case 28:l=i.sent,m=m||l,window.localStorage.setItem("iris.myKey",r.toString(m));case 31:if(m){i.next=33;break}throw new Error("loading default key failed - check localStorage iris.myKey");case 33:return i.abrupt("return",m);case 34:case"end":return i.stop()}}),a)})))()},getDefault:function(e,t){return void 0===e&&(e="."),void 0===t&&(t="iris.key"),this.getActiveKey(e,t)},getActivePub:function(e,t){var n=this;return s(i().mark((function r(){return i().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return void 0===e&&(e="."),void 0===t&&(t="iris.key"),r.next=4,n.getActiveKey(e,t);case 4:return r.abrupt("return",r.sent.pub);case 6:case"end":return r.stop()}}),r)})))()},setActiveKey:function(e,t,n,r,i){if(void 0===t&&(t=!0),void 0===n&&(n="."),void 0===r&&(r="iris.key"),m=e,t)if(S.isNode){var a=n+"/"+r;i.writeFileSync(a,this.toString(m)),i.chmodSync(a,400)}else window.localStorage.setItem("iris.myKey",this.toString(m))},toString:function(e){return JSON.stringify(e)},getId:function(e){if(!e||!e.pub)throw new Error("missing param");return e.pub},fromString:function(e){return JSON.parse(e)},generate:function(){return s(i().mark((function e(){var t,n,r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=window.crypto.subtle,e.next=4,t.generateKey({name:"ECDSA",namedCurve:"P-256"},!0,["sign","verify"]).then(function(){var e=s(i().mark((function e(n){var r,a;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={},e.next=3,t.exportKey("jwk",n.privateKey);case 3:return r.priv=e.sent.d,e.next=6,t.exportKey("jwk",n.publicKey);case 6:return r.pub=(a=e.sent).x+"."+a.y,e.abrupt("return",r);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 4:return n=e.sent,e.prev=5,e.next=8,t.generateKey({name:"ECDH",namedCurve:"P-256"},!0,["deriveKey"]).then(function(){var e=s(i().mark((function e(n){var r,a;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={},e.next=3,t.exportKey("jwk",n.privateKey);case 3:return r.epriv=e.sent.d,e.next=6,t.exportKey("jwk",n.publicKey);case 6:return r.epub=(a=e.sent).x+"."+a.y,e.abrupt("return",r);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 8:r=e.sent,e.next=18;break;case 11:if(e.prev=11,e.t0=e.catch(5),"Error: ECDH is not a supported algorithm"!=e.t0){e.next=17;break}console.log("Ignoring ECDH..."),e.next=18;break;case 17:throw e.t0;case 18:return e.abrupt("return",{pub:n.pub,priv:n.priv,epub:(r=r||{}).epub,epriv:r.epriv});case 23:throw e.prev=23,e.t1=e.catch(0),console.log(e.t1),e.t1;case 28:case"end":return e.stop()}}),e,null,[[0,23],[5,11]])})))()},keyToJwk:function(e){"string"==typeof e&&(e={pub:e});var t={kty:"EC",crv:"P-256",x:e.pub.split(".")[0],y:e.pub.split(".")[1],ext:!0};return t.key_ops=e.priv?["sign"]:["verify"],e.priv&&(t.d=e.priv),t},sign:function(e,t,n,r){var a=this;return s(i().mark((function s(){var o,u,c,l;return i().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(void 0===r&&(r={}),void 0!==e){i.next=3;break}throw"`undefined` not allowed.";case 3:return o=JSON.stringify(e),u=a.keyToJwk(t),i.next=7,S.getHash(o,"buffer");case 7:return c=i.sent,i.next=10,window.crypto.subtle.importKey("jwk",u,{name:"ECDSA",namedCurve:"P-256"},!1,["sign"]).then((function(e){return window.crypto.subtle.sign({name:"ECDSA",hash:{name:"SHA-256"}},e,c)}));case 10:if(l={m:o,s:Buffer.from(i.sent).toString(r.encode||"base64")},r.raw||(l="aSEA"+JSON.stringify(l)),n)try{n(l)}catch(e){console.log(e)}return i.abrupt("return",l);case 15:case"end":return i.stop()}}),s)})))()},verify:function(e,t,n,r){var a=this;return s(i().mark((function s(){var o,u,c,l,p,f,h;return i().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return void 0===r&&(r={}),i.prev=1,"string"==typeof e&&(e="aSEA"===e.slice(0,4)?JSON.parse(e.slice(4)):JSON.parse(e)),o=a.keyToJwk(t.pub||t),i.next=7,crypto.subtle.importKey("jwk",o,{name:"ECDSA",namedCurve:"P-256"},!1,["verify"]);case 7:return u=i.sent,c="string"==typeof e.m?e.m:JSON.stringify(e.m),i.next=11,S.getHash(c,"buffer");case 11:return l=i.sent,p=Buffer.from(e.s,r.encode||"base64"),f=new Uint8Array(p),i.next=16,crypto.subtle.verify({name:"ECDSA",hash:{name:"SHA-256"}},u,f,l);case 16:if(h=i.sent?JSON.parse(e.m):void 0,n)try{n(h)}catch(e){console.log(e)}return i.abrupt("return",h);case 23:return i.prev=23,i.t0=i.catch(1),console.log(i.t0),i.abrupt("return",void 0);case 27:case"end":return i.stop()}}),s,null,[[1,23]])})))()},secret:function(e,t){return s(i().mark((function n(){var r,a,o,u,c,l;return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a=t.epub,o=t.epriv,u=(r=function(e,t){var n=e.split(".");return Object.assign(t?{d:t}:{},{x:n[0],y:n[1],kty:"EC",crv:"P-256",ext:!0})})(e.epub||e),n.t0=Object,n.next=8,crypto.subtle.importKey("jwk",u,{name:"ECDH",namedCurve:"P-256"},!0,[]);case 8:return n.t1=n.sent,n.t2={public:n.t1},n.t3={name:"ECDH",namedCurve:"P-256"},c=n.t0.assign.call(n.t0,n.t2,n.t3),l=r(a,o),n.abrupt("return",crypto.subtle.importKey("jwk",l,{name:"ECDH",namedCurve:"P-256"},!1,["deriveBits"]).then(function(){var e=s(i().mark((function e(t){var n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,crypto.subtle.deriveBits(c,t,256);case 2:return n=new Uint8Array(e.sent),e.next=6,crypto.subtle.importKey("raw",n,{name:"AES-GCM",length:256},!0,["encrypt","decrypt"]);case 6:return e.abrupt("return",crypto.subtle.exportKey("jwk",e.sent).then((function(e){return e.k})));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 14:case"end":return n.stop()}}),n)})))()},aeskey:function(e,t){var n=this;return s(i().mark((function r(){var a,s,o,u,c;return i().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return a=e+(t||n.random(8)).toString("utf8"),r.next=3,crypto.subtle.digest({name:"SHA-256"},(new TextEncoder).encode(a));case 3:return s=r.sent,s=Buffer.from(s,"binary"),o=s.toString("base64"),u=o.replace(/\+/g,"-").replace(/\//g,"_").replace(/\=/g,""),c={kty:"oct",k:u,ext:!1,alg:"A256GCM"},r.next=10,crypto.subtle.importKey("jwk",c,{name:"AES-GCM"},!1,["encrypt","decrypt"]);case 10:return r.abrupt("return",r.sent);case 11:case"end":return r.stop()}}),r)})))()},random:function(e){return Buffer.from(crypto.getRandomValues(new Uint8Array(e)))},encrypt:function(e,t,n,r){var a=this;return s(i().mark((function s(){var o,u,c,l;return i().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(void 0===r&&(r={}),o=t.epriv||t,void 0!==e){i.next=4;break}throw"`undefined` not allowed.";case 4:return u="string"==typeof e?e:JSON.stringify(e),c={s:a.random(9),iv:a.random(15)},i.next=8,a.aeskey(o,c.s).then((function(e){return crypto.subtle.encrypt({name:r.name||"AES-GCM",iv:new Uint8Array(c.iv)},e,(new TextEncoder).encode(u))}));case 8:if(l={ct:Buffer.from(i.sent,"binary").toString(r.encode||"base64"),iv:c.iv.toString(r.encode||"base64"),s:c.s.toString(r.encode||"base64")},r.raw||(l="SEA"+JSON.stringify(l)),n)try{n(l)}catch(e){console.log(e)}return i.abrupt("return",l);case 13:case"end":return i.stop()}}),s)})))()},decrypt:function(e,t,n,r){var a=this;return s(i().mark((function s(){var o,u,c,l,p,f,h,d;return i().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:void 0===r&&(r={}),o=t.epriv||t;try{e=JSON.parse(e)}catch(e){}if((u=0===e.indexOf("SEA{")?JSON.parse(e.slice(3)):JSON.parse(e)).ct&&u.iv&&u.s){i.next=6;break}throw"Invalid ciphertext "+u;case 6:return c=Buffer.from(u.s,r.encode||"base64"),l=Buffer.from(u.iv,r.encode||"base64"),p=Buffer.from(u.ct,r.encode||"base64"),i.next=11,a.aeskey(o,c).then((function(e){return crypto.subtle.decrypt({name:r.name||"AES-GCM",iv:new Uint8Array(l),tagLength:128},e,new Uint8Array(p))}));case 11:f=i.sent,h=new TextDecoder("utf8").decode(f),d=h;try{d=JSON.parse(h)}catch(e){}if(n)try{n(d)}catch(e){console.log(e)}return i.abrupt("return",d);case 17:case"end":return i.stop()}}),s)})))()}},T="http://localhost:8767/gun",M={"wss://gun-rs.iris.to/gun":{}};if(self.window){var j=window.location,C=j.host,P=C.startsWith("localhost")&&"localhost:8080"!==C;(j.hostname.endsWith("herokuapp.com")||P)&&(Object.keys(M).forEach((function(e){return M[e].enabled=!1})),M[j.origin+"/gun"]={enabled:!0})}var I={known:{},add:function(e){var t=this;return s(i().mark((function n(){var r,a,s,o;return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(e.from&&Object.keys(t.known).forEach((function(n){t.known[n].from===e.from&&delete t.known[n]})),t.known[r=e.url||""]=t.known[r]||v.omit(e,["url"]),"public"!==e.visibility){n.next=17;break}return n.next=6,O.secret(Je.getKey().epub,Je.getKey());case 6:if(n.t0=n.sent,n.t0){n.next=9;break}n.t0="";case 9:return a=n.t0,n.next=12,O.encrypt(e.url,a);case 12:return s=n.sent,n.next=15,S.getHash(s);case 15:o=n.sent,H().user().get("peers").get(o).put({url:e.url,lastSeen:(new Date).toISOString()});case 17:!1!==e.enabled?e.url&&t.connect(e.url):t.save();case 18:case"end":return n.stop()}}),n)})))()},remove:function(e){delete this.known[e],this.save()},disconnect:function(e){H().on("bye",e),e.url=""},save:function(){localStorage.setItem("gunPeers",JSON.stringify(this.known))},getSaved:function(){var e=localStorage.getItem("gunPeers");return e=e&&"undefined"!==e?JSON.parse(e):M,S.isElectron&&(e[T]={}),Object.keys(e).forEach((function(t){return v.defaults(e[t],{enabled:!0})})),e},reset:function(){localStorage.setItem("gunPeers",""),this.known=this.getSaved()},connect:function(e){e&&(this.isMixedContent(e)||(this.known[e]?(this.known[e].enabled=!0,H().opt({peers:[e]}),this.save()):this.add({url:e})))},disable:function(e,t){this.known[e].enabled=!1,t&&this.disconnect(t),this.save()},isMixedContent:function(e){return!!e&&"https:"===window.location.protocol&&0===e.indexOf("http:")},random:function(){var e=this,t=S.isElectron&&this.known[T]&&!1!==this.known[T].enabled,n=t?Math.max(0,1):1,r=v.sampleSize(Object.keys(v.pickBy(this.known,(function(t,n){return!e.isMixedContent(n)&&t.enabled&&!(S.isElectron&&n===T)}))),n);return r&&t&&r.push(T),console.log("sample",r,JSON.stringify(this.known)),r},checkGunPeerCount:function(){},init:function(){var e=this;this.known=this.getSaved(),setInterval((function(){return e.checkGunPeerCount()}),1e3)}},E=function(){function e(e){void 0===e&&(e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}))),this.id=e}var t=e.prototype;return t.handle=function(e){throw new Error("not implemented")},t.postMessage=function(e){this.handle(e)},e}(),A=function(){function e(){}return e.fromObject=function(e){if("get"===e.type)return D.fromObject(e);if("put"===e.type)return N.fromObject(e);throw new Error("not implemented")},e.deserialize=function(){var e=s(i().mark((function e(t,n){var r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=JSON.parse(t)).get){e.next=5;break}return e.abrupt("return",D.deserialize(r,t,n));case 5:if(!r.put){e.next=9;break}return e.abrupt("return",N.deserialize(r,t,n));case 9:if(!r.dam||"hi"!==r.dam){e.next=13;break}return e.abrupt("return",_.deserialize(r));case 13:throw new Error("unknown message type");case 14:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),e.prototype.serialize=function(){throw new Error("not implemented")},e}();function L(){return Math.random().toString(36).slice(2,10)}var K,D=function(){function e(e,t,n,r,i,a,s){this.type="get",this.id=e,this.from=n,this.nodeId=t,this.recipients=r,this.childKey=i,this.jsonStr=a,this.checksum=s}return e.prototype.serialize=function(){if(this.jsonStr)return this.jsonStr;var e=this.nodeId.replace(/^global\//,"").replace(/^user\//,"~"),t={"#":this.id,get:{"#":e,".":this.childKey}};return this.childKey&&(t.get["."]=this.childKey),this.jsonStr=JSON.stringify(t),this.jsonStr},e.deserialize=function(){var t=s(i().mark((function t(n,r,a){var s,o;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s=n["#"],(o=n.get["#"]).startsWith("~")&&(o="user/"+o.slice(1)),t.abrupt("return",new e(s,o="global/"+o,a,void 0,n.get["."],r));case 6:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}(),e.fromObject=function(t){return new e(t.id,t.nodeId,t.from,t.recipients,t.childKey,t.jsonStr,t.checksum)},e.new=function(t,n,r,i,a,s){return new e(L(),t,n,r,i,a,s)},e}(),N=function(){function e(e,t,n,r,i,a,s){this.type="put",this.id=e,this.from=n,this.updatedNodes=t,this.inResponseTo=r,this.recipients=i,this.jsonStr=a,this.checksum=s}return e.prototype.serialize=function(){for(var e={"#":this.id,put:{}},t=0,n=Object.entries(this.updatedNodes);t<n.length;t++)for(var r=n[t],i=r[1],a=r[0].replace(/^global\//,"").replace(/^user\//,"~"),s=e.put[a]={},o=0,u=Object.entries(i);o<u.length;o++){var c=u[o],l=c[0],p=c[1];if(p){var f=p;s[l]=f.value,s._=s._||{},s._[">"]=s._[">"]||{},s._[">"][l]=f.updatedAt}}return JSON.stringify(e)},e.deserialize=function(){var t=s(i().mark((function t(n,r,a){var s,o,u,c,l,p,f,h,d,g,v,y,m,b,w,k,x,S,T;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:s=n["#"],o={},u=0,c=Object.entries(n.put);case 3:if(!(u<c.length)){t.next=37;break}f=(l=c[u])[1],h={},d=(p=l[0]).startsWith("~"),g=0,v=Object.entries(f);case 9:if(!(g<v.length)){t.next=32;break}if(b=(y=v[g])[1],"_"!==(m=y[0])){t.next=13;break}return t.abrupt("continue",29);case 13:if(!d){t.next=27;break}return w=p.split("/")[0].slice(1),k=JSON.parse(b),x=k["~"],S=JSON.stringify({"#":p,".":m,":":k[":"],">":f._[">"][m]}),t.next=23,O.verify({s:x,m:S},w);case 23:if(t.t0=t.sent,t.t1=void 0,t.t0!==t.t1){t.next=27;break}throw new Error("invalid signature in "+p+" of "+S);case 27:h[m]={value:b,updatedAt:f._[">"][m]};case 29:g++,t.next=9;break;case 32:T="global/"+p.replace(/^~/,"user/"),o[T]=h;case 34:u++,t.next=3;break;case 37:return t.abrupt("return",new e(s,o,a,void 0,void 0,r));case 38:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}(),e.fromObject=function(t){return new e(t.id,t.updatedNodes,t.from,t.inResponseTo,t.recipients,t.jsonStr,t.checksum)},e.new=function(t,n,r,i,a,s){return new e(L(),t,n,r,i,a,s)},e.newFromKv=function(t,n,r){var i={};return i[t]=n,e.new(i,r)},e}(),_=function(){function e(e,t){this.type="hi",this.peerId=e,this.jsonStr=t}return e.prototype.serialize=function(){return this.jsonStr||(this.jsonStr=JSON.stringify({dam:"hi","#":this.peerId})),this.jsonStr},e.deserialize=function(t){return new e(t["#"])},e}(),U=function(e){function n(n){var r;return void 0===n&&(n={}),(r=e.call(this)||this).config={},r.store=new t({maxSize:1e4}),r.config=n,r}o(n,e);var r=n.prototype;return r.handle=function(e){e instanceof N?this.handlePut(e):e instanceof D?this.handleGet(e):console.log("Memory got unknown message",e)},r.handleGet=function(e){if(e.from){var t=this.store.get(e.nodeId);if(t){var n=N.newFromKv(e.nodeId,t,this);n.inResponseTo=e.id,e.from&&e.from.postMessage(n)}}else console.log("no from in get message")},r.mergeAndSave=function(e,t){var n=this.store.get(e);if(void 0===n)this.store.set(e,t);else{for(var r=0,i=Object.entries(t);r<i.length;r++){var a=i[r],s=a[0],o=a[1];n[s]&&n[s].updatedAt>=o.updatedAt||(n[s]=o)}this.store.set(e,n)}},r.handlePut=function(){var e=s(i().mark((function e(t){var n,r,a,s,o;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=0,r=Object.entries(t.updatedNodes);case 1:if(!(n<r.length)){e.next=11;break}if(s=(a=r[n])[0],o=a[1]){e.next=7;break}return console.log("deleting",s),this.store.delete(s),e.abrupt("continue",8);case 7:this.mergeAndSave(s,o);case 8:n++,e.next=1;break;case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n}(E),z=function(e){function t(t){var n;return(n=e.call(this,t)||this).version(1).stores({nodes:", value, updatedAt"}),n.nodes=n.table("nodes"),n}return o(t,e),t}(n),G=function(e){function t(t){var n;return void 0===t&&(t={}),(n=e.call(this)||this).config={},n.notStored=new Set,n.putQueue={},n.getQueue={},n.i=0,n.queue=0,n.throttledPut=v.throttle((function(){var e=Object.keys(n.putQueue),t=e.map((function(e){return n.notStored.delete(e),n.putQueue[e]}));n.db.nodes.bulkPut(t,e).catch((function(e){console.error(e)})),n.putQueue={}}),500),n.throttledGet=v.throttle((function(){var e=n.getQueue,t=Object.keys(e);n.db.nodes.bulkGet(t).then((function(n){for(var r=0;r<t.length;r++)for(var i,a=n[r],s=g(e[t[r]]);!(i=s()).done;)(0,i.value)(a)})),n.getQueue={}}),100),n.config=t,n.db=new z(t.dbName||"iris"),n.db.open().catch((function(e){console.error(e.stack||e)})),n}o(t,e);var n=t.prototype;return n.put=function(e,t){this.putQueue[e]=t,this.throttledPut()},n.get=function(e,t){this.getQueue[e]=this.getQueue[e]||[],this.getQueue[e].push(t),this.throttledGet()},n.handle=function(e){e instanceof N?this.handlePut(e):e instanceof D?this.handleGet(e):console.log("worker got unknown message",e)},n.handleGet=function(e){var t=this;this.notStored.has(e.nodeId)||this.get(e.nodeId,(function(n){if(void 0===n)t.notStored.add(e.nodeId);else{var r=N.newFromKv(e.nodeId,n,t);r.inResponseTo=e.id,e.from&&e.from.postMessage(r)}}))},n.mergeAndSave=function(e,t){var n=this;this.get(e,(function(r){if(void 0===r)n.put(e,t);else{for(var i=0,a=Object.entries(t);i<a.length;i++){var s=a[i],o=s[0],u=s[1];r[o]&&r[o].updatedAt>=u.updatedAt||(r[o]=u)}n.put(e,r)}}))},n.savePath=function(e,t){void 0===t?(this.db.nodes.delete(e),this.notStored.add(e)):(this.notStored.delete(e),this.mergeAndSave(e,t))},n.handlePut=function(){var e=s(i().mark((function e(t){var n,r,a,s,o;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=0,r=Object.entries(t.updatedNodes);case 1:if(!(n<r.length)){e.next=10;break}if(s=(a=r[n])[0],o=a[1]){e.next=6;break}return console.log("deleting",s),e.abrupt("continue",7);case 6:this.mergeAndSave(s,o);case 7:n++,e.next=1;break;case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t}(E),q=function(e){function t(t,n){var r;return(r=e.call(this,"websocket:"+t)||this).sendQueue=[],console.log("Websocket",t),r.router=n,r.ws=new WebSocket(t.replace("http","ws")),r.ws.onopen=function(){console.log("Connected to "+t),r.sendQueue.forEach((function(e){return r.ws.send(e)})),r.sendQueue=[]},r.ws.onmessage=function(){var e=s(i().mark((function e(t){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,A.deserialize(t.data,h(r));case 3:r.router.postMessage(e.sent),e.next=9;break;case 7:e.prev=7,e.t0=e.catch(0);case 9:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),r.ws.onclose=function(){console.log("Disconnected from "+t)},r.ws.onerror=function(){console.log("Error on "+t)},r}return o(t,e),t.prototype.handle=function(e){if(e instanceof D||e instanceof N){if(e.from===this)return;this.ws.readyState===WebSocket.OPEN?this.ws.send(e.serialize()):this.ws.readyState===WebSocket.CONNECTING&&this.sendQueue.push(e.serialize())}},t}(E),J=function(e){function t(t){var n;if(void 0===t&&(t={}),(n=e.call(this,"router")||this).storageAdapters=new Set,n.networkAdapters=new Set,n.serverPeers=new Set,n.seenMessages=new Set,n.seenGetMessages=new Map,n.subscribersByTopic=new Map,n.msgCounter=0,n.peerId=t.peerId||Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15),n.storageAdapters.add(new U(t)),n.storageAdapters.add(new G(t)),console.log("config",t),t.peers)for(var r,i=g(t.peers);!(r=i()).done;){var a=r.value;a&&n.serverPeers.add(new q(a,h(n)))}return n}o(t,e);var n=t.prototype;return n.handle=function(e){if(e instanceof N||e instanceof D){if(this.seenMessages.has(e.id))return;this.seenMessages.add(e.id),e instanceof N?this.handlePut(e):e instanceof D&&this.handleGet(e)}},n.handlePut=function(e){var t=this,n=new Set;Object.keys(e.updatedNodes).forEach((function(r){for(var i,a=r.split("/").slice(0,3).join("/"),s=t.subscribersByTopic.get(a),o=g(t.storageAdapters);!(i=o()).done;){var u=i.value;e.from!==u&&n.add(u)}for(var c,l=g(t.serverPeers);!(c=l()).done;){var p=c.value;e.from!==p&&n.add(p)}if(s)for(var f,h=g(s);!(f=h()).done;){var d=f.value;d!==e.from&&n.add(d)}}));for(var r,i=g(n);!(r=i()).done;)r.value.postMessage(e)},n.opt=function(e){if(e.peers)for(var t,n=g(e.peers);!(t=n()).done;){var r=t.value;r&&this.serverPeers.add(new q(r,this))}},n.handleGet=function(e){for(var t,n=e.nodeId.split("/")[1],r=new Set,i=g(this.storageAdapters);!(t=i()).done;){var a=t.value;e.from!==a&&r.add(a)}for(var s,o=g(this.serverPeers);!(s=o()).done;){var u=s.value;e.from!==u&&r.add(u)}this.subscribersByTopic.has(n)||this.subscribersByTopic.set(n,new Set);var c=this.subscribersByTopic.get(n);c&&(c.has(e.from)||c.add(e.from));for(var l,p=g(r);!(l=p()).done;)l.value.postMessage(e)},t}(E),R={allowPublicSpace:!1,enableStats:!0,localOnly:!0},F=function(e){function t(t,n,r){var i;return void 0===t&&(t=""),(i=e.call(this,t)||this).children=new Map,i.once_subscriptions=new Map,i.on_subscriptions=new Map,i.map_subscriptions=new Map,i.counter=0,i.doCallbacks=function(e,t){"string"==typeof e.value&&e.value.startsWith('{":":')&&(e.value=JSON.parse(e.value)[":"]);for(var n,r=function(){var r=n.value,a=r[0];(0,r[1])(e.value,t,null,{off:function(){return i.on_subscriptions.delete(a)}})},a=g(i.on_subscriptions);!(n=a()).done;)r();for(var s,o=g(i.once_subscriptions);!(s=o()).done;){var u=s.value,c=u[0];(0,u[1])(e.value,t,null,{}),i.once_subscriptions.delete(c)}i.parent&&function(){for(var n,r=i.parent,a=function(){var i=n.value,a=i[0];(0,i[1])(e.value,t,null,{off:function(){return r.map_subscriptions.delete(a)}})},s=g(r.map_subscriptions);!(n=s()).done;)a()}()},i.parent=r,i.config=n||r&&r.config||R,r?(i.root=r.root,i.router=r.router):(i.root=h(i),i.router=new J({dbName:i.id+"-idb",peers:i.config.webSocketPeers})),i}o(t,e);var n=t.prototype;return n.getCurrentUser=function(){return this.root.currentUser},n.setCurrentUser=function(e){this.root.currentUser=e},n.handle=function(e){if(e instanceof N){for(var t=0,n=Object.entries(e.updatedNodes);t<n.length;t++){var r=n[t],i=r[1];if(i&&"object"==typeof i&&r[0]===this.id)for(var a=0,s=Object.entries(i);a<s.length;a++){var o=s[a],u=o[0],c=o[1];this.get(u).doCallbacks(c,u)}}this.parent&&this.parent.handle(e)}},n.get=function(e){var n=this.children.get(e);if(n)return n;var r=new t(this.id+"/"+e,this.config,this);return this.children.set(e,r),r},n.user=function(e){if(!(e=e||this.root.currentUser&&this.root.currentUser.pub))throw new Error("no public key!");return this.get("user").get(e)},n.auth=function(e){this.root.setCurrentUser(e)},n.put=function(){var e=s(i().mark((function e(t){var n,r,a,s;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=Date.now(),!Array.isArray(t)){e.next=3;break}throw new Error("put() does not support arrays");case 3:if("function"!=typeof t){e.next=5;break}throw new Error("put() does not support functions");case 5:if("object"!=typeof t||null===t){e.next=8;break}for(r in t)this.get(r).put(t[r]);return e.abrupt("return");case 8:return e.next=10,this.signIfNeeded(t);case 10:return t=e.sent,this.children=new Map,a={},e.next=15,this.addParentNodes(a,t,n);case 15:s=N.new(a,this),this.handle(s),this.router.postMessage(s);case 18:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.signIfNeeded=function(){var e=s(i().mark((function e(t){var n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==this.id.indexOf("global/user/")){e.next=10;break}if(this.getCurrentUser()){e.next=3;break}throw new Error("not authenticated");case 3:if(0===this.id.indexOf("global/user/"+this.getCurrentUser().pub)){e.next=5;break}throw new Error("not allowed "+this.id);case 5:return e.next=7,O.sign(t,this.getCurrentUser(),void 0,{raw:!0});case 7:n=e.sent,t=JSON.stringify({":":n.m,"~":n.s}),console.log("saving signed value",t);case 10:return e.abrupt("return",t);case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.addParentNodes=function(){var e=s(i().mark((function e(t,n,r){var a,s;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.parent){e.next=7;break}return a=this.id.split("/").pop(),t[s=this.parent.id]=t[s]||{},t[s][a]={value:n,updatedAt:r},e.next=7,this.parent.addParentNodes(t,{"#":this.parent.id},r);case 7:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}(),n.request=function(){if(this.parent){var e=this.id.split("/").pop();this.router.postMessage(D.new(this.parent.id,this,void 0,e))}},n.once=function(){var e=s(i().mark((function e(t){var n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=this.counter++,t&&this.once_subscriptions.set(n,t),this.request();case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.on=function(e){var t=this.counter++;this.on_subscriptions.set(t,e),this.request()},n.map=function(e){var t=this.counter++;this.map_subscriptions.set(t,e),this.router.postMessage(D.new(this.id,this,void 0))},n.opt=function(e){this.router.opt(e)},t}(E);function H(e){if(void 0===e&&(e={}),!K){I.init();var t=e.peers||I.random();console.log("webSocketPeers",t);var n=Object.assign({webSocketPeers:t,localStorage:!1,retry:Infinity},e);e.peers&&(console.log("adding peers",e.peers),e.peers.forEach((function(e){return I.add({url:e})}))),K=new F("global",n)}return K}var W={email:/^([\w-]+(?:\.[\w-]+)*)@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$/i,bitcoin:/^[13][a-km-zA-HJ-NP-Z0-9]{26,33}$/,bitcoin_address:/^[13][a-km-zA-HJ-NP-Z0-9]{26,33}$/,ip:/^(([1-9]?\d|1\d\d|2[0-5][0-5]|2[0-4]\d)\.){3}([1-9]?\d|1\d\d|2[0-5][0-5]|2[0-4]\d)$/,ipv6:/^(?:[A-F0-9]{1,4}:){7}[A-F0-9]{1,4}$/,gpg_fingerprint:null,gpg_keyid:null,google_oauth2:null,tel:/^\d{7,}$/,phone:/^\d{7,}$/,keyID:null,url:/[-a-zA-Z0-9@:%_\+.~#?&//=]{2,256}\.[a-z]{2,4}\b(\/[-a-zA-Z0-9@:%_\+.~#?&//=]*)?/gi,account:/^([\w-]+(?:\.[\w-]+)*)@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$/i,uuid:/[0-9a-f]{8}\-[0-9a-f]{4}\-[0-9a-f]{4}\-[0-9a-f]{4}\-[0-9a-f]{12}/},B=function(){function e(t,n){if("object"==typeof t){if("string"!=typeof t.value)throw new Error("param1.value must be a string, got "+typeof t.value+": "+JSON.stringify(t.value));if("string"!=typeof t.type)throw new Error("param1.type must be a string, got "+typeof t.type+": "+JSON.stringify(t.type));n=t.value,t=t.type}if("string"!=typeof t)throw new Error("First param must be a string, got "+typeof t+": "+JSON.stringify(t));if(!t.length)throw new Error("First param string is empty");if(n){if("string"!=typeof n)throw new Error("Second parameter must be a string, got "+typeof n+": "+JSON.stringify(n));if(!n.length)throw new Error("Second param string is empty");this.type=t,this.value=n}else{this.value=t;var r=e.guessTypeOf(this.value);if(!r)throw new Error("Type of attribute was omitted and could not be guessed");this.type=r}}e.getUuid=function(){return new e("uuid",function e(t){return t?(t^16*Math.random()>>t/4).toString(16):([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,e)}())},e.getUniqueIdValidators=function(){return W},e.isUniqueType=function(e){return Object.keys(W).indexOf(e)>-1};var t=e.prototype;return t.isUniqueType=function(){return e.isUniqueType(this.type)},e.guessTypeOf=function(e){for(var t in W)if(e.match(W[t]))return t},e.equals=function(e,t){return e.equals(t)},t.equals=function(e){return e&&this.type===e.type&&this.value===e.value},t.uri=function(){return encodeURIComponent(this.value)+":"+encodeURIComponent(this.type)},e}();function Q(e){if(void 0===e&&(e=Je.getKey()),"string"==typeof e)return H().user(e);if("object"==typeof e){var t=H().user(e.pub);return t.auth(e),t}}var Y,$={read:!0,write:!0,admin:!1},Z=function(){function e(e){var t=this;if(this.theirSecretUuids={},this.theirGroupSecrets={},this.secrets={},this.ourSecretChannelIds={},this.theirSecretChannelIds={},this.messages={},this.chatLinks={},this.groupSubscriptions={},this.directSubscriptions={},this.getParticipantsCallbacks={},this.myGroupSecret=e.myGroupSecret,e.chatLink&&this.useChatLink(e),"string"==typeof e.participants)this.addParticipant(e.participants,e.save);else if(Array.isArray(e.participants)){var n={};e.participants.forEach((function(e){return n[e]=Object.assign({},$)})),e.participants=n}"object"==typeof e.participants&&(Object.keys(e.participants).forEach((function(n){n!==Je.getKey().pub&&t.addParticipant(n,e.save,Object.assign({},$,e.participants[n]))})),e.participants[Je.getKey().pub]=e.participants[Je.getKey().pub]||Object.assign({},$),e.uuid?(this.uuid=e.uuid,this.name=e.name):(e.uuid=B.getUuid().value,this.uuid=e.uuid,e.participants[Je.getKey().pub].admin=!0,e.participants[Je.getKey().pub].founder=!0),this.getChatLinks({subscribe:!0})),this.participants=e.participants,e.uuid&&(this.putDirect("S"+this.uuid,this.getMyGroupSecret()),this.getMySecretUuid().then((function(e){t.putDirect(t.uuid,e)})),this.onTheirDirect(this.uuid,(function(e,n,r){t.theirSecretUuids[r]=e})),this.onTheirDirect("S"+this.uuid,(function(e,n,r){t.theirGroupSecrets[r]=e}))),this.onTheir("participants",(function(n,r,i){for(var a=!1,s=Object.keys(t.participants),o=0;o<s.length;o++)if(t.participants[s[o]].admin||t.participants[s[o]].inviter){a=!0;break}if(a||s.forEach((function(e){return t.participants[e].admin=!0})),t.participants[i]&&(t.participants[i].admin||t.participants[i].inviter)&&"object"==typeof n){if(JSON.stringify(t.participants)===JSON.stringify(n))return;t.participants=n,delete t.participants[i].inviter,Object.keys(n).forEach((function(e){e!==Je.getKey().pub&&t.addParticipant(e,!0,Object.assign({},$,n[e]),!0)})),t.participantsChanged(),e.saved=!0}})),e.saved||void 0!==e.save&&!0!==e.save||this.save()}var t=e.prototype;return t.useChatLink=function(e){var t=e.chatLink.split("?");if(2===t.length){var n=S.getUrlParameter("chatWith",t[1]),r=S.getUrlParameter("channelId",t[1]),a=S.getUrlParameter("inviter",t[1]),o=a||n;if(n?e.participants=o:r&&a&&a!==Je.getKey().pub&&(e.uuid=r,e.participants={},e.participants[a]=Object.assign({inviter:!0},$)),o!==Je.getKey().pub){var u=S.getUrlParameter("s",t[1]),c=S.getUrlParameter("k",t[1]);u&&c&&(this.save(),e.saved=!0,H().user(o).get("chatLinks").get(c).get("encryptedSharedKey").on(function(){var e=s(i().mark((function e(t){var n,r,a;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.decrypt(t,u);case 2:return n=e.sent,e.next=5,O.encrypt(Je.getKey().pub,u);case 5:return r=e.sent,e.next=8,S.getHash(r);case 8:a=e.sent,H(n).get("chatRequests").get(a.slice(0,12)).put(r);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()))}}},t.getTheirSecretUuid=function(e){var t=this;return new Promise((function(n){t.theirSecretUuids[e]?n(t.theirSecretUuids[e]):t.onTheirDirect(t.uuid,(function(r){t.theirSecretUuids[e]=r,n(t.theirSecretUuids[e])}),e)}))},t.getTheirGroupSecret=function(e){var t=this;return e===Je.getKey().pub?this.getMyGroupSecret():new Promise((function(n){t.theirGroupSecrets[e]?n(t.theirGroupSecrets[e]):t.onTheirDirect("S"+t.uuid,(function(r){t.theirGroupSecrets[e]=r,n(t.theirGroupSecrets[e])}),e)}))},t.changeMyGroupSecret=function(){this.myGroupSecret=O.random(32).toString("base64"),this.putDirect("S"+this.uuid,this.myGroupSecret)},t.mute=function(){var e=s(i().mark((function e(t){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:H().user(t).get(this.theirSecretUuids[t]).off();case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.block=function(){var e=s(i().mark((function e(t){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.mute(t),this.putDirect(this.uuid,null),this.putDirect("S"+this.uuid,null),delete this.secrets[t],delete this.ourSecretChannelIds[t],delete this.theirSecretChannelIds[t],this.changeMyGroupSecret();case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.getMySecretUuid=function(){var e=s(i().mark((function e(){var t,n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.mySecretUuid){e.next=10;break}return e.next=3,O.secret(Je.getKey().epub,Je.getKey());case 3:return t=e.sent,e.next=6,S.getHash(t);case 6:return n=e.sent,e.next=9,S.getHash(n+this.uuid);case 9:this.mySecretUuid=e.sent;case 10:return e.abrupt("return",this.mySecretUuid);case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.getCurrentParticipants=function(){return Object.keys(this.secrets)},t.getParticipants=function(e){this.getParticipantsCallbackId?this.getParticipantsCallbackId++:this.getParticipantsCallbackId=1,this.getParticipantsCallbacks[this.getParticipantsCallbackId]=e,this.participants&&e(this.participants)},t.participantsChanged=function(){var e=this;Object.keys(this.getParticipantsCallbacks).forEach((function(t){e.getParticipantsCallbacks[t](e.participants)}))},t.getId=function(){return this.uuid||this.getCurrentParticipants()[0]},t.getSecret=function(){var e=s(i().mark((function e(t){var n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.secrets[t]){e.next=7;break}return e.next=3,S.gunOnceDefined(H().user(t).get("epub"));case 3:return n=e.sent,e.next=6,O.secret(n,Je.getKey());case 6:this.secrets[t]=e.sent;case 7:return e.abrupt("return",this.secrets[t]);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),e.getOurSecretChannelId=function(){var e=s(i().mark((function e(t,n){var r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S.gunOnceDefined(H().user(t).get("epub"));case 2:return r=e.sent,e.next=5,O.secret(r,n);case 5:return e.abrupt("return",S.getHash(e.sent+t));case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),e.getTheirSecretChannelId=function(){var e=s(i().mark((function e(t,n){var r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S.gunOnceDefined(H().user(t).get("epub"));case 2:return r=e.sent,e.next=5,O.secret(r,n);case 5:return e.abrupt("return",S.getHash(e.sent+n.pub));case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),e.getChannels=function(){var t=s(i().mark((function t(n,r){var a,o,u,c;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return void 0===r&&(r=!0),a=Je.getKey(),t.next=4,O.secret(a.epub,a);case 4:o=t.sent,r&&e.getMyChatLinks(void 0,void 0,!0),u={},c=function(){var t=s(i().mark((function t(r,s){var c,l;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!r||u[s]){t.next=14;break}if(u[s]=!0,!(s.length>44)){t.next=5;break}return H().user().get("chats").get(s).put(null),t.abrupt("return");case 5:return t.next=7,S.gunOnceDefined(H().user().get("chats").get(s).get("pub"));case 7:return c=t.sent,t.next=10,O.decrypt(c,o);case 10:if(l=t.sent){t.next=13;break}return t.abrupt("return");case 13:l.pub||"string"==typeof l?n(new e({key:a,participants:l.pub||l,save:!1})):l.uuid&&l.participants&&l.myGroupSecret&&n(new e({key:a,participants:l.participants,uuid:l.uuid,myGroupSecret:l.myGroupSecret,save:!1}));case 14:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),H().user().get("chats").map(c);case 9:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),t.getMyGroupSecret=function(){return this.myGroupSecret||this.changeMyGroupSecret(),this.myGroupSecret},t.getOurSecretChannelId=function(){var e=s(i().mark((function e(t){var n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.ourSecretChannelIds[t]){e.next=7;break}return e.next=3,this.getSecret(t);case 3:return n=e.sent,e.next=6,S.getHash(n+t);case 6:this.ourSecretChannelIds[t]=e.sent;case 7:return e.abrupt("return",this.ourSecretChannelIds[t]);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.getTheirSecretChannelId=function(){var e=s(i().mark((function e(t){var n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.theirSecretChannelIds[t]){e.next=7;break}return e.next=3,this.getSecret(t);case 3:return n=e.sent,e.next=6,S.getHash(n+Je.getKey().pub);case 6:this.theirSecretChannelIds[t]=e.sent;case 7:return e.abrupt("return",this.theirSecretChannelIds[t]);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.getMessages=function(){var e=s(i().mark((function e(t){var n,r=this;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.getCurrentParticipants().forEach(function(){var e=s(i().mark((function e(n){var a,s;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n===Je.getKey().pub){e.next=11;break}if(!r.uuid){e.next=7;break}return e.next=4,r.getTheirSecretUuid(n);case 4:a=e.sent,e.next=10;break;case 7:return e.next=9,r.getTheirSecretChannelId(n);case 9:a=e.sent;case 10:H().user(n).get("chats").get(a).get("msgs").map((function(e,i){r.messageReceived(t,e,r.uuid||n,!1,i,n)}));case 11:if(r.uuid){e.next=16;break}return e.next=14,r.getOurSecretChannelId(n);case 14:s=e.sent,Q().get("chats").get(s).get("msgs").map((function(e,i){r.messageReceived(t,e,n,!0,i,Je.getKey().pub)}));case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),!this.uuid){e.next=6;break}return e.next=4,this.getMySecretUuid();case 4:n=e.sent,Q().get("chats").get(n).get("msgs").map((function(e,n){r.messageReceived(t,e,r.uuid,!0,n,Je.getKey().pub)}));case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.messageReceived=function(){var e=s(i().mark((function e(t,n,r,a,s,o){var u,c,l;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.messages[s]&&n){e.next=2;break}return e.abrupt("return");case 2:if(!this.uuid){e.next=8;break}return e.next=5,this.getTheirGroupSecret(o);case 5:e.t0=e.sent,e.next=11;break;case 8:return e.next=10,this.getSecret(r);case 10:e.t0=e.sent;case 11:return u=e.t0,e.next=14,O.decrypt(n,u);case 14:if("object"==typeof(c=e.sent)){e.next=17;break}return e.abrupt("return");case 17:l={selfAuthored:a,channelId:r,from:o},this.messages[s]=c,t(c,l);case 20:case"end":return e.stop()}}),e,this)})));return function(t,n,r,i,a,s){return e.apply(this,arguments)}}(),t.getLatestMsg=function(){var e=s(i().mark((function e(t){var n,r=this;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=function(){var e=s(i().mark((function e(n,a){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r.latest?("string"==typeof r.latest.time?r.latest.time:r.latest.time.toISOString())<n.time&&(r.latest=n,t(n,a)):(r.latest=n,t(n,a));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),this.onMy("latestMsg",(function(e){return n(e,{selfAuthored:!0,from:Je.getKey().pub})})),this.onTheir("latestMsg",(function(e,t,r){return n(e,{selfAuthored:!1,from:r})}));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.setMyMsgsLastSeenTime=function(){var e=s(i().mark((function e(t){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=t||(new Date).toISOString(),e.abrupt("return",this.put("msgsLastSeenTime",t));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.getMyMsgsLastSeenTime=function(){var e=s(i().mark((function e(t){var n=this;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.onMy("msgsLastSeenTime",(function(e){n.myMsgsLastSeenTime=e,t&&t(n.myMsgsLastSeenTime)}));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.getTheirMsgsLastSeenTime=function(){var e=s(i().mark((function e(t){var n=this;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.onTheir("msgsLastSeenTime",(function(e){n.theirMsgsLastSeenTime=e,t&&t(n.theirMsgsLastSeenTime)}));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.removeParticipant=function(){var e=s(i().mark((function e(t){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.addParticipant(t,!0,{read:!1,write:!1});case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.addParticipant=function(){var e=s(i().mark((function e(t,n,r,a){var s,o,u=this;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===n&&(n=!0),!this.uuid){e.next=3;break}return e.abrupt("return");case 3:if(void 0===r&&(r=$),!this.secrets[t]||JSON.stringify(this.secrets[t])!==JSON.stringify(r)){e.next=6;break}return e.abrupt("return");case 6:return this.secrets[t]=null,this.getSecret(t),e.next=10,this.getOurSecretChannelId(t);case 10:if(s=e.sent,!n){e.next=20;break}return e.next=14,O.secret(Je.getKey().epub,Je.getKey());case 14:return o=e.sent,e.t0=H().user().get("chats").get(s).get("pub"),e.next=18,O.encrypt({pub:t},o);case 18:e.t1=e.sent,e.t0.put.call(e.t0,e.t1);case 20:this.uuid&&(this.participants[t]=r,n&&(this.putDirect("S"+this.uuid,this.getMyGroupSecret()),this.getMySecretUuid().then((function(e){u.putDirect(u.uuid,e)})),this.onTheirDirect(this.uuid,(function(e,t,n){u.theirSecretUuids[n]=e})),this.onTheirDirect("S"+this.uuid,(function(e,t,n){u.theirGroupSecrets[n]=e})),this.save())),a&&(Object.values(this.directSubscriptions).forEach((function(e){e.forEach((function(e){e.from&&e.from!==t||u._onTheirDirectFromUser(t,e.key,e.callback)}))})),Object.values(this.groupSubscriptions).forEach((function(e){e.forEach((function(e){e.from&&e.from!==t||(r.write?u._onTheirGroupFromUser(t,e.key,e.callback):e.event&&e.event.off())}))})));case 22:case"end":return e.stop()}}),e,this)})));return function(t,n,r,i){return e.apply(this,arguments)}}(),t.send=function(){var e=s(i().mark((function e(t){var n,r,a,s,o,u;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t){e.next=7;break}if(0!==(t=t.trim()).length){e.next=4;break}return e.abrupt("return");case 4:t={time:(new Date).toISOString(),text:t},e.next=12;break;case 7:if("object"!=typeof t){e.next=11;break}t.time=t.time||(new Date).toISOString(),e.next=12;break;case 11:throw new Error("msg param must be a string or an object");case 12:if(!this.uuid){e.next=23;break}return e.next=15,O.encrypt(JSON.stringify(t),this.getMyGroupSecret());case 15:return n=e.sent,e.next=18,this.getMySecretUuid();case 18:r=e.sent,Q().get("chats").get(r).get("msgs").get(""+t.time).put(n),Q().get("chats").get(r).get("latestMsg").put(n),e.next=42;break;case 23:a=this.getCurrentParticipants(),s=0;case 25:if(!(s<a.length)){e.next=42;break}return e.t0=O,e.t1=JSON.stringify(t),e.next=30,this.getSecret(a[s]);case 30:return e.t2=e.sent,e.next=33,e.t0.encrypt.call(e.t0,e.t1,e.t2);case 33:return o=e.sent,e.next=36,this.getOurSecretChannelId(a[s]);case 36:u=e.sent,Q().get("chats").get(u).get("msgs").get(""+t.time).put(o),Q().get("chats").get(u).get("latestMsg").put(o);case 39:s++,e.next=25;break;case 42:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.save=function(){var e=s(i().mark((function e(){var t,n,r,a,s;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.uuid){e.next=17;break}return e.next=3,this.getMySecretUuid();case 3:return t=e.sent,Q().get("chats").get(t).get("msgs").get("a").put(null),this.put("participants",this.participants),e.next=8,O.secret(Je.getKey().epub,Je.getKey());case 8:return n=e.sent,e.t0=Q().get("chats").get(t).get("pub"),e.next=12,O.encrypt({uuid:this.uuid,myGroupSecret:this.getMyGroupSecret(),participants:this.participants},n);case 12:e.t1=e.sent,e.t0.put.call(e.t0,e.t1),this.participantsChanged(),e.next=27;break;case 17:r=this.getCurrentParticipants(),a=0;case 19:if(!(a<r.length)){e.next=27;break}return e.next=22,this.getOurSecretChannelId(r[a]);case 22:s=e.sent,Q().get("chats").get(s).get("msgs").get("a").put(null);case 24:a++,e.next=19;break;case 27:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.put=function(){var e=s(i().mark((function e(t,n){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(this.uuid?this.putGroup:this.putDirect).call(this,t,n));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),t.putGroup=function(){var e=s(i().mark((function e(t,n){var r,a;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("msgs"!==t){e.next=2;break}throw new Error("Sorry, you can't overwrite the msgs field which is used for .send()");case 2:return e.next=4,O.encrypt(JSON.stringify(n),this.getMyGroupSecret());case 4:return r=e.sent,e.next=7,this.getMySecretUuid();case 7:a=e.sent,Q().get("chats").get(a).get(t).put(r);case 9:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),t.putDirect=function(){var e=s(i().mark((function e(t,n){var r,a,s,o;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("msgs"!==t){e.next=2;break}throw new Error("Sorry, you can't overwrite the msgs field which is used for .send()");case 2:r=this.getCurrentParticipants(),a=0;case 4:if(!(a<r.length)){e.next=20;break}return e.t0=O,e.t1=JSON.stringify(n),e.next=9,this.getSecret(r[a]);case 9:return e.t2=e.sent,e.next=12,e.t0.encrypt.call(e.t0,e.t1,e.t2);case 12:return s=e.sent,e.next=15,this.getOurSecretChannelId(r[a]);case 15:o=e.sent,Q().get("chats").get(o).get(t).put(s);case 17:a++,e.next=4;break;case 20:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),t.on=function(){var e=s(i().mark((function e(t,n,r){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(this.uuid?this.onGroup:this.onDirect).call(this,t,n,r));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}(),t.onDirect=function(){var e=s(i().mark((function e(t,n,r){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r&&"me"!==r&&r!==Je.getKey().pub||this.onMy(t,(function(e){return n(e,Je.getKey().pub)})),(!r||"me"!==r&&r!==Je.getKey().pub)&&this.onTheir(t,(function(e,t,r){return n(e,r)}));case 2:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}(),t.onGroup=function(){var e=s(i().mark((function e(t,n,r){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r&&"me"!==r&&r!==Je.getKey().pub||this.onMyGroup(t,(function(e){return n(e,Je.getKey().pub)})),(!r||"me"!==r&&r!==Je.getKey().pub)&&this.onTheirGroup(t,(function(e,t,r){return n(e,r)}));case 2:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}(),t.onMy=function(){var e=s(i().mark((function e(t,n){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(this.uuid?this.onMyGroup:this.onMyDirect).call(this,t,n));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),t.onMyDirect=function(){var e=s(i().mark((function e(t,n){var r,a,o,u=this;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("function"==typeof n){e.next=2;break}throw new Error("onMy callback must be a function, got "+typeof n);case 2:r=this.getCurrentParticipants(),a=i().mark((function e(a){var o;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.getOurSecretChannelId(r[a]);case 2:return o=e.sent,H().user().get("chats").get(o).get(t).on(function(){var e=s(i().mark((function e(s){var o;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=O,e.t1=s,e.next=4,u.getSecret(r[a]);case 4:return e.t2=e.sent,e.next=7,e.t0.decrypt.call(e.t0,e.t1,e.t2);case 7:(o=e.sent)&&n(void 0!==o.v?o.v:o,t);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.abrupt("return","break");case 5:case"end":return e.stop()}}),e)})),o=0;case 5:if(!(o<r.length)){e.next=13;break}return e.delegateYield(a(o),"t0",7);case 7:if("break"!==e.t0){e.next=10;break}return e.abrupt("break",13);case 10:o++,e.next=5;break;case 13:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),t.onMyGroup=function(){var e=s(i().mark((function e(t,n){var r,a;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("function"==typeof n){e.next=2;break}throw new Error("onMy callback must be a function, got "+typeof n);case 2:return e.next=4,this.getMySecretUuid();case 4:return r=e.sent,e.next=7,this.getMyGroupSecret();case 7:a=e.sent,H().user().get("chats").get(r).get(t).on(function(){var e=s(i().mark((function e(r){var s;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.decrypt(r,a);case 2:(s=e.sent)&&n(void 0!==s.v?s.v:s,t,Je.getKey().pub);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 9:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),t.onTheir=function(){var e=s(i().mark((function e(t,n,r){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(this.uuid?this.onTheirGroup:this.onTheirDirect).call(this,t,n,r));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}(),t._onTheirDirectFromUser=function(){var e=s(i().mark((function e(t,n,r){var a,o=this;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.hasWritePermission(r)){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.getTheirSecretChannelId(r);case 4:a=e.sent,H().user(r).get("chats").get(a).get(t).on(function(){var e=s(i().mark((function e(a){var s;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o.hasWritePermission(r)){e.next=2;break}return e.abrupt("return");case 2:return e.t0=O,e.t1=a,e.next=6,o.getSecret(r);case 6:return e.t2=e.sent,e.next=9,e.t0.decrypt.call(e.t0,e.t1,e.t2);case 9:(s=e.sent)&&n(void 0!==s.v?s.v:s,t,r);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 6:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}(),t.onTheirDirect=function(){var e=s(i().mark((function e(t,n,r){var a=this;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("function"==typeof n){e.next=2;break}throw new Error("onTheir callback must be a function, got "+typeof n);case 2:Object.prototype.hasOwnProperty.call(this.directSubscriptions,t)||(this.directSubscriptions[t]=[]),this.directSubscriptions[t].push({key:t,callback:n,from:r}),this.getCurrentParticipants().forEach(function(){var e=s(i().mark((function e(s){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r||s===r){e.next=2;break}return e.abrupt("return");case 2:a._onTheirDirectFromUser(s,t,n);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 6:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}(),t.hasWritePermission=function(e){return!this.uuid||this.participants&&this.participants[e]&&this.participants[e].write},t._onTheirGroupFromUser=function(){var e=s(i().mark((function e(t,n,r,a){var o,u=this;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.hasWritePermission(t)){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.getTheirSecretUuid(t);case 4:o=e.sent,H().user(t).get("chats").get(o).get(n).on(function(){var e=s(i().mark((function e(s,o,c,l){var p;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a&&(a.event=l),u.hasWritePermission(t)){e.next=3;break}return e.abrupt("return");case 3:return e.t0=O,e.t1=s,e.next=7,u.getTheirGroupSecret(t);case 7:return e.t2=e.sent,e.next=10,e.t0.decrypt.call(e.t0,e.t1,e.t2);case 10:(p=e.sent)&&r(void 0!==p.v?p.v:p,n,t);case 12:case"end":return e.stop()}}),e)})));return function(t,n,r,i){return e.apply(this,arguments)}}());case 6:case"end":return e.stop()}}),e,this)})));return function(t,n,r,i){return e.apply(this,arguments)}}(),t.onTheirGroup=function(){var e=s(i().mark((function e(t,n,r){var a,o=this;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("function"==typeof n){e.next=2;break}throw new Error("onTheir callback must be a function, got "+typeof n);case 2:Object.prototype.hasOwnProperty.call(this.groupSubscriptions,t)||(this.groupSubscriptions[t]=[]),this.groupSubscriptions[t].push(a={key:t,callback:n,from:r}),this.getParticipants((function(e){Object.keys(e).forEach(function(){var u=s(i().mark((function s(u){return i().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(!r||u===r){i.next=2;break}return i.abrupt("return");case 2:if(e[u]&&e[u].write){i.next=4;break}return i.abrupt("return");case 4:o._onTheirGroupFromUser(u,t,n,a);case 5:case"end":return i.stop()}}),s)})));return function(e){return u.apply(this,arguments)}}())}));case 6:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}(),t.setTyping=function(e,t){var n=this;void 0===t&&(t=5),t*=1e3,this.put("typing",(e=void 0===e||e)?(new Date).toISOString():new Date(0).toISOString()),clearTimeout(this.setTypingTimeout),this.setTypingTimeout=setTimeout((function(){return n.put("typing",!1)}),t)},t.getTyping=function(e,t){var n=this;void 0===t&&(t=5),t*=1e3,this.onTheir("typing",(function(r,i,a){if(e){var s=r&&new Date-new Date(r)<=t;e(s,a),n.getTypingTimeouts=n.getTypingTimeouts||{},clearTimeout(n.getTypingTimeouts[a]),s&&(n.getTypingTimeouts[a]=setTimeout((function(){return e(!1,a)}),t))}}))},t.getSimpleLink=function(e){return void 0===e&&(e="https://iris.to/"),this.uuid?e+"?channelId="+this.uuid+"&inviter="+Je.getKey().pub:e+"?chatWith="+this.getCurrentParticipants()[0]},t.getChatLinks=function(){var t=s(i().mark((function t(n){var r,a,o,u,c,l,p=this;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0===n&&(n={}),a=(r=n).callback,u=r.subscribe,o=(o=r.urlRoot)||"https://iris.to/",this.uuid){t.next=5;break}throw new Error("Only group channels may have chat links");case 5:c=[],l={},this.on("chatLinks",(function(t,n){t&&"object"==typeof t&&Object.keys(t).forEach((function(r){var f=t[r];if(null===f)return l[r]&&l[r].off(),delete l[r],void(a&&a({id:r,url:null}));if(-1===c.indexOf(r)){var h=[];c.push(r);var d=e.formatChatLink({urlRoot:o,inviter:n,channelId:p.uuid,sharedSecret:f.sharedSecret,linkId:r});a&&a({url:d,id:r}),u&&H().user(f.sharedKey.pub).get("chatRequests").map(function(){var e=s(i().mark((function e(t,n,a,s){var o;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&"string"==typeof t&&!(t.length<10)){e.next=2;break}return e.abrupt("return");case 2:if(l[r]=s,o=JSON.stringify(t),-1!==h.indexOf(o)){e.next=10;break}return h.push(o),e.next=8,O.decrypt(t,f.sharedSecret);case 8:p.addParticipant(e.sent,void 0,void 0,!0);case 10:case"end":return e.stop()}}),e)})));return function(t,n,r,i){return e.apply(this,arguments)}}())}}))}));case 8:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),t.createChatLink=function(){var t=s(i().mark((function t(n){var r,a,s,o,u,c,l;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return void 0===n&&(n="https://iris.to/"),t.next=3,O.generate();case 3:return r=t.sent,a=JSON.stringify(r),t.next=7,O.secret(r.epub,r);case 7:return s=t.sent,t.next=10,O.encrypt(a,s);case 10:return o=t.sent,t.next=13,O.secret(Je.getKey().epub,Je.getKey());case 13:return u=t.sent,t.next=16,O.encrypt(a,u);case 16:return c=t.sent,t.next=19,S.getHash(o);case 19:return l=(l=t.sent).slice(0,12),H(r).get("chatRequests").put({a:1}),this.chatLinks[l]={sharedKey:r,sharedSecret:s},this.put("chatLinks",this.chatLinks),Q().get("chatLinks").get(l).put({encryptedSharedKey:o,ownerEncryptedSharedKey:c}),t.abrupt("return",e.formatChatLink({urlRoot:n,channelId:this.uuid,inviter:Je.getKey().pub,sharedSecret:s,linkId:l}));case 26:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),e.setActivity=function(e){if(H().irisActivityStatus!==e){H().irisActivityStatus=e,clearTimeout(H().setActivityTimeout);var t=function(){H().user().get("activity").put({status:e,time:(new Date).toISOString()})};t(),e&&function e(){t(),H().setActivityTimeout=setTimeout(e,3e3)}()}},e.getActivity=function(e,t){var n;H().user(e).get("activity").on((function(e){if(e&&e.time&&e.status){clearTimeout(n);var r=new Date,i=new Date(e.time),a=i>new Date(r.getTime()-1e4)&&i<new Date(r.getTime()+3e4);t({isActive:a,lastActive:e.time,status:e.status}),a&&(n=setTimeout((function(){return t({isOnline:!1,lastActive:e.time})}),1e4))}}))},e.formatChatLink=function(e){var t=e.urlRoot,n=e.chatWith,r=e.channelId,i=e.inviter,a=e.sharedSecret,s=e.linkId,o=encodeURIComponent;return r&&i?t+"?channelId="+o(r)+"&inviter="+o(i)+"&s="+o(a)+"&k="+o(s):t+"?chatWith="+o(n)+"&s="+o(a)+"&k="+o(s)},e.createChatLink=function(){var t=s(i().mark((function t(n){var r,a,s,o,u,c,l,p,f;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return void 0===n&&(n="https://iris.to/"),r=H().user(),a=Je.getKey(),t.next=5,O.generate();case 5:return s=t.sent,o=JSON.stringify(s),t.next=9,O.secret(s.epub,s);case 9:return u=t.sent,t.next=12,O.encrypt(o,u);case 12:return c=t.sent,t.next=15,O.secret(a.epub,a);case 15:return l=t.sent,t.next=18,O.encrypt(o,l);case 18:return p=t.sent,t.next=21,S.getHash(c);case 21:return f=(f=t.sent).slice(0,12),H(s).get("chatRequests").put({a:1}).get("chatRequests").put({a:1}),r.get("chatLinks").get(f).put({encryptedSharedKey:c,ownerEncryptedSharedKey:p}),t.abrupt("return",e.formatChatLink({urlRoot:n,chatWith:a.pub,sharedSecret:u,linkId:f}));case 26:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.getMyChatLinks=function(){var t=s(i().mark((function t(n,r,a){var o,u,c,l;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return void 0===n&&(n="https://iris.to/"),void 0===a&&(a=!1),o=Je.getKey(),u=H().user(),t.next=6,O.secret(o.epub,o);case 6:c=t.sent,l=[],u.get("chatLinks").map((function(t,p){if(t&&-1===l.indexOf(p)){var f=[];u.get("chatLinks").get(p).get("ownerEncryptedSharedKey").on(function(){var t=s(i().mark((function t(u){var h,d,g;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(u&&-1===l.indexOf(p)){t.next=2;break}return t.abrupt("return");case 2:return l.push(p),t.next=5,O.decrypt(u,c);case 5:return h=t.sent,t.next=8,O.secret(h.epub,h);case 8:g=e.formatChatLink({urlRoot:n,chatWith:o.pub,sharedSecret:d=t.sent,linkId:p}),r&&r({url:g,id:p}),a&&H().user(h.pub).get("chatRequests").map(function(){var t=s(i().mark((function t(n,r){var a;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n){t.next=2;break}return t.abrupt("return");case 2:if(a=JSON.stringify(n),-1!==f.indexOf(a)){t.next=10;break}return f.push(a),t.next=7,O.decrypt(n,d);case 7:new e({key:o,participants:t.sent}).save();case 10:H(h).get("chatRequests").get(r).put(null);case 11:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}());case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}}));case 9:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}(),t.removeGroupChatLink=function(e){this.chatLinks[e]=null,this.put("chatLinks",this.chatLinks),H().user().get("chatLinks").get(e).put(null)},e.removePrivateChatLink=function(e,t){H().user().auth(e),H().user().get("chatLinks").get(t).put(null)},e.deleteChannel=function(){var t=s(i().mark((function t(n,r){var a;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return H().user().auth(n),t.next=3,e.getOurSecretChannelId(r,n);case 3:a=t.sent,H().user().get("channels").get(a).put(null),H().user().get("channels").get(a).off();case 6:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),e.deleteGroup=function(){var e=s(i().mark((function e(t,n){var r,a,s;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.secret(t.epub,t);case 2:return r=e.sent,e.next=5,S.getHash(r);case 5:return a=e.sent,e.next=8,S.getHash(a+n);case 8:s=e.sent,H().user().auth(t),H().user().get("channels").get(s).put(null),H().user().get("channels").get(s).off();case 12:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),e}(),V=new Map;function X(e,t){void 0===e&&(e=Je.getKey());var n=V.get(e);return n||(n=new Z({participants:e,chatLink:t}),V.set(e,n)),n}function ee(){return Y||(Y=new F("local")),Y}var te={};function ne(){return te||(te={},ee().get("block").map((function(e,t){e!==te[t]&&(e?(te[t]=e,ee().get("groups").map((function(e,n){ee().get("groups").get(n).get(t).put(!1)}))):delete te[t])}))),te}var re=0,ie=new Map,ae=new Map;function se(e){return void 0===e&&(e="everyone"),{get:function(t,n){var r=ee().get("groups").get(e),i={};requestAnimationFrame((function(){r.map((function(e,r){if(!ne()[r]&&(!i[r]||i[r]!==e)&&(i[r]=e,e)){var a=Q(r);t&&"/"!==t&&(a=t.split("/").reduce((function(e,t){return e.get(decodeURIComponent(t))}),a)),n(a,r)}}))}))},_cached_map:function(e,t,n,r,i){if(e)for(var a,s=g(e.values());!(a=s()).done;){var o=a.value;i(o.value,o.key,0,r,o.from)}else{var u=new Map;ie.set(t,u),this.get(n,(function(e,n){return e.map((function(e,i,a){u.set(i,{value:e,key:i,from:n});for(var s,o=g(ae.get(t).values());!(s=o()).done;)(0,s.value)(e,i,a,r,n)}))}))}},_cached_on:function(e,t,n,r,i){if(e)for(var a,s=g(e.values());!(a=s()).done;){var o=a.value;i(o.value,o.key,0,r,o.from)}else{var u=new Map;ie.set(t,u),this.get(n,(function(e,n){return e.on((function(e,i,a){u.set(n,{value:e,key:i,from:n});for(var s,o=g(ae.get(t).values());!(s=o()).done;)(0,s.value)(e,i,a,r,n)}))}))}},_cached_count:function(e,t,n,r,i){if(e)i(e.size,n.split("/").pop(),null,r);else{var a=new Map;ie.set(t,a),this.get(n,(function(e,n){return e.on((function(e,i){e?a.set(n,!0):a.delete(n);for(var s,o=a.size,u=g(ae.get(t).values());!(s=u()).done;)(0,s.value)(o,i,null,r,n)}))}))}},_cached_fn:function(t,n,r){var i=t+":"+e+":"+n,a=re++;ae.has(i)?ae.get(i).set(a,r):ae.set(i,new Map([[a,r]]));var s={off:function(){var e=ae.get(i);e&&e.delete(a)}},o=ie.get(i);switch(t){case"map":this._cached_map(o,i,n,s,r);break;case"on":this._cached_on(o,i,n,s,r);break;case"count":this._cached_count(o,i,n,s,r)}},map:function(e,t){this._cached_fn("map",e,t)},on:function(e,t){this._cached_fn("on",e,t)},count:function(e,t){this._cached_fn("count",e,t)}}}var oe,ue=0,ce=0,le={};function pe(){return window.Notification&&"granted"===Notification.permission}var fe="BMqSvZArOIdn7vGkYplSpkZ70-Qt8nhYbey26WVa3LF3SwzblSzm3n3HHycpNkAKVq7MCkrzFuTFs_en7Y_J2MI";function he(e){for(var t=(e+"=".repeat((4-e.length%4)%4)).replace(/-/g,"+").replace(/_/g,"/"),n=window.atob(t),r=new Uint8Array(n.length),i=0;i<n.length;++i)r[i]=n.charCodeAt(i);return r}function de(e){return ge.apply(this,arguments)}function ge(){return(ge=s(i().mark((function e(t){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:he(fe)});case 3:me(e.sent),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error("web push subscription error",e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}function ve(){return(ve=s(i().mark((function e(){var t,n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("subscribing to web push",navigator.serviceWorker),pe()&&navigator.serviceWorker){e.next=3;break}return e.abrupt("return",!1);case 3:return e.next=5,navigator.serviceWorker.ready;case 5:return e.next=7,navigator.serviceWorker.getRegistration();case 7:return(t=e.sent).active.postMessage({key:Je.getKey()}),e.next=11,t.pushManager.getSubscription();case 11:(n=e.sent)?me(n):de(t);case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var ye=v.debounce((function(){var e=Object.values(le);Je.channelIds.forEach((function(t){X(t).put("webPushSubscriptions",e)}))}),5e3);function me(e,t){return be.apply(this,arguments)}function be(){return(be=s(i().mark((function e(t,n){var r,a,s,o;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===n&&(n=!0),r=Je.getKey(),e.next=4,O.secret(r.epub,r);case 4:return a=e.sent,e.next=7,O.encrypt(t,a);case 7:return s=e.sent,e.next=10,S.getHash(JSON.stringify(t));case 10:o=e.sent,n&&H().user().get("webPushSubscriptions").get(o).put(s),le[o]=t,ye();case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function we(){return(we=s(i().mark((function e(){var t,n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Je.getKey(),e.next=3,O.secret(t.epub,t);case 3:n=e.sent,H().user().get("webPushSubscriptions").map(function(){var e=s(i().mark((function e(t){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,O.decrypt(t,n);case 4:me(e.sent,!1);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ke(e){return new Promise((function(t){H().user(e).get("epub").on(function(){var e=s(i().mark((function e(n,r,a,s){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n&&(s.off(),t(n));case 1:case"end":return e.stop()}}),e)})));return function(t,n,r,i){return e.apply(this,arguments)}}())}))}function xe(e){return Se.apply(this,arguments)}function Se(){return(Se=s(i().mark((function e(t){var n,r,a;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,H().user(t.from).get("profile").once();case 2:return r=(n=e.sent)&&n.name||"someone",e.abrupt("return","like"===(a=t.event||t.action)?r+" liked your post":"reply"===a?r+" replied to your post":"mention"===a?r+" mentioned you in their post":"follow"===a?r+" started following you":r+" sent you a notification: "+a);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Oe(e){e?(ce+=e,ce=Math.max(ce,0)):(ce=0,H().user().get("notificationsSeenTime").put((new Date).toISOString())),ee().get("unseenNotificationCount").put(ce)}function Te(){return(Te=s(i().mark((function e(t,n){var r,a,s;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&n){e.next=2;break}return e.abrupt("return");case 2:return"object"==typeof n&&(n.time=(new Date).toISOString()),e.next=5,ke(t);case 5:return r=e.sent,e.next=8,O.secret(r,Je.getKey());case 8:return a=e.sent,e.next=11,O.encrypt(n,a);case 11:s=e.sent,H().user().get("notifications").get(t).put(s);case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Me(){return(Me=s(i().mark((function e(t,n){var r,a,s;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("sending web push notification to",t,n),r=X(t),a=Je.getKey(),t!==a.pub&&r.activity&&r.activity.isActive||!r.webPushSubscriptions){e.next=9;break}return e.delegateYield(i().mark((function e(){var t,s,o,u;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=[],s=Object.keys(r.webPushSubscriptions),o=i().mark((function e(o){var u,c,l;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u=s[o],e.next=3,r.getSecret(u);case 3:return c=e.sent,e.next=6,O.encrypt(n.title,c);case 6:return e.t0=e.sent,e.next=9,O.encrypt(n.body,c);case 9:e.t1=e.sent,e.t2={pub:a.pub,epub:a.epub},l={title:e.t0,body:e.t1,from:e.t2},r.webPushSubscriptions[u].forEach((function(e){e&&e.endpoint&&t.push({subscription:e,payload:l})}));case 13:case"end":return e.stop()}}),e)})),u=0;case 4:if(!(u<s.length)){e.next=9;break}return e.delegateYield(o(u),"t0",6);case 6:u++,e.next=4;break;case 9:if(0!==t.length){e.next=11;break}return e.abrupt("return",{v:void 0});case 11:fetch("https://iris-notifications.herokuapp.com/notify",{method:"POST",body:JSON.stringify({subscriptions:t}),headers:{"content-type":"application/json"}}).catch((function(){}));case 12:case"end":return e.stop()}}),e)}))(),"t0",6);case 6:if("object"!=typeof(s=e.t0)){e.next=9;break}return e.abrupt("return",s.v);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var je,Ce,Pe,Ie,Ee,Ae,Le,Ke,De,Ne={init:function(){oe=new Date,ue=0},notifyMsg:function(e,t,n,r){function i(){if(e.timeObj<oe)return!1;if(t.selfAuthored)return!1;if("visible"===document.visibilityState)return!1;var r=X(n);return"nothing"!==r.notificationSetting&&!("mentions"===r.notificationSetting&&!e.text.includes(Je.getMyName()))}if(i(),pe()&&i()){var a,s,o=X(n);o.uuid?(s=o.participantProfiles[t.from].name,a=name+": "+e.text):(s="Message",a=e.text),a=S.truncateString(a,50),new Notification(s,{icon:"/assets/img/icon128.png",body:a,silent:!0}).onclick=function(){Oe(-1),r&&r(),window.focus()}}},getNotificationText:xe,sendWebPushNotification:function(e,t){return Me.apply(this,arguments)},changeUnseenNotificationCount:Oe,subscribeToIrisNotifications:function(e){var t,n;H().user().get("notificationsSeenTime").on((function(e){t=e,console.log(e)})),H().user().get("notificationsShownTime").on((function(e){return n=e}));var r=v.debounce((function(){H().user().get("notificationsShownTime").put((new Date).toISOString())}),1e3),a=new Set;se().on("notifications/"+Je.getPubKey(),function(){var o=s(i().mark((function s(o,u,c,l,p){var f,h,d,g,v;return i().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(f=p.slice(0,30)+o.slice(0,30),!a.has(f)){i.next=3;break}return i.abrupt("return");case 3:return a.add(f),i.next=6,ke(p);case 6:return h=i.sent,i.next=9,O.secret(h,Je.getKey());case 9:return d=i.sent,i.next=12,O.decrypt(o,d);case 12:if((g=i.sent)&&"object"==typeof g){i.next=15;break}return i.abrupt("return");case 15:if(r(),g.from=p,ee().get("notifications").get(g.time).put(g),(!t||t<g.time)&&Oe(1),n&&!(n<g.time)){i.next=26;break}return console.log("was new!"),i.next=23,xe(g);case 23:v=i.sent,new Notification(v,{icon:"/assets/img/icon128.png",body:v,silent:!0}).onclick=function(){e&&e(g.target?"/post/"+g.target:"/profile/"+g.from),Oe(-1),window.focus()};case 26:case"end":return i.stop()}}),s)})));return function(e,t,n,r,i){return o.apply(this,arguments)}}())},sendIrisNotification:function(e,t){return Te.apply(this,arguments)},changeChatUnseenCount:function(e,t){var n=X(e);if(n){var r=ee().get("channels").get(e);t?(ue+=t,n.unseen+=t):(ue-=n.unseen||0,n.unseen=0),r.get("unseen").put(n.unseen),ue=ue>=0?ue:0,ee().get("unseenMsgsTotal").put(ue)}},webPushSubscriptions:le,subscribeToWebPush:function(){return ve.apply(this,arguments)},getWebPushSubscriptions:function(){return we.apply(this,arguments)},removeSubscription:function(e){delete le[e],H().user().get("webPushSubscriptions").get(e).put(null),ye()}},_e=S.isElectron?new F("electron").get("state"):null,Ue={},ze=new Map,Ge="hyECQHwSo7fgr2MVfPyakvayPeixxsaAWVtZ-vbaiSc.TXIp8MnCtrnW6n2MrYquWPcc-DTmZzMBmc2yaGv9gIU",qe={electron:{openAtLogin:!0,minimizeOnClose:!0},local:{enableWebtorrent:!S.isMobile,enablePublicPeerDiscovery:!0,autoplayWebtorrent:!0,maxConnectedPeers:S.isElectron?2:1}},Je={init:function(e){var t=this;if(void 0===e&&(e={}),!De){De=!0;var n=localStorage.getItem("chatKeyPair");console.log("localStorageKey",n),n?this.login(JSON.parse(n)):!1!==e.autologin?this.loginAsNewUser(e):this.clearIndexedDB(),setTimeout((function(){ee().get("block").map((function(){t.updateSearchIndex()})),t.updateSearchIndex()})),setInterval((function(){if(t.taskQueue.length){var e=t.taskQueue.shift();e&&e()}}),10)}},DEFAULT_SETTINGS:qe,DEFAULT_FOLLOW:Ge,taskQueue:[],updateSearchIndex:v.throttle((function(){var e=Object.values(v.omit(Ue,Object.keys(ne())));Ke=new r(e,{keys:["name"],includeScore:!0,includeMatches:!0,threshold:.3}),ee().get("searchIndexUpdated").put(!0)}),2e3,{leading:!0}),saveSearchResult:v.throttle((function(e){ee().get("contacts").get(e).put({followDistance:Ue[e].followDistance,followerCount:Ue[e].followers.size})}),1e3,{leading:!0}),addFollow:function(e,t,n,r){Ue[t]?(Ue[t].followDistance>n&&(Ue[t].followDistance=n),r&&Ue[t].followers.add(r)):(Ue[t]={key:t,followDistance:n,followers:new Set(r&&[r])},this.taskQueue.push((function(){Q(t).get("profile").get("name").on((function(n){Ue[t].name=n,ee().get("contacts").get(t).get("name").put(n),e&&e(t,Ue[t])}))}))),this.saveSearchResult(t),e&&e(t,Ue[t]),this.updateSearchIndex(),this.updateNoFollows(),this.updateNoFollowers()},removeFollow:function(e,t,n){1===t&&(ee().get("contacts").get(e).put(!1),ee().get("groups").get("follows").get(e).put(!1),Ue[e]&&(Ue[e].followers.delete(n),this.updateNoFollows(),this.updateNoFollowers())),Ue[e]&&0===Ue[e].followers.size&&(delete Ue[e],ee().get("contacts").get(e).put(!1),ee().get("groups").get("everyone").get(e).put(!1))},getExtendedFollows:function(e,t,n,r){var i=this;void 0===t&&(t=je.pub),void 0===n&&(n=3),void 0===r&&(r=1);var a=ze.get(t);if(!(a&&a<=r))return ze.set(t,r),this.addFollow(e,t,r-1),Q(t).get("follow").map((function(a,s){a?(i.addFollow(e,s,r,t),r<n&&i.taskQueue.push((function(){return i.getExtendedFollows(e,s,n,r+1)}))):i.removeFollow(s,r,t)})),Ue},updateNoFollows:v.throttle((function(){var e=Object.keys(Ue).length<=1;e!==Ae&&(Ae=e,ee().get("noFollows").put(Ae))}),1e3,{leading:!0}),updateNoFollowers:v.throttle((function(){var e=!(Ue[je.pub]&&Ue[je.pub].followers.size>0);e!==Le&&(Le=e,ee().get("noFollowers").put(Le))}),1e3,{leading:!0}),getSearchIndex:function(){return Ke},setOurOnlineStatus:function(){var e=window.location.hash;Z.setActivity(Ee="active");var t=v.debounce((function(){var t=X(e&&e.replace("#/profile/","").replace("#/chat/",""));t&&!Ee&&t.setMyMsgsLastSeenTime(),Z.setActivity(Ee="active"),clearTimeout(Ie),Ie=setTimeout((function(){return Z.setActivity(Ee="online")}),3e4)}),1e3);document.addEventListener("touchmove",t),document.addEventListener("mousemove",t),document.addEventListener("keypress",t),document.addEventListener("visibilitychange",(function(){if("visible"===document.visibilityState){Z.setActivity(Ee="active");var t=location.pathname.slice(1).replace("chat/",""),n=e&&X(t);n&&(n.setMyMsgsLastSeenTime(),Ne.changeChatUnseenCount(t,0))}else Z.setActivity(Ee="online")})),t(),window.addEventListener("beforeunload",(function(){Z.setActivity(Ee=null)}))},updateGroups:function(){var e=this;this.getExtendedFollows((function(t,n){n.followDistance<=1&&ee().get("groups").get("follows").get(t).put(!0),ee().get("groups").get("everyone").get(t).put(!0),t===e.getPubKey()&&e.updateNoFollowers()}))},login:function(e){var t=this;console.log("login",e);var n=!!je;console.log("shouldRefresh",n,"key",je),je=e,localStorage.setItem("chatKeyPair",JSON.stringify(e)),Q().auth(je),Q().put({epub:je.epub}),Ne.subscribeToWebPush(),Ne.getWebPushSubscriptions(),Z.getMyChatLinks(void 0,(function(e){ee().get("chatLinks").get(e.id).put(e.url),Pe=e.url})),this.setOurOnlineStatus(),Z.getChannels((function(e){return t.addChannel(e)})),Q().get("profile").get("name").on((function(e){e&&"string"==typeof e&&(Ce=e)})),Ne.init(),ee().get("loggedIn").put(!0),console.log("local().get('loggedIn').put(true);",ee()),ee().get("settings").once().then((function(e){e?void 0!==e.enableWebtorrent&&void 0!==e.autoplayWebtorrent||(ee().get("settings").get("enableWebtorrent").put(qe.local.enableWebtorrent),ee().get("settings").get("autoplayWebtorrent").put(qe.local.autoplayWebtorrent)):ee().get("settings").put(qe.local)})),Q().get("block").map((function(e,t){ee().get("block").get(t).put(e),e&&delete Ue[t]})),this.updateGroups(),n&&location.reload(),_e&&(_e.get("settings").on((function(e){ee().get("settings").get("electron").put(e)})),_e.get("user").put(je.pub)),ee().get("filters").get("group").once().then((function(e){e||ee().get("filters").get("group").put("follows")}))},loginAsNewUser:function(e){var t=this;void 0===e&&(e={});var n=e.name||S.generateName();return console.log("loginAsNewUser name",n),O.generate().then((function(r){t.login(r),Q().get("profile").put({a:null}),Q().get("profile").get("name").put(n),ee().get("filters").put({a:null}),ee().get("filters").get("group").put("follows"),Z.createChatLink().then((function(e){return Pe=e})),setTimeout((function(){!1!==e.autofollow&&(console.log("autofollowing",Ge),Q().get("follow").get(Ge).put(!0))}),1e3)}))},logOut:function(){var e=this;return s(i().mark((function t(){var n,r,a;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(_e&&_e.get("user").put(null),!navigator.serviceWorker){t.next=16;break}return t.next=4,navigator.serviceWorker.getRegistration();case 4:if(!(n=t.sent)||!n.pushManager){t.next=16;break}return null==(r=n.active)||r.postMessage({key:null}),t.next=9,n.pushManager.getSubscription();case 9:if(!(a=t.sent)){t.next=16;break}return t.next=13,S.getHash(JSON.stringify(a));case 13:Ne.removeSubscription(t.sent),a.unsubscribe&&a.unsubscribe();case 16:e.clearIndexedDB(),localStorage.clear(),window.location.hash="",window.location.href="/",location.reload();case 21:case"end":return t.stop()}}),t)})))()},clearIndexedDB:function(){return new Promise((function(e){var t=window.indexedDB.deleteDatabase("local()"),n=window.indexedDB.deleteDatabase("radata"),r=!1,i=!1,a=function(){r&&i&&e(void 0)};t.onerror=n.onerror=function(e){return console.error(e)},t.onsuccess=function(){r=!0,a()},n.onsuccess=function(){i=!0,a()}}))},getMyChatLink:function(){return Pe||S.getProfileLink(je.pub)},getKey:function(){return je},getPubKey:function(){return je&&je.pub},getMyName:function(){return Ce},myPeerUrl:function(e){return"http://"+e+":8767/gun"},shareMyPeerUrl:function(e){var t=this;return s(i().mark((function n(){var r;return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,ee().get("settings").get("electron").get("publicIp").once();case 2:(r=n.sent)&&e.put&&e.put("my_peer",t.myPeerUrl(r));case 4:case"end":return n.stop()}}),n)})))()},newChannel:function(e,t){if(e&&!this.channelIds.has(e)){var n=X(e,t);return this.addChannel(n),n}},addChannel:function(e){var t=this;this.taskQueue.push((function(){var n=e.getId();if(!t.channelIds.has(n)){t.channelIds.add(n);var r=ee().get("channels").get(n);if(r.get("latestTime").on((function(t){t&&(!e.latestTime||t>e.latestTime)&&(e.latestTime=t)})),r.get("theirMsgsLastSeenTime").on((function(t){if(t){var n=new Date(t);(!e.theirMsgsLastSeenDate||e.theirMsgsLastSeenDate<n)&&(e.theirMsgsLastSeenDate=n)}})),e.getLatestMsg&&e.getLatestMsg((function(e,r){t.processMessage(n,e,r)})),Ne.changeChatUnseenCount(n,0),e.notificationSetting="all",e.onMy("notificationSetting",(function(t){e.notificationSetting=t})),e.theirMsgsLastSeenTime="",e.getTheirMsgsLastSeenTime((function(t){e&&t&&t>=e.theirMsgsLastSeenTime&&(e.theirMsgsLastSeenTime=t,r.get("theirMsgsLastSeenTime").put(t))})),e.getMyMsgsLastSeenTime((function(t){e.myLastSeenTime=new Date(t),e.latest&&e.myLastSeenTime>=e.latest.time&&Ne.changeChatUnseenCount(n,0)})),e.isTyping=!1,e.getTyping((function(t){e.isTyping=t,ee().get("channels").get(n).get("isTyping").put(t)})),e.online={},Z.getActivity(n,(function(t){e&&(r.put({theirLastActiveTime:t&&t.lastActive,activity:t&&t.isActive&&t.status}),e.activity=t)})),e.uuid){var i=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches;e.participantProfiles={},e.on("name",(function(t){e.name=t,Ue[e.uuid]={name:t,uuid:e.uuid},ee().get("channels").get(e.uuid).get("name").put(t)})),e.on("photo",(function(t){Ue[e.uuid]=Ue[e.uuid]||{},Ue[e.uuid].photo=t,ee().get("channels").get(e.uuid).get("photo").put(t)})),e.on("about",(function(t){return ee().get("channels").get(e.uuid).get("about").put(t)})),e.getParticipants((function(t){if(delete t.undefined,"object"==typeof t){var n=Object.keys(t);n.forEach((function(r,a){var s=360/Math.max(n.length,2)*a;e.participantProfiles[r]={permissions:t[r],color:"hsl("+s+", 98%, "+(i?80:33)+"%)"},Q(r).get("profile").get("name").on((function(t){e.participantProfiles[r].name=t}))}))}ee().get("channels").get(e.uuid).get("participants").put(t)})),e.inviteLinks={},e.getChatLinks({callback:function(t){var n=t.url,r=t.id;console.log("got chat link",r,n),e.inviteLinks[r]=n,ee().get("inviteLinksChanged").put(!0)}})}else Q(n).get("profile").get("name").on((function(e){return ee().get("channels").get(n).get("name").put(e)}));if(e.put){e.onTheir("webPushSubscriptions",(function(t,r,i){Array.isArray(t)&&(e.webPushSubscriptions=e.webPushSubscriptions||{},e.webPushSubscriptions[i||n]=t)}));var a=Object.values(Ne.webPushSubscriptions);setTimeout((function(){return e.put("webPushSubscriptions",a)}),5e3),t.shareMyPeerUrl(e)}e.onTheir("call",(function(e){ee().get("call").put({pub:n,call:e})})),ee().get("channels").get(n).put({enabled:!0})}}))},processMessage:function(e,t,n,r){var i=X(e);i.messageIds=i.messageIds||{},i.messageIds[t.time+n.from]||(i.messageIds[t.time+n.from]=!0,n&&(t=Object.assign(t,n)),t.invite?this.newChannel(t.invite.group,"https://iris.to/?channelId="+t.invite.group+"&inviter="+e):(t.selfAuthored=n.selfAuthored,ee().get("channels").get(e).get("msgs").get(t.time+(t.from&&t.from.slice(0,10))).put(JSON.stringify(t)),t.timeObj=new Date(t.time),!n.selfAuthored&&t.timeObj>i.myLastSeenTime&&(window.location.hash!=="#/chat/"+e||"visible"!==document.visibilityState?Ne.changeChatUnseenCount(e,1):"active"===Ee&&i.setMyMsgsLastSeenTime()),!n.selfAuthored&&t.time>i.theirMsgsLastSeenTime&&ee().get("channels").get(e).get("theirMsgsLastSeenTime").put(t.time),(!i.latestTime||t.time>i.latestTime)&&ee().get("channels").get(e).put({latestTime:t.time,latest:{time:t.time,text:t.text,selfAuthored:n.selfAuthored}}),Ne.notifyMsg(t,n,e,r)))},subscribeToMsgs:function(e){var t=this,n=X(e);n.subscribed||(n.subscribed=!0,n.getMessages((function(n,r){t.processMessage(e,n,r)})))},channelIds:new Set},Re={get:function(e,t){return new Promise((function(n,r){e||r("No hash provided"),"string"!=typeof e&&r("Hash must be a string"),H().get("#").get(e).on((function(e,r,i,a){e&&(a.off(),t&&t(e),n(e))}))}))},put:function(e){return s(i().mark((function t(){var n;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,S.getHash(e);case 2:return n=t.sent,H().get("#").get(n).put(e),t.abrupt("return",n);case 5:case"end":return t.stop()}}),t)})))()}},Fe="Invalid message:",He=function(e){function t(){return e.apply(this,arguments)||this}return o(t,e),t}(f(Error)),We=function(){function e(e){if(this.signedData=e.signedData,this.pubKey=e.pubKey,e.sig){if("string"!=typeof e.sig)throw new He("SignedMessage signature must be a string");this.sig=e.sig,this.getHash()}this._validate()}var t=e.prototype;return t.getSignerKeyID=function(){return this.pubKey},t._validate=function(){if(!this.signedData)throw new He(Fe+" Missing signedData");if("object"!=typeof this.signedData)throw new He(Fe+" signedData must be an object");var e=this.signedData;if(!e.type)throw new He(Fe+" Missing type definition");if(!e.author)throw new He(Fe+" Missing author");if("object"!=typeof e.author)throw new He(Fe+" Author must be object");if(Array.isArray(e.author))throw new He(Fe+" Author must not be an array");if(0===Object.keys(e.author).length)throw new He(Fe+" Author empty");for(var t in this.pubKey&&(this.signerKeyHash=this.getSignerKeyID()),e.author){var n=typeof e.author[t];if("string"!==n){if(!Array.isArray(e.author[t]))throw new He(Fe+" Author attribute must be string or array, got "+t+": "+e.author[t]);for(var r=0;r<e.author[t].length;r++){if("string"!=typeof e.author[t][r])throw new He(Fe+" Author attribute must be string, got "+t+": ["+e.author[t][r]+"]");if(0===e.author[t][r].length)throw new He(Fe+" author "+t+" in array["+r+"] is empty")}}if("keyID"===t){if("string"!==n)throw new He(Fe+" Author keyID must be string, got "+n);if(this.signerKeyHash&&e.author[t]!==this.signerKeyHash)throw new He(Fe+" If message has a keyID author, it must be signed by the same key")}}if(e.recipient){if("object"!=typeof e.recipient)throw new He(Fe+" Recipient must be object");if(Array.isArray(e.recipient))throw new He(Fe+" Recipient must not be an array");if(0===Object.keys(e.recipient).length)throw new He(Fe+" Recipient empty");for(var i in e.recipient)if("string"!=typeof e.recipient[i]){if(!Array.isArray(e.recipient[i]))throw new He(Fe+" Recipient attribute must be string or array, got "+i+": "+e.recipient[i]);for(var a=0;a<e.recipient[i].length;a++){if("string"!=typeof e.recipient[i][a])throw new He(Fe+" Recipient attribute must be string, got "+i+": ["+e.recipient[i][a]+"]");if(0===e.recipient[i][a].length)throw new He(Fe+" recipient "+i+" in array["+a+"] is empty")}}}if(!e.time&&!e.timestamp)throw new He(Fe+" Missing time field");if(!Date.parse(e.time||e.timestamp))throw new He(Fe+" Invalid time field");return!0},t.sign=function(){var e=s(i().mark((function e(t){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.sign(this.signedData,t);case 2:return this.sig=e.sent,this.pubKey=t.pub,e.next=6,this.getHash();case 6:return e.abrupt("return",!0);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),e.create=function(){var t=s(i().mark((function t(n,r){var a;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!n.author&&r&&(n.author={keyID:O.getId(r)}),n.time=n.time||(new Date).toISOString(),a=new e({signedData:n}),!r){t.next=6;break}return t.next=6,a.sign(r);case 6:return t.abrupt("return",a);case 7:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),t.getAuthor=function(e){for(var t,n=g(this.getAuthorIterable());!(t=n()).done;){var r=t.value;if(r.isUniqueType())return e.getContacts(r)}},t.getRecipient=function(e){if(this.signedData.recipient)for(var t,n=g(this.getRecipientIterable());!(t=n()).done;){var r=t.value;if(r.isUniqueType())return e.getContacts(r)}},t.getHash=function(){var e=s(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.sig||this.hash){e.next=4;break}return e.next=3,S.getHash(this.sig);case 3:this.hash=e.sent;case 4:return e.abrupt("return",this.hash);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.getId=function(){return this.getHash()},e.fromSig=function(){var t=s(i().mark((function t(n){var r;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n.sig){t.next=2;break}throw new Error("Missing signature in object:",n);case 2:if(n.pubKey){t.next=4;break}throw new Error("Missing pubKey in object:");case 4:return r=JSON.parse(n.sig.slice(4)).m,t.abrupt("return",new e({signedData:r,sig:n.sig,pubKey:n.pubKey}));case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),t.verify=function(){var e=s(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.pubKey){e.next=2;break}throw new He(Fe+" SignedMessage has no .pubKey");case 2:if(this.sig){e.next=4;break}throw new He(Fe+" SignedMessage has no .sig");case 4:return e.next=6,O.verify(this.sig,this.pubKey);case 6:if(this.signedData=e.sent,this.signedData){e.next=9;break}throw new He(Fe+" Invalid signature");case 9:if(!this.hash){e.next=18;break}return e.t0=this.hash,e.next=13,S.getHash(this.sig);case 13:if(e.t1=e.sent,e.t0===e.t1){e.next=16;break}throw new He(Fe+" Invalid message hash");case 16:e.next=19;break;case 18:this.getHash();case 19:return e.abrupt("return",!0);case 20:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.serialize=function(){return{sig:this.sig,pubKey:this.pubKey}},t.toString=function(){return JSON.stringify(this.serialize())},e.deserialize=function(){var t=s(i().mark((function t(n){return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.fromSig(n));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.fromString=function(){var t=s(i().mark((function t(n){return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.fromSig(JSON.parse(n)));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e}();exports.default={local:ee,global:H,group:se,public:Q,private:X,static:Re,electron:_e,peers:I,session:Je,util:S,notifications:Ne,SignedMessage:We,Channel:Z,Node:F,Key:O};
//# sourceMappingURL=iris.cjs.production.min.js.map
